!function(){var t;const e=t=>t[t.length-1],n=Math.floor,r=Math.ceil,i=Math.log10,o=(t,e)=>t+e,s=(t,e)=>e>t?t:e,l=(t,e)=>t>e?t:e,a=()=>new Map,c=(t,e,n)=>{let r=t.get(e);return void 0===r&&t.set(e,r=n()),r},u=String.fromCharCode,h=/^\s*/g,d=/([A-Z])/g,f=(t,e)=>(t=>t.replace(h,""))(t.replace(d,t=>`${e}${(t=>t.toLowerCase())(t)}`)),p="undefined"!=typeof process&&process.release&&/node|io\.js/.test(process.release.name),g="undefined"!=typeof window&&!p;let m;const v=p?()=>{if(void 0===m){m=a();const t=process.argv;let e=null;for(let n=0;t.length>n;n++){const r=t[n];"-"===r[0]?(null!==e&&m.set(e,""),e=r):null!==e&&(m.set(e,r),e=null)}}return m}:()=>(void 0===m&&(m=a(),(location.search||"?").slice(1).split("&").forEach(t=>{if(0!==t.length){const[e,n]=t.split("=");m.set(`--${f(e,"-")}`,n),m.set(`-${f(e,"-")}`,n)}})),m),y=(((t,e)=>v().get(t)||e)("production","0"),t=>new Uint8Array(t)),b=(t,e,n)=>new Uint8Array(t,e,n),w=t=>new Uint8Array(t),x=g?t=>{let e="";for(let n=0;t.byteLength>n;n++)e+=u(t[n]);return btoa(e)}:t=>Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("base64"),k=g?t=>{const e=atob(t),n=y(e.length);for(let t=0;e.length>t;t++)n[t]=e.charCodeAt(t);return n}:t=>new Uint8Array(Buffer.from(t,"base64").buffer),C=32,S=64,L=128,M=31,T=Number.isInteger||(t=>"number"==typeof t&&isFinite(t)&&n(t)===t);class A{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const N=()=>new A,O=t=>{let e=t.cpos;for(let n=0;t.bufs.length>n;n++)e+=t.bufs[n].length;return e},_=t=>{const e=new Uint8Array(O(t));let n=0;for(let r=0;t.bufs.length>r;r++){let i=t.bufs[r];e.set(i,n),n+=i.length}return e.set(b(t.cbuf.buffer,0,t.cpos),n),e},D=(t,e)=>{const n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(2*n),t.cpos=0),t.cbuf[t.cpos++]=e},W=D,E=(t,e)=>{for(;e>127;)D(t,L|127&e),e>>>=7;D(t,127&e)},I=(t,e)=>{const n=unescape(encodeURIComponent(e)),r=n.length;E(t,r);for(let e=0;r>e;e++)D(t,n.codePointAt(e))},H=(t,e)=>{E(t,e.byteLength),((t,e)=>{const n=t.cbuf.length;t.bufs.push(b(t.cbuf.buffer,0,t.cpos)),t.bufs.push(e),t.cbuf=y(n),t.cpos=0})(t,e)},F=(t,e)=>{((t,e)=>{const n=t.cbuf.length;e>n-t.cpos&&(t.bufs.push(b(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(2*l(n,e)),t.cpos=0)})(t,e);const n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},P=new DataView(new ArrayBuffer(4)),R=(t,e)=>{switch(typeof e){case"string":D(t,119),I(t,e);break;case"number":T(e)&&2147483647>=e?(D(t,125),((t,e)=>{let n=!1;for(0>e&&(e=-e,n=!0),D(t,(e>63?L:0)|(n?S:0)|63&e),e>>>=6;e>0;)D(t,(e>127?L:0)|127&e),e>>>=7})(t,e)):(t=>(P.setFloat32(0,t),P.getFloat32(0)===t))(e)?(D(t,124),((t,e)=>F(t,4).setFloat32(0,e))(t,e)):(D(t,123),((t,e)=>F(t,8).setFloat64(0,e))(t,e));break;case"bigint":D(t,122),((t,e)=>F(t,8).setBigInt64(0,e))(t,e);break;case"object":if(null===e)D(t,126);else if(e instanceof Array){D(t,117),E(t,e.length);for(let n=0;e.length>n;n++)R(t,e[n])}else if(e instanceof Uint8Array)D(t,116),H(t,e);else{D(t,118);const n=Object.keys(e);E(t,n.length);for(let r=0;n.length>r;r++){const i=n[r];I(t,i),R(t,e[i])}}break;case"boolean":D(t,e?120:121);break;case"symbol":case"function":case"undefined":default:D(t,127)}};class z{constructor(t){this.arr=t,this.pos=0}}const B=t=>new z(t),U=t=>((t,e)=>{const n=b(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n})(t,V(t)),j=t=>t.arr[t.pos++],V=t=>{let e=0,n=0;for(;;){const r=t.arr[t.pos++];if(e|=(127&r)<<n,L>r)return e>>>0;if((n+=7)>35)throw new Error("Integer out of range!")}},G=t=>{let e=V(t),n="";for(;e>0;){const r=1e4>e?e:1e4,i=new Array(r);for(let e=0;r>e;e++)i[e]=t.arr[t.pos++];n+=String.fromCodePoint.apply(null,i),e-=r}return decodeURIComponent(escape(n))},$=(t,e)=>{const n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},K=[t=>void 0,t=>null,t=>{let e=t.arr[t.pos++],n=63&e,r=6;const i=(e&S)>0?-1:1;if(0==(e&L))return i*n;for(;;){if(n|=(127&(e=t.arr[t.pos++]))<<r,L>e)return i*n;if((r+=7)>41)throw new Error("Integer out of range!")}},t=>$(t,4).getFloat32(0),t=>$(t,8).getFloat64(0),t=>$(t,8).getBigInt64(0),t=>!1,t=>!0,G,t=>{const e=V(t),n={};for(let r=0;e>r;r++){n[G(t)]=X(t)}return n},t=>{const e=V(t),n=[];for(let r=0;e>r;r++)n.push(X(t));return n},U],X=t=>K[127-j(t)](t),Y=()=>new Set;class q{constructor(){this._observers=a()}on(t,e){c(this._observers,t,Y).add(e)}once(t,e){this.on(t,(...n)=>{this.off(t,e),e(...n)})}off(t,e){const n=this._observers.get(t);void 0!==n&&(n.delete(e),0===n.size&&this._observers.delete(t))}emit(t,e){return(this._observers.get(t)||a()).forEach(t=>t(...e))}destroy(){this._observers=a()}}const J=Math.random,Z=g?"undefined"==typeof crypto?()=>r(4294967295*J()>>>0):()=>{const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]}:(t=>()=>{const e=t.randomBytes(4);return new Uint32Array(e.buffer)[0]})(require("crypto")),Q=(t,e,n=0)=>{try{for(;t.length>n;n++)t[n](...e)}finally{t.length>n&&Q(t,e,n+1)}},tt=()=>{throw new Error("Method unimplemented")},et=()=>{throw new Error("Unexpected case")},nt=Date.now,rt=t=>({[Symbol.iterator](){return this},next:t}),it=(t,e)=>rt(()=>{const{done:n,value:r}=t.next();return{done:n,value:n?void 0:e(r)}}),ot=Object.keys,st=t=>ot(t).length;class lt{constructor(t,e){this.clock=t,this.len=e}}class at{constructor(){this.clients=new Map}}const ct=(t,e)=>{const r=t.clients.get(e.client);return void 0!==r&&null!==((t,e)=>{let r=0,i=t.length-1;for(;i>=r;){const o=n((r+i)/2),s=t[o],l=s.clock;if(l>e)i=o-1;else{if(l+s.len>e)return o;r=o+1}}return null})(r,e.clock)},ut=t=>{t.clients.forEach(t=>{let e,n;for(t.sort((t,e)=>t.clock-e.clock),e=1,n=1;t.length>e;e++){const r=t[n-1],i=t[e];r.clock+r.len===i.clock?r.len+=i.len:(e>n&&(t[n]=i),n++)}t.length=n})},ht=(t,e,n)=>{c(t.clients,e.client,()=>[]).push(new lt(e.clock,n))},dt=t=>{const e=(()=>new at)();return t.clients.forEach((t,n)=>{const r=[];for(let e=0;t.length>e;e++){const n=t[e];if(n.deleted){const i=n.id.clock;let o=n.length;if(t.length>e+1)for(let n=t[e+1];t.length>e+1&&n.id.clock===i+o&&n.deleted;n=t[++e+1])o+=n.length;r.push(new lt(i,o))}}r.length>0&&e.clients.set(n,r)}),e},ft=(t,e)=>{E(t,e.clients.size),e.clients.forEach((e,n)=>{E(t,n);const r=e.length;E(t,r);for(let n=0;r>n;n++){const r=e[n];E(t,r.clock),E(t,r.len)}})},pt=(t,e,n)=>{const r=new at,i=V(t);for(let o=0;i>o;o++){const i=V(t),o=V(t),s=n.clients.get(i)||[],l=Vt(n,i);for(let n=0;o>n;n++){const n=V(t),o=V(t);if(l>n){n+o>l&&ht(r,Ot(i,l),n+o-l);let t=$t(s,n),a=s[t];for(!a.deleted&&n>a.id.clock&&(s.splice(t+1,0,mn(e,a,n-a.id.clock)),t++);s.length>t&&(a=s[t++]).id.clock<n+o;)a.deleted||(a.id.clock+a.length>n+o&&s.splice(t,0,mn(e,a,n+o-a.id.clock)),a.delete(e))}else ht(r,Ot(i,n),o)}}if(r.clients.size>0){const t=N();ft(t,r),n.pendingDeleteReaders.push(B(_(t)))}};class gt extends q{constructor(t={}){super(),this.gc=t.gc||!0,this.clientID=Z(),this.share=new Map,this.store=new Ut,this._transaction=null,this._transactionCleanups=[]}transact(t,e=null){ie(this,t,e)}get(t,e=ae){const n=c(this.share,t,()=>{const t=new e;return t._integrate(this,null),t}),r=n.constructor;if(e!==ae&&r!==e){if(r===ae){const r=new e;r._map=n._map,n._map.forEach(t=>{for(;null!==t;t=t.left)t.parent=r}),r._start=n._start;for(let t=r._start;null!==t;t=t.right)t.parent=r;return r._length=n._length,this.share.set(t,r),r._integrate(this,null),r}throw new Error(`Type with the name ${t} has already been defined with a different constructor`)}return n}getArray(t){return this.get(t,Se)}getText(t){return this.get(t,ze)}getMap(t){return this.get(t,Me)}getXmlFragment(t){return this.get(t,Ue)}destroy(){this.emit("destroyed",[!0]),super.destroy()}on(t,e){super.on(t,e)}off(t,e){super.off(t,e)}}const mt=(t,e,n)=>{const r=[];for(let i=0;e>i;i++){const e=j(t),i=0==(M&e)?new Je(t,n,e):new wn(t,n,e);n=Ot(n.client,n.clock+i.length),r.push(i)}return r},vt=(t,e,n)=>{const r=new Map;n.forEach((t,n)=>{Vt(e,n)>t&&r.set(n,t)}),jt(e).forEach((t,e)=>{n.has(e)||r.set(e,0)}),E(t,r.size),r.forEach((n,r)=>{((t,e,n,r)=>{const i=$t(e,r);E(t,e.length-i),_t(t,Ot(n,r));const o=e[i];o.write(t,r-o.id.clock,0);for(let n=i+1;e.length>n;n++)e[n].write(t,0,0)})(t,e.clients.get(r),r,n)})},yt=(t,e,n)=>{((t,e)=>{const n=t.pendingClientsStructRefs;for(const[t,r]of e){const e=n.get(t);if(void 0===e)n.set(t,{refs:r,i:0});else{const t=e.i>0?e.refs.slice(e.i):e.refs;for(let e=0;r.length>e;e++)t.push(r[e]);e.i=0,e.refs=t.sort((t,e)=>t.id.clock-e.id.clock)}}})(n,(t=>{const e=new Map,n=V(t);for(let r=0;n>r;r++){const n=V(t),r=Dt(t),i=mt(t,n,r);e.set(r.client,i)}return e})(t)),((t,e)=>{const n=e.pendingStack,r=e.pendingClientsStructRefs;for(;0!==n.length||0!==r.size;){if(0===n.length){const[t,e]=r.entries().next().value;n.push(e.refs[e.i++]),e.refs.length===e.i&&r.delete(t)}const i=n[n.length-1],o=i._missing,s=i.id.client,l=Vt(e,s),a=l>i.id.clock?l-i.id.clock:0;if(i.id.clock+a!==l){const t=r.get(s);if(void 0!==t){const e=t.refs[t.i];if(i.id.clock>e.id.clock){t.refs[t.i]=i,n[n.length-1]=e,t.refs=t.refs.slice(t.i).sort((t,e)=>t.id.clock-e.id.clock),t.i=0;continue}}return}for(;o.length>0;){const t=o[o.length-1];if(Vt(e,t.client)<=t.clock){const e=t.client,i=r.get(e);if(void 0===i)return;n.push(i.refs[i.i++]),i.i===i.refs.length&&r.delete(e);break}i._missing.pop()}0===o.length&&(i.length>a&&i.toStruct(t,e,a).integrate(t),n.pop())}})(e,n),((t,e)=>{const n=e.pendingDeleteReaders;e.pendingDeleteReaders=[];for(let r=0;n.length>r;r++)pt(n[r],t,e)})(e,n)},bt=(t,e,n)=>((t,e,n)=>ie(e,n=>{yt(t,n,e.store),pt(t,n,e.store)},n,!1))(B(e),t,n),wt=(t,e)=>{const n=N();return((t,e,n=new Map)=>{vt(t,e.store,n),ft(t,dt(e.store))})(n,t,null==e?new Map:xt(e)),_(n)},xt=t=>(t=>{const e=new Map,n=V(t);for(let r=0;n>r;r++){const n=V(t),r=V(t);e.set(n,r)}return e})(B(t)),kt=(t,e)=>((t,e)=>(E(t,e.size),e.forEach((e,n)=>{E(t,n),E(t,e)}),t))(t,jt(e.store));class Ct{constructor(){this.l=[]}}const St=()=>new Ct,Lt=(t,e)=>t.l.push(e),Mt=(t,e)=>{t.l=t.l.filter(t=>e!==t)},Tt=(t,e,n)=>Q(t.l,[e,n]);class At{constructor(t,e){this.client=t,this.clock=e}}const Nt=(t,e)=>t===e||null!==t&&null!==e&&t.client===e.client&&t.clock===e.clock,Ot=(t,e)=>new At(t,e),_t=(t,e)=>{E(t,e.client),E(t,e.clock)},Dt=t=>Ot(V(t),V(t)),Wt=t=>{for(let[e,n]of t.doc.share)if(n===t)return e;throw et()};class Et{constructor(t,e,n){this.type=t,this.tname=e,this.item=n}}class It{constructor(t,e){this.type=t,this.index=e}}const Ht=(t,e)=>{let n=null,r=null;return null===t._item?r=Wt(t):n=t._item.id,new Et(n,r,e)},Ft=(t,e)=>{let n=t._start;for(;null!==n;){if(!n.deleted&&n.countable){if(n.length>e)return Ht(t,Ot(n.id.client,n.id.clock+e));e-=n.length}n=n.right}return Ht(t,null)},Pt=(t,e)=>{const n=e.store,r=t.item,i=t.type,o=t.tname;let s=null,l=0;if(null!==r){if(Vt(n,r.client)<=r.clock)return null;const t=gn(n,r),e=t.item;if(!(e instanceof vn))return null;if(null===(s=e.parent)._item||!s._item.deleted){l=e.deleted||!e.countable?0:t.diff;let n=e.left;for(;null!==n;)!n.deleted&&n.countable&&(l+=n.length),n=n.left}}else{if(null!==o)s=e.get(o);else{if(null===i)throw et();{if(Vt(n,i.client)<=i.clock)return null;const{item:t}=gn(n,i);if(!(t instanceof vn&&t.content instanceof pn))return null;s=t.content.type}}l=s._length}return((t,e)=>new It(t,e))(s,l)},Rt=(t,e)=>t===e||null!==t&&null!==e&&t.tname===e.tname&&Nt(t.item,e.item)&&Nt(t.type,e.type),zt=(t,e)=>void 0===e?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!ct(e.ds,t.id),Bt=(t,e)=>{const n=c(t.meta,Bt,Y),r=t.doc.store;n.has(e)||(e.sv.forEach((e,n)=>{e<Vt(r,n)&&Yt(t,Ot(n,e))}),((t,e,n)=>e.clients.forEach((e,r)=>{const i=t.doc.store.clients.get(r);for(let r=0;e.length>r;r++){const o=e[r];Zt(t,i,o.clock,o.len,n)}}))(t,e.ds,t=>{}),n.add(e))};class Ut{constructor(){this.clients=new Map,this.pendingClientsStructRefs=new Map,this.pendingStack=[],this.pendingDeleteReaders=[]}}const jt=t=>{const e=new Map;return t.clients.forEach((t,n)=>{const r=t[t.length-1];e.set(n,r.id.clock+r.length)}),e},Vt=(t,e)=>{const n=t.clients.get(e);if(void 0===n)return 0;const r=n[n.length-1];return r.id.clock+r.length},Gt=(t,e)=>{let n=t.clients.get(e.id.client);if(void 0===n)t.clients.set(e.id.client,n=[]);else{const t=n[n.length-1];if(t.id.clock+t.length!==e.id.clock)throw et()}n.push(e)},$t=(t,e)=>{let r=0,i=t.length-1;for(;i>=r;){const o=n((r+i)/2),s=t[o],l=s.id.clock;if(e<l)i=o-1;else{if(l+s.length>e)return o;r=o+1}}throw et()},Kt=(t,e)=>((t,e)=>{const n=t.clients.get(e.client);return n[$t(n,e.clock)]})(t,e),Xt=(t,e,n)=>{const r=$t(e,n);let i=e[r];return n>i.id.clock&&i instanceof vn?(e.splice(r+1,0,mn(t,i,n-i.id.clock)),r+1):r},Yt=(t,e)=>{const n=t.doc.store.clients.get(e.client);return n[Xt(t,n,e.clock)]},qt=(t,e,n)=>{const r=e.clients.get(n.client),i=$t(r,n.clock),o=r[i];return n.clock!==o.id.clock+o.length-1&&o.constructor!==qe&&r.splice(i+1,0,mn(t,o,n.clock-o.id.clock+1)),o},Jt=(t,e,n)=>{const r=t.clients.get(e.id.client);r[$t(r,e.id.clock)]=n},Zt=(t,e,n,r,i)=>{if(0===r)return;const o=n+r;let s,l=Xt(t,e,n);do{(s=e[l++]).id.clock+s.length>o&&Xt(t,e,o),i(s)}while(e.length>l&&o>e[l].id.clock)};class Qt{constructor(t,e,n){this.doc=t,this.deleteSet=new at,this.beforeState=jt(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=new Set,this.origin=e,this.meta=new Map,this.local=n}}const te=t=>{if(0===t.deleteSet.clients.size&&!((t,e)=>{for(const[n,r]of t)if(e(r,n))return!0;return!1})(t.afterState,(e,n)=>t.beforeState.get(n)!==e))return null;const e=N();return ut(t.deleteSet),((t,e)=>vt(t,e.doc.store,e.beforeState))(e,t),ft(e,t.deleteSet),e},ee=t=>{const e=t.doc;return Ot(e.clientID,Vt(e.store,e.clientID))},ne=(t,e,n)=>{const r=e._item;(null===r||r.id.clock<(t.beforeState.get(r.id.client)||0)&&!r.deleted)&&c(t.changed,e,Y).add(n)},re=(t,e)=>{if(t.length>e){const n=t[e],r=n.doc,i=r.store,o=n.deleteSet;try{ut(o),n.afterState=jt(n.doc.store),r._transaction=null,r.emit("beforeObserverCalls",[n,r]);const a=[];n.changed.forEach((t,e)=>a.push(()=>{null!==e._item&&e._item.deleted||e._callObserver(n,t)})),a.push(()=>{n.changedParentTypes.forEach((t,e)=>a.push(()=>{null!==e._item&&e._item.deleted||((t=t.filter(t=>null===t.target._item||!t.target._item.deleted)).forEach(t=>{t.currentTarget=e}),Tt(e._dEH,t,n))})),a.push(()=>r.emit("afterTransaction",[n,r]))}),Q(a,[])}finally{const a=(t,e)=>{const n=t[e-1],r=t[e];n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)&&(t.splice(e,1),r instanceof vn&&null!==r.parentSub&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n))};if(r.gc)for(const[t,e]of o.clients){const n=i.clients.get(t);for(let t=e.length-1;t>=0;t--){const r=e[t],o=r.clock+r.len;for(let t=$t(n,r.clock),e=n[t];n.length>t&&o>e.id.clock;e=n[++t]){const e=n[t];if(e.id.clock>=r.clock+r.len)break;e instanceof vn&&e.deleted&&!e.keep&&e.gc(i,!1)}}}for(const[t,e]of o.clients){const n=i.clients.get(t);for(let t=e.length-1;t>=0;t--){const r=e[t];for(let t=s(n.length-1,1+$t(n,r.clock+r.len-1)),e=n[t];t>0&&e.id.clock>=r.clock;e=n[--t])a(n,t)}}for(const[t,e]of n.afterState){const r=n.beforeState.get(t)||0;if(r!==e){const e=i.clients.get(t),n=l($t(e,r),1);for(let t=e.length-1;t>=n;t--)a(e,t)}}for(const t of n._mergeStructs){const e=t.clock,n=i.clients.get(t.client),r=$t(n,e);n.length>r+1&&a(n,r+1),r>0&&a(n,r)}if(r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const t=te(n);null!==t&&r.emit("update",[_(t),n.origin,r])}t.length>e+1?re(t,e+1):r._transactionCleanups=[]}}},ie=(t,e,n=null,r=!0)=>{const i=t._transactionCleanups;let o=!1;null===t._transaction&&(o=!0,t._transaction=new Qt(t,n,r),i.push(t._transaction),t.emit("beforeTransaction",[t._transaction,t]));try{e(t._transaction)}finally{o&&i[0]===t._transaction&&re(i,0)}};class oe{constructor(t,e){this.target=t,this.currentTarget=t,this.transaction=e,this._changes=null}get path(){return se(this.currentTarget,this.target)}deletes(t){return ct(this.transaction.deleteSet,t.id)}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(null===t){const n=this.target,r=Y(),i=Y(),o=[],s=new Map;t={added:r,deleted:i,delta:o,keys:s};const l=this.transaction.changed.get(n);if(l.has(null)){let t=null;const e=()=>{t&&o.push(t)};for(let o=n._start;null!==o;o=o.right)o.deleted?this.deletes(o)&&!this.adds(o)&&(null!==t&&void 0!==t.delete||(e(),t={delete:0}),t.delete+=o.length,i.add(o)):this.adds(o)?(null!==t&&void 0!==t.insert||(e(),t={insert:[]}),t.insert=t.insert.concat(o.content.getContent()),r.add(o)):(null!==t&&void 0!==t.retain||(e(),t={retain:0}),t.retain+=o.length);null!==t&&void 0===t.retain&&e()}l.forEach(t=>{if(null!==t){const r=n._map.get(t);let i,o;if(this.adds(r)){let t=r.left;for(;null!==t&&this.adds(t);)t=t.left;if(this.deletes(r)){if(null===t||!this.deletes(t))return;i="delete",o=e(t.content.getContent())}else null!==t&&this.deletes(t)?(i="update",o=e(t.content.getContent())):(i="add",o=void 0)}else{if(!this.deletes(r))return;i="delete",o=e(r.content.getContent())}s.set(t,{action:i,oldValue:o})}}),this._changes=t}return t}}const se=(t,e)=>{const n=[];for(;null!==e._item&&e!==t;){if(null!==e._item.parentSub)n.unshift(e._item.parentSub);else{let t=0,r=e._item.parent._start;for(;r!==e._item&&null!==r;)r.deleted||t++,r=r.right;n.unshift(t)}e=e._item.parent}return n},le=(t,e,n)=>{const r=t,i=e.changedParentTypes;for(;c(i,t,()=>[]).push(n),null!==t._item;)t=t._item.parent;Tt(r._eH,n,e)};class ae{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=St(),this._dEH=St()}_integrate(t,e){this.doc=t,this._item=e}_copy(){throw tt()}_write(t){}get _first(){let t=this._start;for(;null!==t&&t.deleted;)t=t.right;return t}_callObserver(t,e){}observe(t){Lt(this._eH,t)}observeDeep(t){Lt(this._dEH,t)}unobserve(t){Mt(this._eH,t)}unobserveDeep(t){Mt(this._dEH,t)}toJSON(){}}const ce=t=>{const e=[];let n=t._start;for(;null!==n;){if(n.countable&&!n.deleted){const t=n.content.getContent();for(let n=0;t.length>n;n++)e.push(t[n])}n=n.right}return e},ue=(t,e)=>{let n=0,r=t._start;for(;null!==r;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let r=0;i.length>r;r++)e(i[r],n++,t)}r=r.right}},he=(t,e)=>{const n=[];return ue(t,(r,i)=>{n.push(e(r,i,t))}),n},de=t=>{let e=t._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(null===n){for(;null!==e&&e.deleted;)e=e.right;if(null===e)return{done:!0,value:void 0};n=e.content.getContent(),r=0,e=e.right}const t=n[r++];return n.length>r||(n=null),{done:!1,value:t}}}},fe=(t,e)=>{for(let n=t._start;null!==n;n=n.right)if(!n.deleted&&n.countable){if(n.length>e)return n.content.getContent()[e];e-=n.length}},pe=(t,e,n,r)=>{let i=n;const o=null===n?e._start:n.right;let s=[];const l=()=>{s.length>0&&((i=new vn(ee(t),i,null===i?null:i.lastId,o,null===o?null:o.id,e,null,new rn(s))).integrate(t),s=[])};r.forEach(n=>{switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:s.push(n);break;default:switch(l(),n.constructor){case Uint8Array:case ArrayBuffer:(i=new vn(ee(t),i,null===i?null:i.lastId,o,null===o?null:o.id,e,null,new Ze(new Uint8Array(n)))).integrate(t);break;default:if(!(n instanceof ae))throw new Error("Unexpected content type in insert operation");(i=new vn(ee(t),i,null===i?null:i.lastId,o,null===o?null:o.id,e,null,new pn(n))).integrate(t)}}}),l()},ge=(t,e,n,r)=>{if(0===n)return pe(t,e,null,r);let i=e._start;for(;null!==i;i=i.right)if(!i.deleted&&i.countable){if(i.length>=n){i.length>n&&Yt(t,Ot(i.id.client,i.id.clock+n));break}n-=i.length}return pe(t,e,i,r)},me=(t,e,n,r)=>{if(0===r)return;let i=e._start;for(;null!==i&&n>0;i=i.right)!i.deleted&&i.countable&&(i.length>n&&Yt(t,Ot(i.id.client,i.id.clock+n)),n-=i.length);for(;r>0&&null!==i;)i.deleted||(i.length>r&&Yt(t,Ot(i.id.client,i.id.clock+r)),i.delete(t),r-=i.length),i=i.right;if(r>0)throw(t=>new Error(t))("array length exceeded")},ve=(t,e,n)=>{const r=e._map.get(n);void 0!==r&&r.delete(t)},ye=(t,e,n,r)=>{const i=e._map.get(n)||null;let o;if(null==r)o=new rn([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:o=new rn([r]);break;case Uint8Array:o=new Ze(r);break;default:if(!(r instanceof ae))throw new Error("Unexpected content type");o=new pn(r)}new vn(ee(t),i,null===i?null:i.lastId,null,null,e,n,o).integrate(t)},be=(t,e)=>{const n=t._map.get(e);return void 0===n||n.deleted?void 0:n.content.getContent()[n.length-1]},we=t=>{let e={};for(const[n,r]of t._map)r.deleted||(e[n]=r.content.getContent()[r.length-1]);return e},xe=(t,e)=>{const n=t._map.get(e);return void 0!==n&&!n.deleted},ke=t=>((t,e)=>rt(()=>{let n;do{n=t.next()}while(!n.done&&!e(n.value));return n}))(t.entries(),t=>!t[1].deleted);class Ce extends oe{constructor(t,e){super(t,e),this._transaction=e}}class Se extends ae{constructor(){super(),this._prelimContent=[]}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Se}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}_callObserver(t,e){le(this,t,new Ce(this,t))}insert(t,e){null!==this.doc?ie(this.doc,n=>{ge(n,this,t,e)}):this._prelimContent.splice(t,0,...e)}push(t){this.insert(this.length,t)}delete(t,e=1){null!==this.doc?ie(this.doc,n=>{me(n,this,t,e)}):this._prelimContent.splice(t,e)}get(t){return fe(this,t)}toArray(){return ce(this)}toJSON(){return this.map(t=>t instanceof ae?t.toJSON():t)}map(t){return he(this,t)}forEach(t){ue(this,t)}[Symbol.iterator](){return de(this)}_write(t){E(t,ln)}}class Le extends oe{constructor(t,e,n){super(t,e),this.keysChanged=n}}class Me extends ae{constructor(){super(),this._prelimContent=new Map}_integrate(t,e){super._integrate(t,e);for(let[t,e]of this._prelimContent)this.set(t,e);this._prelimContent=null}_copy(){return new Me}_callObserver(t,e){le(this,t,new Le(this,t,e))}toJSON(){const t={};for(let[e,n]of this._map)if(!n.deleted){const r=n.content.getContent()[n.length-1];t[e]=r instanceof ae?r.toJSON():r}return t}keys(){return it(ke(this._map),t=>t[0])}values(){return it(ke(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return it(ke(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){for(let[e,n]of this._map)n.deleted||t(n.content.getContent()[n.length-1],e,this);return{}}[Symbol.iterator](){return this.entries()}delete(t){null!==this.doc?ie(this.doc,e=>{ve(e,this,t)}):this._prelimContent.delete(t)}set(t,e){return null!==this.doc?ie(this.doc,n=>{ye(n,this,t,e)}):this._prelimContent.set(t,e),e}get(t){return be(this,t)}has(t){return xe(this,t)}_write(t){E(t,an)}}const Te=(t,e)=>t===e||"object"==typeof t&&"object"==typeof e&&t&&e&&((t,e)=>t===e||st(t)===st(e)&&((t,e)=>{for(let n in t)if(!e(t[n],n))return!1;return!0})(t,(t,n)=>(void 0!==t||e.hasOwnProperty(n))&&e[n]===t))(t,e);class Ae{constructor(t,e){this.left=t,this.right=e}}class Ne extends Ae{constructor(t,e,n){super(t,e),this.currentAttributes=n}}class Oe extends Ae{constructor(t,e,n){super(t,e),this.negatedAttributes=n}}const _e=(t,e,n)=>{return((t,e,n,r,i)=>{for(;null!==r&&i>0;){switch(r.content.constructor){case tn:case on:r.deleted||(r.length>i&&Yt(t,Ot(r.id.client,r.id.clock+i)),i-=r.length);break;case en:r.deleted||We(e,r.content)}n=r,r=r.right}return new Ne(n,r,e)})(t,new Map,null,e._start,n)},De=(t,e,n,r,i)=>{for(;null!==r&&(!0===r.deleted||r.content.constructor===en&&Te(i.get(r.content.key),r.content.value));)r.deleted||i.delete(r.content.key),n=r,r=r.right;for(let[o,s]of i)(n=new vn(ee(t),n,null===n?null:n.lastId,r,null===r?null:r.id,e,null,new en(o,s))).integrate(t);return{left:n,right:r}},We=(t,e)=>{const{key:n,value:r}=e;null===r?t.delete(n):t.set(n,r)},Ee=(t,e,n,r)=>{for(;null!==e;){if(e.deleted);else{if(e.content.constructor!==en||!Te(r[e.content.key]||null,e.content.value))break;We(n,e.content)}t=e,e=e.right}return new Ae(t,e)},Ie=(t,e,n,r,i,o)=>{const s=new Map;for(let l in o){const a=o[l],c=i.get(l)||null;Te(c,a)||(s.set(l,c),(n=new vn(ee(t),n,null===n?null:n.lastId,r,null===r?null:r.id,e,null,new en(l,a))).integrate(t))}return new Oe(n,r,s)},He=(t,e,n,r,i,o,s)=>{for(let[t]of i)void 0===s[t]&&(s[t]=null);const l=Ee(n,r,i,s),a=Ie(t,e,l.left,l.right,i,s);n=a.left,r=a.right;const c=o.constructor===String?new on(o):new tn(o);return(n=new vn(ee(t),n,null===n?null:n.lastId,r,null===r?null:r.id,e,null,c)).integrate(t),De(t,e,n,a.right,a.negatedAttributes)},Fe=(t,e,n,r,i,o,s)=>{const l=Ee(n,r,i,s),a=Ie(t,e,l.left,l.right,i,s),c=a.negatedAttributes;for(n=a.left,r=a.right;o>0&&null!==r;){if(!r.deleted)switch(r.content.constructor){case en:const{key:e,value:n}=r.content,l=s[e];void 0!==l&&(Te(l,n)?c.delete(e):c.set(e,n),r.delete(t)),We(i,r.content);break;case tn:case on:r.length>o&&Yt(t,Ot(r.id.client,r.id.clock+o)),o-=r.length}n=r,r=r.right}if(o>0){let i="";for(;o>0;o--)i+="\n";(n=new vn(ee(t),n,null===n?null:n.lastId,r,null===r?null:r.id,e,null,new on(i))).integrate(t)}return De(t,e,n,r,c)},Pe=(t,e,n,r,i)=>{for(;i>0&&null!==n;){if(!1===n.deleted)switch(n.content.constructor){case en:We(r,n.content);break;case tn:case on:n.length>i&&Yt(t,Ot(n.id.client,n.id.clock+i)),i-=n.length,n.delete(t)}e=n,n=n.right}return{left:e,right:n}};class Re extends oe{constructor(t,e){super(t,e),this._delta=null}get delta(){if(null===this._delta){const t=this.target.doc;this._delta=[],ie(t,t=>{const e=this._delta,n=new Map,r=new Map;let i=this.target._start,o=null,s={},l="",a=0,c=0;const u=()=>{if(null!==o){let t;switch(o){case"delete":t={delete:c},c=0;break;case"insert":if(t={insert:l},n.size>0){t.attributes={};for(let[e,r]of n)null!==r&&(t.attributes[e]=r)}l="";break;case"retain":if(t={retain:a},Object.keys(s).length>0){t.attributes={};for(let e in s)t.attributes[e]=s[e]}a=0}e.push(t),o=null}};for(;null!==i;){switch(i.content.constructor){case tn:this.adds(i)?this.deletes(i)||(u(),o="insert",l=i.content.embed,u()):this.deletes(i)?("delete"!==o&&(u(),o="delete"),c+=1):i.deleted||("retain"!==o&&(u(),o="retain"),a+=1);break;case on:this.adds(i)?this.deletes(i)||("insert"!==o&&(u(),o="insert"),l+=i.content.str):this.deletes(i)?("delete"!==o&&(u(),o="delete"),c+=i.length):i.deleted||("retain"!==o&&(u(),o="retain"),a+=i.length);break;case en:const{key:e,value:h}=i.content;if(this.adds(i)){if(!this.deletes(i)){const l=n.get(e)||null;Te(l,h)?i.delete(t):("retain"===o&&u(),Te(h,r.get(e)||null)?delete s[e]:s[e]=h)}}else if(this.deletes(i)){r.set(e,h);const t=n.get(e)||null;Te(t,h)||("retain"===o&&u(),s[e]=t)}else if(!i.deleted){r.set(e,h);const n=s[e];void 0!==n&&(Te(n,h)?i.delete(t):("retain"===o&&u(),null===h?s[e]=h:delete s[e]))}i.deleted||("insert"===o&&u(),We(n,i.content))}i=i.right}for(u();e.length>0;){let t=e[e.length-1];if(void 0===t.retain||void 0!==t.attributes)break;e.pop()}})}return this._delta}}class ze extends ae{constructor(t){super(),this._pending=void 0!==t?[()=>this.insert(0,t)]:[]}get length(){return this._length}_integrate(t,e){super._integrate(t,e);try{this._pending.forEach(t=>t())}catch(t){console.error(t)}this._pending=null}_copy(){return new ze}_callObserver(t,e){le(this,t,new Re(this,t))}toString(){let t="",e=this._start;for(;null!==e;)!e.deleted&&e.countable&&e.content.constructor===on&&(t+=e.content.str),e=e.right;return t}applyDelta(t){null!==this.doc?ie(this.doc,e=>{let n=new Ae(null,this._start);const r=new Map;for(let i=0;t.length>i;i++){const o=t[i];if(void 0!==o.insert){const s="string"==typeof o.insert&&i===t.length-1&&null===n.right&&"\n"===o.insert.slice(-1)?o.insert.slice(0,-1):o.insert;("string"!=typeof s||s.length>0)&&(n=He(e,this,n.left,n.right,r,s,o.attributes||{}))}else void 0!==o.retain?n=Fe(e,this,n.left,n.right,r,o.retain,o.attributes||{}):void 0!==o.delete&&(n=Pe(e,n.left,n.right,r,o.delete))}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,e,n){const r=[],i=new Map;let o="",s=this._start;function l(){if(o.length>0){const t={};let e=!1;for(let[n,r]of i)e=!0,t[n]=r;const n={insert:o};e&&(n.attributes=t),r.push(n),o=""}}return ie(this.doc,a=>{for(t&&Bt(a,t),e&&Bt(a,e);null!==s;){if(zt(s,t)||void 0!==e&&zt(s,e))switch(s.content.constructor){case on:const a=i.get("ychange");void 0===t||zt(s,t)?void 0===e||zt(s,e)?void 0!==a&&(l(),i.delete("ychange")):void 0!==a&&a.user===s.id.client&&"added"===a.state||(l(),i.set("ychange",n?n("added",s.id):{type:"added"})):void 0!==a&&a.user===s.id.client&&"removed"===a.state||(l(),i.set("ychange",n?n("removed",s.id):{type:"removed"})),o+=s.content.str;break;case tn:l(),r.push({insert:s.content.embed});break;case en:zt(s,t)&&(l(),We(i,s.content))}s=s.right}l()},Bt),r}insert(t,e,n){if(0>=e.length)return;const r=this.doc;null!==r?ie(r,r=>{const{left:i,right:o,currentAttributes:s}=_e(r,this,t);n||(n={},s.forEach((t,e)=>{n[e]=t})),He(r,this,i,o,s,e,n)}):this._pending.push(()=>this.insert(t,e,n))}insertEmbed(t,e,n={}){if(e.constructor!==Object)throw new Error("Embed must be an Object");const r=this.doc;null!==r?ie(r,r=>{const{left:i,right:o,currentAttributes:s}=_e(r,this,t);He(r,this,i,o,s,e,n)}):this._pending.push(()=>this.insertEmbed(t,e,n))}delete(t,e){if(0===e)return;const n=this.doc;null!==n?ie(n,n=>{const{left:r,right:i,currentAttributes:o}=_e(n,this,t);Pe(n,r,i,o,e)}):this._pending.push(()=>this.delete(t,e))}format(t,e,n){const r=this.doc;null!==r?ie(r,r=>{let{left:i,right:o,currentAttributes:s}=_e(r,this,t);null!==o&&Fe(r,this,i,o,s,e,n)}):this._pending.push(()=>this.format(t,e,n))}_write(t){E(t,cn)}}class Be{constructor(t,e=(()=>!0)){this._filter=e,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,e=t.content.type;if(null!==t&&(!this._firstCall||t.deleted||!this._filter(e)))do{if(e=t.content.type,t.deleted||e.constructor!==je&&e.constructor!==Ue||null===e._start)for(;null!==t;){if(null!==t.right){t=t.right;break}t=t.parent===this._root?null:t.parent._item}else t=e._start}while(null!==t&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,null===t?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class Ue extends ae{constructor(){super(),this._prelimContent=[]}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Ue}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(t){return new Be(this,t)}querySelector(t){t=t.toUpperCase();const e=new Be(this,e=>e.nodeName&&e.nodeName.toUpperCase()===t).next();return e.done?null:e.value}querySelectorAll(t){return t=t.toUpperCase(),Array.from(new Be(this,e=>e.nodeName&&e.nodeName.toUpperCase()===t))}_callObserver(t,e){le(this,t,new Ve(this,e,t))}toString(){return he(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,e={},n){const r=t.createDocumentFragment();return void 0!==n&&n._createAssociation(r,this),ue(this,i=>{r.insertBefore(i.toDOM(t,e,n),null)}),r}insert(t,e){null!==this.doc?ie(this.doc,n=>{ge(n,this,t,e)}):this._prelimContent.splice(t,0,...e)}delete(t,e=1){null!==this.doc?ie(this.doc,n=>{me(n,this,t,e)}):this._prelimContent.splice(t,e)}toArray(){return ce(this)}_write(t){E(t,hn)}}class je extends Ue{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}_integrate(t,e){super._integrate(t,e),this._prelimAttrs.forEach((t,e)=>{this.setAttribute(e,t)}),this._prelimAttrs=null}_copy(){return new je(this.nodeName)}toString(){const t=this.getAttributes(),e=[],n=[];for(let e in t)n.push(e);n.sort();const r=n.length;for(let i=0;r>i;i++){const r=n[i];e.push(r+'="'+t[r]+'"')}const i=this.nodeName.toLocaleLowerCase();return`<${i}${e.length>0?" "+e.join(" "):""}>${super.toString()}</${i}>`}removeAttribute(t){null!==this.doc?ie(this.doc,e=>{ve(e,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,e){null!==this.doc?ie(this.doc,n=>{ye(n,this,t,e)}):this._prelimAttrs.set(t,e)}getAttribute(t){return be(this,t)}getAttributes(t){return we(this)}toDOM(t=document,e={},n){const r=t.createElement(this.nodeName);let i=this.getAttributes();for(let t in i)r.setAttribute(t,i[t]);return ue(this,i=>{r.appendChild(i.toDOM(t,e,n))}),void 0!==n&&n._createAssociation(r,this),r}_write(t){E(t,un),I(t,this.nodeName)}}class Ve extends oe{constructor(t,e,n){super(t,n),this.childListChanged=!1,this.attributesChanged=new Set,e.forEach(t=>{null===t?this.childListChanged=!0:this.attributesChanged.add(t)})}}class Ge extends Me{constructor(t){super(),this.hookName=t}_copy(){return new Ge(this.hookName)}toDOM(t=document,e={},n){const r=e[this.hookName];let i;return(i=void 0!==r?r.createDom(this):document.createElement(this.hookName)).setAttribute("data-yjs-hook",this.hookName),void 0!==n&&n._createAssociation(i,this),i}_write(t){super._write(t),E(t,dn),I(t,this.hookName)}}class $e extends ze{_copy(){return new $e}toDOM(t=document,e,n){const r=t.createTextNode(this.toString());return void 0!==n&&n._createAssociation(r,this),r}toString(){return this.toDelta().map(t=>{const e=[];for(let n in t.attributes){const r=[];for(let e in t.attributes[n])r.push({key:e,value:t.attributes[n][e]});r.sort((t,e)=>e.key>t.key?-1:1),e.push({nodeName:n,attrs:r})}e.sort((t,e)=>e.nodeName>t.nodeName?-1:1);let n="";for(let t=0;e.length>t;t++){const r=e[t];n+=`<${r.nodeName}`;for(let t=0;r.attrs.length>t;t++){const e=r.attrs[t];n+=` ${e.key}="${e.value}"`}n+=">"}n+=t.insert;for(let t=e.length-1;t>=0;t--)n+=`</${e[t].nodeName}>`;return n}).join("")}toJSON(){return this.toString()}_write(t){E(t,fn)}}class Ke{constructor(t,e){this.id=t,this.length=e,this.deleted=!1}mergeWith(t){return!1}write(t,e,n){throw tt()}integrate(t){throw tt()}}class Xe{constructor(t){this._missing=[],this.id=t}getMissing(t){return this._missing}toStruct(t,e,n){throw tt()}}const Ye=0;class qe extends Ke{constructor(t,e){super(t,e),this.deleted=!0}delete(){}mergeWith(t){return this.length+=t.length,!0}integrate(t){Gt(t.doc.store,this)}write(t,e){W(t,Ye),E(t,this.length-e)}}class Je extends Xe{constructor(t,e,n){super(e),this.length=V(t)}toStruct(t,e,n){return n>0&&(this.id=Ot(this.id.client,this.id.clock+n),this.length-=n),new qe(this.id,this.length)}}class Ze{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Ze(this.content)}splice(t){throw tt()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){H(t,this.content)}getRef(){return 3}}class Qe{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Qe(this.len)}splice(t){const e=new Qe(this.len-t);return this.len=t,e}mergeWith(t){return this.len+=t.len,!0}integrate(t,e){ht(t.deleteSet,e.id,this.len),e.deleted=!0}delete(t){}gc(t){}write(t,e){E(t,this.len-e)}getRef(){return 1}}class tn{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new tn(this.embed)}splice(t){throw tt()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){I(t,JSON.stringify(this.embed))}getRef(){return 5}}class en{constructor(t,e){this.key=t,this.value=e}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new en(this.key,this.value)}splice(t){throw tt()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){I(t,this.key),I(t,JSON.stringify(this.value))}getRef(){return 6}}class nn{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new nn(this.arr)}splice(t){const e=new nn(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const n=this.arr.length;E(t,n-e);for(let r=e;n>r;r++){const e=this.arr[r];I(t,void 0===e?"undefined":JSON.stringify(e))}}getRef(){return 2}}class rn{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new rn(this.arr)}splice(t){const e=new rn(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const n=this.arr.length;E(t,n-e);for(let r=e;n>r;r++){R(t,this.arr[r])}}getRef(){return 8}}class on{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new on(this.str)}splice(t){const e=new on(this.str.slice(t));return this.str=this.str.slice(0,t),e}mergeWith(t){return this.str+=t.str,!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){I(t,0===e?this.str:this.str.slice(e))}getRef(){return 4}}const sn=[t=>new Se,t=>new Me,t=>new ze,t=>new je(G(t)),t=>new Ue,t=>new Ge(G(t)),t=>new $e],ln=0,an=1,cn=2,un=3,hn=4,dn=5,fn=6;class pn{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new pn(this.type._copy())}splice(t){throw tt()}mergeWith(t){return!1}integrate(t,e){this.type._integrate(t.doc,e)}delete(t){let e=this.type._start;for(;null!==e;)e.deleted?t._mergeStructs.add(e.id):e.delete(t),e=e.right;this.type._map.forEach(e=>{e.deleted?t._mergeStructs.add(e.id):e.delete(t)}),t.changed.delete(this.type)}gc(t){let e=this.type._start;for(;null!==e;)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach(e=>{for(;null!==e;)e.gc(t,!0),e=e.left}),this.type._map=new Map}write(t,e){this.type._write(t)}getRef(){return 7}}const gn=(t,e)=>{let n,r=e,i=0;do{i>0&&(r=Ot(r.client,r.clock+i)),n=Kt(t,r),i=r.clock-n.id.clock,r=n.redone}while(null!==r);return{item:n,diff:i}},mn=(t,e,n)=>{const r=e.id,i=new vn(Ot(r.client,r.clock+n),e,Ot(r.client,r.clock+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&(i.deleted=!0),e.keep&&(i.keep=!0),null!==e.redone&&(i.redone=Ot(e.redone.client,e.redone.clock+n)),e.right=i,null!==i.right&&(i.right.left=i),t._mergeStructs.add(i.id),null!==i.parentSub&&null===i.right&&i.parent._map.set(i.parentSub,i),e.length=n,i};class vn extends Ke{constructor(t,e,n,r,i,o,s,l){super(t,l.getLength()),this.origin=n,this.left=e,this.right=r,this.rightOrigin=i,this.parent=o,this.parentSub=s,this.deleted=!1,this.redone=null,this.content=l,this.length=l.getLength(),this.countable=l.isCountable(),this.keep=!1}integrate(t){const e=t.doc.store,n=this.id,r=this.parent,i=this.parentSub,o=this.length;let s;if(null!==this.left)s=this.left.right;else if(null!==i)for(s=r._map.get(i)||null;null!==s&&null!==s.left;)s=s.left;else s=r._start;const l=new Set,a=new Set;for(;null!==s&&s!==this.right;){if(a.add(s),l.add(s),Nt(this.origin,s.origin))n.client>s.id.client&&(this.left=s,l.clear());else{if(null===s.origin||!a.has(Kt(e,s.origin)))break;null!==s.origin&&l.has(Kt(e,s.origin))||(this.left=s,l.clear())}s=s.right}if(null!==this.left){this.right=this.left.right,this.left.right=this}else{let t;if(null!==i)for(t=r._map.get(i)||null;null!==t&&null!==t.left;)t=t.left;else t=r._start,r._start=this;this.right=t}null!==this.right?this.right.left=this:null!==i&&(r._map.set(i,this),null!==this.left&&this.left.delete(t)),null===i&&this.countable&&!this.deleted&&(r._length+=o),Gt(e,this),this.content.integrate(t,this),ne(t,r,i),(null!==r._item&&r._item.deleted||null!==this.right&&null!==i)&&this.delete(t)}get next(){let t=this.right;for(;null!==t&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;null!==t&&t.deleted;)t=t.left;return t}get lastId(){return Ot(this.id.client,this.id.clock+this.length-1)}mergeWith(t){return!!(Nt(t.origin,this.lastId)&&this.right===t&&Nt(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&null===this.redone&&null===t.redone&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content))&&(t.keep&&(this.keep=!0),this.right=t.right,null!==this.right&&(this.right.left=this),this.length+=t.length,!0)}delete(t){if(!this.deleted){const e=this.parent;this.countable&&null===this.parentSub&&(e._length-=this.length),this.deleted=!0,ht(t.deleteSet,this.id,this.length),c(t.changed,e,Y).add(this.parentSub),this.content.delete(t)}}gc(t,e){if(!this.deleted)throw et();this.content.gc(t),e?Jt(t,this,new qe(this.id,this.length)):this.content=new Qe(this.length)}write(t,e){const n=e>0?Ot(this.id.client,this.id.clock+e-1):this.origin,r=this.rightOrigin,i=this.parentSub,o=this.content.getRef()&M|(null===n?0:L)|(null===r?0:S)|(null===i?0:C);if(W(t,o),null!==n&&_t(t,n),null!==r&&_t(t,r),null===n&&null===r){const e=this.parent;if(null===e._item){const n=Wt(e);E(t,1),I(t,n)}else E(t,0),_t(t,e._item.id);null!==i&&I(t,i)}this.content.write(t,e)}}const yn=(t,e)=>bn[e&M](t),bn=[()=>{throw et()},t=>new Qe(V(t)),t=>{const e=V(t),n=[];for(let r=0;e>r;r++){const e=G(t);n.push("undefined"===e?void 0:JSON.parse(e))}return new nn(n)},t=>new Ze((t=>{const e=y(t.byteLength);return e.set(t),e})(U(t))),t=>new on(G(t)),t=>new tn(JSON.parse(G(t))),t=>new en(G(t),JSON.parse(G(t))),t=>new pn(sn[V(t)](t)),t=>{const e=V(t),n=[];for(let r=0;e>r;r++)n.push(X(t));return new rn(n)}];class wn extends Xe{constructor(t,e,n){super(e),this.left=(n&L)===L?Dt(t):null,this.right=(n&S)===S?Dt(t):null;const r=0==(n&(S|L)),i=!!r&&1===V(t);this.parentYKey=r&&i?G(t):null,this.parent=r&&!i?Dt(t):null,this.parentSub=r&&(n&C)===C?G(t):null;const o=this._missing;null!==this.left&&o.push(this.left),null!==this.right&&o.push(this.right),null!==this.parent&&o.push(this.parent),this.content=yn(t,n),this.length=this.content.getLength()}toStruct(t,e,n){if(n>0){const t=this.id;this.id=Ot(t.client,t.clock+n),this.left=Ot(this.id.client,this.id.clock-1),this.content=this.content.splice(n),this.length-=n}const r=null===this.left?null:qt(t,e,this.left),i=null===this.right?null:Yt(t,this.right);let o=null,s=this.parentSub;if(null!==this.parent){const t=Kt(e,this.parent);t.deleted||null!==r&&r.constructor===qe||null!==i&&i.constructor===qe||(o=t.content.type)}else if(null!==this.parentYKey)o=t.doc.get(this.parentYKey);else if(null!==r)r.constructor!==qe&&(o=r.parent,s=r.parentSub);else{if(null===i)throw et();i.constructor!==qe&&(o=i.parent,s=i.parentSub)}return null===o?new qe(this.id,this.length):new vn(this.id,r,this.left,i,this.right,o,s,this.content)}}const xn=new Map;const kn="undefined"==typeof BroadcastChannel?class{constructor(t){this.room=t,this.onmessage=null,addEventListener("storage",e=>e.key===t&&null!==this.onmessage&&this.onmessage({data:k(e.newValue||"")}))}postMessage(t){"undefined"!=typeof localStorage&&localStorage.setItem(this.room,x(w(t)))}}:BroadcastChannel,Cn=t=>c(xn,t,()=>{const e=new Set,n=new kn(t);return n.onmessage=(t=>e.forEach(e=>e(t.data))),{bc:n,subs:e}}),Sn=(t,e)=>Cn(t).subs.add(e),Ln=(t,e)=>Cn(t).subs.delete(e),Mn=(t,e)=>{const n=Cn(t);n.bc.postMessage(e),n.subs.forEach(t=>t(e))},Tn=(t,e)=>{E(t,0);const n=(t=>{const e=N();return kt(e,t),_(e)})(e);H(t,n)},An=(t,e,n)=>{E(t,1),H(t,wt(e,n))},Nn=(t,e,n)=>{bt(e,U(t),n)},On=(t,e)=>{E(t,2),H(t,e)},_n=Nn,Dn=(t,e,n,r)=>{const i=V(t);switch(i){case 0:((t,e,n)=>An(e,n,U(t)))(t,e,n);break;case 1:Nn(t,n,r);break;case 2:_n(t,n,r);break;default:throw new Error("Unknown message type")}return i},Wn=3e4;class En extends q{constructor(t){super(),this.doc=t,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const e=nt();null===this.getLocalState()||Wn/2>e-this.meta.get(t.clientID).lastUpdated||this.setLocalState(this.getLocalState());const n=[];this.meta.forEach((r,i)=>{i!==t.clientID&&e-r.lastUpdated>=Wn&&this.states.has(i)&&n.push(i)}),n.length>0&&In(this,n,"timeout")},n(Wn/10)),t.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.doc.clientID)||null}setLocalState(t){const e=this.doc.clientID,n=this.meta.get(e),r=void 0===n?0:n.clock+1;null===t?this.states.delete(e):this.states.set(e,t),this.meta.set(e,{clock:r,lastUpdated:nt()});const i=[],o=[],s=[];null===t?s.push(e):void 0===n?i.push(e):o.push(e),this.emit("change",[{added:i,updated:o,removed:s},"local"])}setLocalStateField(t,e){const n=this.getLocalState();null!==n&&(n[t]=e,this.setLocalState(n))}getStates(){return this.states}}const In=(t,e,n)=>{const r=[];for(let n=0;e.length>n;n++){const i=e[n];if(t.states.has(i)){if(t.states.delete(i),i===t.doc.clientID){const e=t.meta.get(i);t.meta.set(i,{clock:e.clock+1,lastUpdated:nt()})}r.push(i)}}r.length>0&&t.emit("change",[{added:[],updated:[],removed:r},n])},Hn=(t,e,n=t.states)=>{const r=e.length,i=N();E(i,r);for(let o=0;r>o;o++){const r=e[o],s=n.get(r)||null,l=t.meta.get(r).clock;E(i,r),E(i,l),I(i,JSON.stringify(s))}return _(i)},Fn=()=>{let t=!0;return(e,n)=>{if(t){t=!1;try{e()}finally{t=!0}}else void 0!==n&&n()}},Pn=0,Rn=3,zn=1,Bn=3e4,Un=(t,e)=>console.warn(`Permission denied to access ${t.url}.\n${e}`),jn=(t,e)=>{const n=B(e),r=N();switch(V(n)){case Pn:E(r,Pn),Dn(n,r,t.doc,t);break;case Rn:E(r,zn),H(r,Hn(t.awareness,Array.from(t.awareness.getStates().keys())));break;case zn:((t,e,n)=>{const r=B(e),i=nt(),o=[],s=[],l=[],a=V(r);for(let e=0;a>e;e++){const e=V(r);let n=V(r);const a=JSON.parse(G(r)),c=t.meta.get(e),u=void 0===c?0:c.clock;(n>u||u===n&&null===a&&t.states.has(e))&&(null===a?e===t.doc.clientID&&null!=t.getLocalState()?n++:t.states.delete(e):t.states.set(e,a),t.meta.set(e,{clock:n,lastUpdated:i}),void 0===c&&null!==a?o.push(e):void 0!==c&&null===a?l.push(e):null!==a&&s.push(e))}(o.length>0||s.length>0||l.length>0)&&t.emit("change",[{added:o,updated:s,removed:l},n])})(t.awareness,U(n),t);break;case 2:((t,e,n)=>{switch(V(t)){case 0:n(e,G(t))}})(n,t,Un);break;default:return console.error("Unable to compute message"),r}return r},Vn=t=>{if(t.shouldConnect&&null===t.ws){const e=new WebSocket(t.url);e.binaryType="arraybuffer",t.ws=e,t.wsconnecting=!0,t.wsconnected=!1,e.onmessage=(n=>{t.wsLastMessageReceived=nt();const r=jn(t,new Uint8Array(n.data));O(r)>1&&e.send(_(r))}),e.onclose=(()=>{t.ws=null,t.wsconnecting=!1,t.wsconnected?(t.wsconnected=!1,In(t.awareness,Array.from(t.awareness.getStates().keys()),t),t.emit("status",[{status:"disconnected"}])):t.wsUnsuccessfulReconnects++,setTimeout(Vn,s(1200*i(t.wsUnsuccessfulReconnects+1),2500),t)}),e.onopen=(()=>{t.wsLastMessageReceived=nt(),t.wsconnecting=!1,t.wsconnected=!0,t.wsUnsuccessfulReconnects=0,t.emit("status",[{status:"connected"}]);const n=N();if(E(n,Pn),Tn(n,t.doc),e.send(_(n)),null!==t.awareness.getLocalState()){const n=N();E(n,zn),H(n,Hn(t.awareness,[t.doc.clientID])),e.send(_(n))}})}},Gn=(t,e)=>{t.wsconnected&&t.ws.send(e),t.bcconnected&&t.mux(()=>{Mn(t.url,e)})};class $n extends q{constructor(t,e,n,{awareness:r=new En(n),db:i=null}={}){for(super();"/"===t[t.length-1];)t=t.slice(0,t.length-1);this.url=t+"/"+e,this.roomname=e,this.doc=n,this._localAwarenessState={},this.db=i,this.awareness=r,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.wsUnsuccessfulReconnects=0,this.mux=Fn(),this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=!0,this._bcSubscriber=(t=>{this.mux(()=>{const e=jn(this,new Uint8Array(t));O(e)>1&&Mn(this.url,_(e))})}),this._updateHandler=((t,e)=>{if(e!==this||null===e){const e=N();E(e,Pn),On(e,t),Gn(this,_(e))}}),this._awarenessUpdateHandler=(({},t)=>{const e=N();E(e,zn),H(e,Hn(r,[n.clientID])),Gn(this,_(e))}),window.addEventListener("beforeunload",()=>{const t=N();E(t,zn),H(t,Hn(this.awareness,[this.doc.clientID],new Map)),Gn(this,_(t))}),r.on("change",this._awarenessUpdateHandler),this._checkInterval=setInterval(()=>{this.wsconnected&&Bn<nt()-this.wsLastMessageReceived&&this.ws.close()}),this.connect()}destroy(){clearInterval(this._checkInterval),this.disconnect(),this.awareness.off("change",this._awarenessUpdateHandler),super.destroy()}disconnect(){this.shouldConnect=!1;const t=N();E(t,zn),H(t,Hn(this.awareness,[this.doc.clientID],new Map)),Gn(this,_(t)),null!==this.ws&&this.ws.close(),this.bcconnected&&(Ln(this.url,this._bcSubscriber),this.bcconnected=!1),this.doc.off("update",this._updateHandler)}connect(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(Vn(this),this.bcconnected||(Sn(this.url,this._bcSubscriber),this.bcconnected=!0),this.mux(()=>{const t=N();E(t,Pn),Tn(t,this.doc),Mn(this.url,_(t));const e=N();E(e,Pn),An(e,this.doc),Mn(this.url,_(e));const n=N();E(n,Rn),Mn(this.url,_(n));const r=N();E(r,zn),H(r,Hn(this.awareness,[this.doc.clientID])),Mn(this.url,_(r))}),this.doc.on("update",this._updateHandler))}}const Kn=(t,e)=>{t._mux(()=>{const n=t.target;n.operation(()=>{const t=e.delta;let r=0;for(let i=0;e.delta.length>i;i++){const e=t[i];if(e.retain)r+=e.retain;else if(e.insert){const t=n.posFromIndex(r);n.replaceRange(e.insert,t,t,"prosemirror-binding"),r+=e.insert.length}else if(e.delete){const t=n.posFromIndex(r),i=n.posFromIndex(r+e.delete);n.replaceRange("",t,i,"prosemirror-binding")}}})})},Xn=(t,e)=>{t._mux(()=>{const n=t.target.indexFromPos(e.from),r=e.removed.map(t=>t.length).reduce(o)+e.removed.length-1;r>0&&t.type.delete(n,r),e.text.length>0&&t.type.insert(n,e.text.join("\n"))})},Yn=(t,e,n,r,i,o)=>{const s=r.get(i);void 0!==s&&(s.caret.clear(),null!==s.sel&&s.sel.clear(),r.delete(i));const l=o.getStates().get(i);if(void 0===l)return;const a=l.user||{};null==a.color&&(a.color="#ffa500"),null==a.name&&(a.name=`User: ${i}`);const c=l.cursor;if(null==c||null==c.anchor||null==c.head)return;const u=Pt(JSON.parse(c.anchor),t),h=Pt(JSON.parse(c.head),t);if(null!==u&&null!==h&&u.type===n&&h.type===n){const t=e.posFromIndex(h.index),n=e.posFromIndex(u.index);let o,s;u.index>h.index?(o=t,s=n):(o=n,s=t);const l=((t,e)=>{const n=document.createElement("span");n.classList.add("remote-caret"),n.setAttribute("style",`border-color: ${e}`);const r=document.createElement("div");return r.setAttribute("style",`background-color: ${e}`),r.insertBefore(document.createTextNode(t),null),n.insertBefore(r,null),n})(a.name,a.color),c=e.setBookmark(t,{widget:l,insertLeft:!0});let d=null;h.index!==u.index&&(d=e.markText(o,s,{css:`background-color: ${a.color}70`,inclusiveRight:!0,inclusiveLeft:!1})),r.set(i,{caret:c,sel:d})}},qn=(t,e,n,r)=>{if(!e.hasFocus())return;const i=Ft(n,e.indexFromPos(e.getCursor("anchor"))),o=Ft(n,e.indexFromPos(e.getCursor("head"))),s=r.getLocalState();let l=null,a=null;null!=s.cursor&&(l=Pt(JSON.parse(s.cursor.anchor),t),a=Pt(JSON.parse(s.cursor.head),t)),null!=s.cursor&&Rt(l,i)&&Rt(a,o)||r.setLocalStateField("cursor",{anchor:JSON.stringify(i),head:JSON.stringify(o)})};class Jn{constructor(t,e,n){const r=t.doc;this.type=t,this.target=e,this.awareness=n,this._mux=Fn(),e.setValue(t.toString()),this._typeObserver=(t=>Kn(this,t)),this._targetObserver=((t,e)=>Xn(this,e)),this._cursors=new Map,this._awarenessListener=(i=>{const o=i=>{console.log(i,r.clientID),i!==r.clientID&&Yn(r,e,t,this._cursors,i,n)};i.added.forEach(o),i.removed.forEach(o),i.updated.forEach(o)}),this._cursorListener=(()=>qn(r,e,t,n)),this._blurListeer=(()=>n.setLocalStateField("cursor",null)),t.observe(this._typeObserver),e.on("change",this._targetObserver),n&&(n.on("change",this._awarenessListener),e.on("cursorActivity",this._cursorListener),e.on("blur",this._blurListeer),e.on("focus",this._cursorListener))}destroy(){this.type.unobserve(this._typeObserver),this.target.off("change",this._targetObserver),this.target.off("cursorActivity",this._cursorListener),this.target.off("focus",this._cursorListener),this.target.off("blur",this._blurListeer),this.awareness.off("change",this._awarenessListener),this.type=null,this.target=null}}function Zn(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self,t=Zn(function(t,e){t.exports=function(){var t,e,n,r,i,o,s,l,a,c,u,h,d,f,p,g,m,v,y,b,w,x,k,C,S,L,M,T,A,N,O,_,D,W,E,I,H,F,P,R,z,B,U,j,V,G,$,K,X,Y,q,J,Z,Q,tt,et,nt,rt,it,ot,st,lt,at,ct,ut,ht,dt,ft,pt,gt,mt,vt,yt,bt,wt,xt,kt,Ct,St,Lt,Mt=navigator.userAgent,Tt=navigator.platform,At=/gecko\/\d/i.test(Mt),Nt=/MSIE \d/.test(Mt),Ot=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Mt),_t=/Edge\/(\d+)/.exec(Mt),Dt=Nt||Ot||_t,Wt=Dt&&(Nt?document.documentMode||6:+(_t||Ot)[1]),Et=!_t&&/WebKit\//.test(Mt),It=Et&&/Qt\/\d+\.\d+/.test(Mt),Ht=!_t&&/Chrome\//.test(Mt),Ft=/Opera\//.test(Mt),Pt=/Apple Computer/.test(navigator.vendor),Rt=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(Mt),zt=/PhantomJS/.test(Mt),Bt=!_t&&/AppleWebKit/.test(Mt)&&/Mobile\/\w+/.test(Mt),Ut=/Android/.test(Mt),jt=Bt||Ut||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(Mt),Vt=Bt||/Mac/.test(Tt),Gt=/\bCrOS\b/.test(Mt),$t=/win/i.test(Tt),Kt=Ft&&Mt.match(/Version\/(\d*\.\d*)/);function Xt(t){return new RegExp("(^|\\s)"+t+"(?:$|\\s)\\s*")}function Yt(t){for(var e=t.childNodes.length;e>0;--e)t.removeChild(t.firstChild);return t}function qt(t,e){return Yt(t).appendChild(e)}function Jt(t,e,n,r){var i,o=document.createElement(t);if(n&&(o.className=n),r&&(o.style.cssText=r),"string"==typeof e)o.appendChild(document.createTextNode(e));else if(e)for(i=0;e.length>i;++i)o.appendChild(e[i]);return o}function Zt(t,e,n,r){var i=Jt(t,e,n,r);return i.setAttribute("role","presentation"),i}function Qt(t,e){if(3==e.nodeType&&(e=e.parentNode),t.contains)return t.contains(e);do{if(11==e.nodeType&&(e=e.host),e==t)return!0}while(e=e.parentNode)}function te(){var t;try{t=document.activeElement}catch(e){t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function ee(t,e){var n=t.className;Xt(e).test(n)||(t.className+=(n?" ":"")+e)}function ne(t,e){var n,r=t.split(" ");for(n=0;r.length>n;n++)r[n]&&!Xt(r[n]).test(e)&&(e+=" "+r[n]);return e}function re(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e)}}function ie(t,e,n){for(var r in e||(e={}),t)!t.hasOwnProperty(r)||!1===n&&e.hasOwnProperty(r)||(e[r]=t[r]);return e}function oe(t,e,n,r,i){var o,s,l;for(null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length),o=r||0,s=i||0;;){if(0>(l=t.indexOf("\t",o))||l>=e)return s+(e-o);s+=l-o,s+=n-s%n,o=l+1}}function se(t,e){for(var n=0;t.length>n;++n)if(t[n]==e)return n;return-1}function le(t,e,n){var r,i,o,s;for(r=0,i=0;;){if(-1==(o=t.indexOf("\t",r))&&(o=t.length),s=o-r,o==t.length||i+s>=e)return r+Math.min(s,e-i);if(i+=o-r,r=o+1,(i+=n-i%n)>=e)return r}}function ae(t){for(;t>=h.length;)h.push(ce(h)+" ");return h[t]}function ce(t){return t[t.length-1]}function ue(t,e){var n,r=[];for(n=0;t.length>n;n++)r[n]=e(t[n],n);return r}function he(){}function de(t,e){var n;return Object.create?n=Object.create(t):(he.prototype=t,n=new he),e&&ie(e,n),n}function fe(t){return/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||d.test(t))}function pe(t,e){return e?!(-1>=e.source.indexOf("\\w")||!fe(t))||e.test(t):fe(t)}function ge(t){for(var e in t)if(t.hasOwnProperty(e)&&t[e])return!1;return!0}function me(t){return t.charCodeAt(0)>=768&&f.test(t)}function ve(t,e,n){for(;(0>n?e>0:t.length>e)&&me(t.charAt(e));)e+=n;return e}function ye(t,e,n){for(var r,i,o=e>n?-1:1;;){if(e==n)return e;if(r=(e+n)/2,(i=0>o?Math.ceil(r):Math.floor(r))==e)return t(i)?e:n;t(i)?n=i:e=i+o}}function be(t,e,n){var r,i,o;for(p=null,i=0;t.length>i;++i){if(e>(o=t[i]).from&&o.to>e)return i;o.to==e&&(o.from!=o.to&&"before"==n?r=i:p=i),o.from==e&&(o.from!=o.to&&"before"!=n?r=i:p=i)}return null!=r?r:p}function we(t,e){var n=t.order;return null==n&&(n=t.order=g(t.text,e)),n}function xe(t,e){return t._handlers&&t._handlers[e]||m}function ke(t,e,n){var r,i,o;t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):(i=(r=t._handlers)&&r[e])&&(o=se(i,n))>-1&&(r[e]=i.slice(0,o).concat(i.slice(o+1)))}function Ce(t,e){var n,r,i=xe(t,e);if(i.length)for(n=Array.prototype.slice.call(arguments,2),r=0;i.length>r;++r)i[r].apply(null,n)}function Se(t,e,n){return"string"==typeof e&&(e={type:e,preventDefault:function(){this.defaultPrevented=!0}}),Ce(t,n||e.type,t,e),Oe(e)||e.codemirrorIgnore}function Le(t){var e,n,r=t._handlers&&t._handlers.cursorActivity;if(r)for(e=t.curOp.cursorActivityHandlers||(t.curOp.cursorActivityHandlers=[]),n=0;r.length>n;++n)-1==se(e,r[n])&&e.push(r[n])}function Me(t,e){return xe(t,e).length>0}function Te(t){t.prototype.on=function(t,e){v(this,t,e)},t.prototype.off=function(t,e){ke(this,t,e)}}function Ae(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function Ne(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function Oe(t){return null!=t.defaultPrevented?t.defaultPrevented:0==t.returnValue}function _e(t){Ae(t),Ne(t)}function De(t){return t.target||t.srcElement}function We(t){var e=t.which;return null==e&&(1&t.button?e=1:2&t.button?e=3:4&t.button&&(e=2)),Vt&&t.ctrlKey&&1==e&&(e=3),e}function Ee(t){var e,n;return null==b&&(e=Jt("span","​"),qt(t,Jt("span",[e,document.createTextNode("x")])),0!=t.firstChild.offsetHeight&&(b=1>=e.offsetWidth&&e.offsetHeight>2&&!(Dt&&8>Wt))),(n=b?Jt("span","​"):Jt("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")).setAttribute("cm-text",""),n}function Ie(t){if("string"==typeof t&&M.hasOwnProperty(t))t=M[t];else if(t&&"string"==typeof t.name&&M.hasOwnProperty(t.name)){var e=M[t.name];"string"==typeof e&&(e={name:e}),(t=de(e,t)).name=e.name}else{if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return Ie("application/xml");if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+json$/.test(t))return Ie("application/json")}return"string"==typeof t?{name:t}:t||{name:"null"}}function He(t,e){var n,r,i,o,s;if(e=Ie(e),!(n=L[e.name]))return He(t,"text/plain");if(r=n(t,e),T.hasOwnProperty(e.name))for(o in i=T[e.name])i.hasOwnProperty(o)&&(r.hasOwnProperty(o)&&(r["_"+o]=r[o]),r[o]=i[o]);if(r.name=e.name,e.helperType&&(r.helperType=e.helperType),e.modeProps)for(s in e.modeProps)r[s]=e.modeProps[s];return r}function Fe(t,e){var n=T.hasOwnProperty(t)?T[t]:T[t]={};ie(e,n)}function Pe(t,e){var n,r,i;if(!0===e)return e;if(t.copyState)return t.copyState(e);for(r in n={},e)(i=e[r])instanceof Array&&(i=i.concat([])),n[r]=i;return n}function Re(t,e){for(var n;t.innerMode&&(n=t.innerMode(e))&&n.mode!=t;)e=n.state,t=n.mode;return n||{mode:t,state:e}}function ze(t,e,n){return!t.startState||t.startState(e,n)}function Be(t,e){var n,r,i,o;if(0>(e-=t.first)||e>=t.size)throw new Error("There is no line "+(e+t.first)+" in the document.");for(n=t;!n.lines;)for(r=0;;++r){if((o=(i=n.children[r]).chunkSize())>e){n=i;break}e-=o}return n.lines[e]}function Ue(t,e,n){var r=[],i=e.line;return t.iter(e.line,n.line+1,function(t){var o=t.text;i==n.line&&(o=o.slice(0,n.ch)),i==e.line&&(o=o.slice(e.ch)),r.push(o),++i}),r}function je(t,e,n){var r=[];return t.iter(e,n,function(t){r.push(t.text)}),r}function Ve(t,e){var n,r=e-t.height;if(r)for(n=t;n;n=n.parent)n.height+=r}function Ge(t){var e,n,r,i;if(null==t.parent)return null;for(n=se((e=t.parent).lines,t),r=e.parent;r;e=r,r=r.parent)for(i=0;r.children[i]!=e;++i)n+=r.children[i].chunkSize();return n+e.first}function $e(t,e){var n,r,i,o,s,l=t.first;t:do{for(n=0;t.children.length>n;++n){if((i=(r=t.children[n]).height)>e){t=r;continue t}e-=i,l+=r.chunkSize()}return l}while(!t.lines);for(o=0;t.lines.length>o&&(s=t.lines[o].height)<=e;++o)e-=s;return l+o}function Ke(t,e){return e>=t.first&&t.first+t.size>e}function Xe(t,e){return String(t.lineNumberFormatter(e+t.firstLineNumber))}function Ye(t,e,n){if(void 0===n&&(n=null),!(this instanceof Ye))return new Ye(t,e,n);this.line=t,this.ch=e,this.sticky=n}function qe(t,e){return t.line-e.line||t.ch-e.ch}function Je(t,e){return t.sticky==e.sticky&&0==qe(t,e)}function Ze(t){return Ye(t.line,t.ch)}function Qe(t,e){return 0>qe(t,e)?e:t}function tn(t,e){return 0>qe(t,e)?t:e}function en(t,e){return Math.max(t.first,Math.min(e,t.first+t.size-1))}function nn(t,e){if(t.first>e.line)return Ye(t.first,0);var n=t.first+t.size-1;return e.line>n?Ye(n,Be(t,n).text.length):function(t,e){var n=t.ch;return null==n||n>e?Ye(t.line,e):0>n?Ye(t.line,0):t}(e,Be(t,e.line).text.length)}function rn(t,e){var n,r=[];for(n=0;e.length>n;n++)r[n]=nn(t,e[n]);return r}function on(t,e,n,r){var i,o,s,l=[t.state.modeGen],a={};for(fn(t,e.text,t.doc.mode,n,function(t,e){return l.push(t,e)},a,r),i=n.state,o=function(r){n.baseTokens=l;var o=t.state.overlays[r],s=1,c=0;n.state=!0,fn(t,e.text,o.mode,n,function(t,e){for(var n,r,i=s;t>c;)(n=l[s])>t&&l.splice(s,1,t,l[s+1],n),s+=2,c=Math.min(t,n);if(e)if(o.opaque)l.splice(i,s-i,t,"overlay "+e),s=i+2;else for(;s>i;i+=2)l[i+1]=((r=l[i+1])?r+" ":"")+"overlay "+e},a),n.state=i,n.baseTokens=null,n.baseTokenPos=1},s=0;t.state.overlays.length>s;++s)o(s);return{styles:l,classes:a.bgClass||a.textClass?a:null}}function sn(t,e,n){var r,i,o;return e.styles&&e.styles[0]==t.state.modeGen||(r=ln(t,Ge(e)),i=e.text.length>t.options.maxHighlightLength&&Pe(t.doc.mode,r.state),o=on(t,e,r),i&&(r.state=i),e.stateAfter=r.save(!i),e.styles=o.styles,o.classes?e.styleClasses=o.classes:e.styleClasses&&(e.styleClasses=null),n===t.doc.highlightFrontier&&(t.doc.modeFrontier=Math.max(t.doc.modeFrontier,++t.doc.highlightFrontier))),e.styles}function ln(t,e,n){var r,i,o,s=t.doc,l=t.display;return s.mode.startState?(r=function(t,e,n){var r,i,o,s,l,a,c,u;for(o=t.doc,s=n?-1:e-(t.doc.mode.innerMode?1e3:100),l=e;l>s;--l){if(o.first>=l)return o.first;if(a=Be(o,l-1),(c=a.stateAfter)&&(!n||o.modeFrontier>=l+(c instanceof N?c.lookAhead:0)))return l;u=oe(a.text,null,t.options.tabSize),(null==i||r>u)&&(i=l-1,r=u)}return i}(t,e,n),i=r>s.first&&Be(s,r-1).stateAfter,o=i?O.fromSaved(s,i,r):new O(s,ze(s.mode),r),s.iter(r,e,function(n){an(t,n.text,o);var r=o.line;n.stateAfter=r==e-1||r%5==0||r>=l.viewFrom&&l.viewTo>r?o.save():null,o.nextLine()}),n&&(s.modeFrontier=o.line),o):new O(s,!0,e)}function an(t,e,n,r){var i=t.doc.mode,o=new A(e,t.options.tabSize,n);for(o.start=o.pos=r||0,""==e&&cn(i,n.state);!o.eol();)un(i,o,n.state),o.start=o.pos}function cn(t,e){if(t.blankLine)return t.blankLine(e);if(t.innerMode){var n=Re(t,e);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function un(t,e,n,r){var i,o;for(i=0;10>i;i++)if(r&&(r[0]=Re(t,n).mode),o=t.token(e,n),e.pos>e.start)return o;throw new Error("Mode "+t.name+" failed to advance stream.")}function hn(t,e,n,r){var i,o,s,l,a,c=t.doc,u=c.mode;for(e=nn(c,e),o=Be(c,e.line),s=ln(t,e.line,n),l=new A(o.text,t.options.tabSize,s),r&&(a=[]);(r||e.ch>l.pos)&&!l.eol();)l.start=l.pos,i=un(u,l,s.state),r&&a.push(new _(l,i,Pe(c.mode,s.state)));return r?a:new _(l,i,s.state)}function dn(t,e){var n,r;if(t)for(;n=t.match(/(?:^|\s+)line-(background-)?(\S+)/);)t=t.slice(0,n.index)+t.slice(n.index+n[0].length),null==e[r=n[1]?"bgClass":"textClass"]?e[r]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(e[r])||(e[r]+=" "+n[2]);return t}function fn(t,e,n,r,i,o,s){var l,a,c,u,h,d,f,p=n.flattenSpans;for(null==p&&(p=t.options.flattenSpans),l=0,a=null,c=new A(e,t.options.tabSize,r),h=t.options.addModeClass&&[null],""==e&&dn(cn(n,r.state),o);!c.eol();){if(c.pos>t.options.maxHighlightLength?(p=!1,s&&an(t,e,r,c.pos),c.pos=e.length,u=null):u=dn(un(n,c,r.state,h),o),h&&(d=h[0].name)&&(u="m-"+(u?d+" "+u:d)),!p||a!=u){for(;c.start>l;)l=Math.min(c.start,l+5e3),i(l,a);a=u}c.start=c.pos}for(;c.pos>l;)f=Math.min(c.pos,l+5e3),i(f,a),l=f}function pn(t,e,n){this.marker=t,this.from=e,this.to=n}function gn(t,e){var n,r;if(t)for(n=0;t.length>n;++n)if((r=t[n]).marker==e)return r}function mn(t,e){var n,r;for(r=0;t.length>r;++r)t[r]!=e&&(n||(n=[])).push(t[r]);return n}function vn(t,e){var n,r,i,o,s,l,a,c,u,h,d,f,p,g,m,v,y,b,w;if(e.full)return null;if(n=Ke(t,e.from.line)&&Be(t,e.from.line).markedSpans,r=Ke(t,e.to.line)&&Be(t,e.to.line).markedSpans,!n&&!r)return null;if(i=e.from.ch,o=e.to.ch,s=0==qe(e.from,e.to),l=function(t,e,n){var r,i,o,s;if(t)for(i=0;t.length>i;++i)s=(o=t[i]).marker,null!=o.from&&(s.inclusiveLeft?o.from>e:o.from>=e)&&(o.from!=e||"bookmark"!=s.type||n&&o.marker.insertLeft)||(r||(r=[])).push(new pn(s,o.from,null==o.to||(s.inclusiveRight?o.to>=e:o.to>e)?null:o.to));return r}(n,i,s),a=function(t,e,n){var r,i,o,s;if(t)for(i=0;t.length>i;++i)s=(o=t[i]).marker,(null==o.to||(s.inclusiveRight?o.to>=e:o.to>e)||o.from==e&&"bookmark"==s.type&&(!n||o.marker.insertLeft))&&(r||(r=[])).push(new pn(s,null==o.from||(s.inclusiveLeft?e>=o.from:e>o.from)?null:o.from-e,null==o.to?null:o.to-e));return r}(r,o,s),c=1==e.text.length,u=ce(e.text).length+(c?i:0),l)for(h=0;l.length>h;++h)null==(d=l[h]).to&&((f=gn(a,d.marker))?c&&(d.to=null==f.to?null:f.to+u):d.to=i);if(a)for(p=0;a.length>p;++p)null!=(g=a[p]).to&&(g.to+=u),null==g.from?gn(l,g.marker)||(g.from=u,c&&(l||(l=[])).push(g)):(g.from+=u,c&&(l||(l=[])).push(g));if(l&&(l=yn(l)),a&&a!=l&&(a=yn(a)),m=[l],!c){if((v=e.text.length-2)>0&&l)for(b=0;l.length>b;++b)null==l[b].to&&(y||(y=[])).push(new pn(l[b].marker,null,null));for(w=0;v>w;++w)m.push(y);m.push(a)}return m}function yn(t){var e,n;for(e=0;t.length>e;++e)null!=(n=t[e]).from&&n.from==n.to&&!1!==n.marker.clearWhenEmpty&&t.splice(e--,1);return t.length?t:null}function bn(t){var e,n=t.markedSpans;if(n){for(e=0;n.length>e;++e)n[e].marker.detachLine(t);t.markedSpans=null}}function wn(t,e){if(e){for(var n=0;e.length>n;++n)e[n].marker.attachLine(t);t.markedSpans=e}}function xn(t){return t.inclusiveLeft?-1:0}function kn(t){return t.inclusiveRight?1:0}function Cn(t,e){var n,r,i,o=t.lines.length-e.lines.length;return 0!=o?o:(n=t.find(),r=e.find(),(i=qe(n.from,r.from)||xn(t)-xn(e))?-i:qe(n.to,r.to)||kn(t)-kn(e)||e.id-t.id)}function Sn(t,e){var n,r,i,o=W&&t.markedSpans;if(o)for(r=void 0,i=0;o.length>i;++i)!(r=o[i]).marker.collapsed||null!=(e?r.from:r.to)||n&&Cn(n,r.marker)>=0||(n=r.marker);return n}function Ln(t){return Sn(t,!0)}function Mn(t){return Sn(t,!1)}function Tn(t,e){var n,r,i,o=W&&t.markedSpans;if(o)for(r=0;o.length>r;++r)!(i=o[r]).marker.collapsed||null!=i.from&&i.from>=e||null!=i.to&&e>=i.to||n&&Cn(n,i.marker)>=0||(n=i.marker);return n}function An(t,e,n,r,i){var o,s,l,a,c,u=Be(t,e),h=W&&u.markedSpans;if(h)for(o=0;h.length>o;++o)if((s=h[o]).marker.collapsed&&(l=s.marker.find(0),a=qe(l.from,n)||xn(s.marker)-xn(i),c=qe(l.to,r)||kn(s.marker)-kn(i),(0>a||c>0)&&(a>0||0>c)&&(0>=a&&(s.marker.inclusiveRight&&i.inclusiveLeft?qe(l.to,n)>=0:qe(l.to,n)>0)||a>=0&&(s.marker.inclusiveRight&&i.inclusiveLeft?0>=qe(l.from,r):0>qe(l.from,r)))))return!0}function Nn(t){for(var e;e=Ln(t);)t=e.find(-1,!0).line;return t}function On(t,e){var n=Be(t,e),r=Nn(n);return n==r?e:Ge(r)}function _n(t,e){if(e>t.lastLine())return e;var n,r=Be(t,e);if(!Dn(t,r))return e;for(;n=Mn(r);)r=n.find(1,!0).line;return Ge(r)+1}function Dn(t,e){var n,r,i=W&&e.markedSpans;if(i)for(n=void 0,r=0;i.length>r;++r)if((n=i[r]).marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&Wn(t,e,n))return!0}}function Wn(t,e,n){var r,i,o;if(null==n.to)return r=n.marker.find(1,!0),Wn(t,r.line,gn(r.line.markedSpans,n.marker));if(n.marker.inclusiveRight&&n.to==e.text.length)return!0;for(i=void 0,o=0;e.markedSpans.length>o;++o)if((i=e.markedSpans[o]).marker.collapsed&&!i.marker.widgetNode&&i.from==n.to&&(null==i.to||i.to!=n.from)&&(i.marker.inclusiveLeft||n.marker.inclusiveRight)&&Wn(t,e,i))return!0}function En(t){var e,n,r,i,o,s,l;for(t=Nn(t),e=0,n=t.parent,r=0;n.lines.length>r&&(i=n.lines[r])!=t;++r)e+=i.height;for(o=n.parent;o;o=(n=o).parent)for(s=0;o.children.length>s&&(l=o.children[s])!=n;++s)e+=l.height;return e}function In(t){var e,n,r,i,o;if(0==t.height)return 0;for(e=t.text.length,r=t;n=Ln(r);)i=n.find(0,!0),r=i.from.line,e+=i.from.ch-i.to.ch;for(r=t;n=Mn(r);)o=n.find(0,!0),e-=r.text.length-o.from.ch,e+=(r=o.to.line).text.length-o.to.ch;return e}function Hn(t){var e=t.display,n=t.doc;e.maxLine=Be(n,n.first),e.maxLineLength=In(e.maxLine),e.maxLineChanged=!0,n.iter(function(t){var n=In(t);n>e.maxLineLength&&(e.maxLineLength=n,e.maxLine=t)})}function Fn(t){t.parent=null,bn(t)}function Pn(t,e){if(!t||/^\s*$/.test(t))return null;var n=e.addModeClass?H:I;return n[t]||(n[t]=t.replace(/\S+/g,"cm-$&"))}function Rn(t,e){var n,i,o,s,l,a,c,u,h,d=Zt("span",null,null,Et?"padding-right: .1px":null),f={pre:Zt("pre",[d],"CodeMirror-line"),content:d,col:0,pos:0,cm:t,trailingSpace:!1,splitSpaces:t.getOption("lineWrapping")};for(e.measure={},n=0;(e.rest?e.rest.length:0)>=n;n++)i=n?e.rest[n-1]:e.line,o=void 0,f.pos=0,f.addToken=Bn,a=t.display.measure,c=void 0,u=void 0,h=void 0,(null!=w?w:(c=qt(a,document.createTextNode("AخA")),u=r(c,0,1).getBoundingClientRect(),h=r(c,1,2).getBoundingClientRect(),Yt(a),!(!u||u.left==u.right)&&(w=3>h.right-u.right)))&&(o=we(i,t.doc.direction))&&(f.addToken=Un(f.addToken,o)),f.map=[],s=e!=t.display.externalMeasured&&Ge(i),Vn(i,f,sn(t,i,s)),i.styleClasses&&(i.styleClasses.bgClass&&(f.bgClass=ne(i.styleClasses.bgClass,f.bgClass||"")),i.styleClasses.textClass&&(f.textClass=ne(i.styleClasses.textClass,f.textClass||""))),0==f.map.length&&f.map.push(0,0,f.content.appendChild(Ee(t.display.measure))),0==n?(e.measure.map=f.map,e.measure.cache={}):((e.measure.maps||(e.measure.maps=[])).push(f.map),(e.measure.caches||(e.measure.caches=[])).push({}));return Et&&(/\bcm-tab\b/.test((l=f.content.lastChild).className)||l.querySelector&&l.querySelector(".cm-tab"))&&(f.content.className="cm-tab-wrap-hack"),Ce(t,"renderLine",t,e.line,f.pre),f.pre.className&&(f.textClass=ne(f.pre.className,f.textClass||"")),f}function zn(t){var e=Jt("span","•","cm-invalidchar");return e.title="\\u"+t.charCodeAt(0).toString(16),e.setAttribute("aria-label",e.title),e}function Bn(t,e,n,r,i,o,s){var l,a,c,u,h,d,f,p,g,m,v,y,b,w;if(e){if(l=t.splitSpaces?function(t,e){var n,r,i,o;if(t.length>1&&!/  /.test(t))return t;for(n=e,r="",i=0;t.length>i;i++)" "!=(o=t.charAt(i))||!n||i!=t.length-1&&32!=t.charCodeAt(i+1)||(o=" "),r+=o,n=" "==o;return r}(e,t.trailingSpace):e,c=!1,(a=t.cm.state.specialChars).test(e))for(u=document.createDocumentFragment(),h=0;a.lastIndex=h,d=a.exec(e),(f=d?d.index-h:e.length-h)&&(p=document.createTextNode(l.slice(h,h+f)),u.appendChild(Dt&&9>Wt?Jt("span",[p]):p),t.map.push(t.pos,t.pos+f,p),t.col+=f,t.pos+=f),d;)h+=f+1,g=void 0,"\t"==d[0]?((g=u.appendChild(Jt("span",ae(v=(m=t.cm.options.tabSize)-t.col%m),"cm-tab"))).setAttribute("role","presentation"),g.setAttribute("cm-text","\t"),t.col+=v):"\r"==d[0]||"\n"==d[0]?((g=u.appendChild(Jt("span","\r"==d[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",d[0]),t.col+=1):((g=t.cm.options.specialCharPlaceholder(d[0])).setAttribute("cm-text",d[0]),u.appendChild(Dt&&9>Wt?Jt("span",[g]):g),t.col+=1),t.map.push(t.pos,t.pos+1,g),t.pos++;else t.col+=e.length,u=document.createTextNode(l),t.map.push(t.pos,t.pos+e.length,u),Dt&&9>Wt&&(c=!0),t.pos+=e.length;if(t.trailingSpace=32==l.charCodeAt(e.length-1),n||r||i||c||o){if(y=n||"",r&&(y+=r),i&&(y+=i),b=Jt("span",[u],y,o),s)for(w in s)s.hasOwnProperty(w)&&"style"!=w&&"class"!=w&&b.setAttribute(w,s[w]);return t.content.appendChild(b)}t.content.appendChild(u)}}function Un(t,e){return function(n,r,i,o,s,l,a){var c,u,h,d;for(i=i?i+" cm-force-border":"cm-force-border",u=(c=n.pos)+r.length;;){for(h=void 0,d=0;e.length>d&&((h=e[d]).to<=c||h.from>c);d++);if(h.to>=u)return t(n,r,i,o,s,l,a);t(n,r.slice(0,h.to-c),i,o,null,l,a),o=null,r=r.slice(h.to-c),c=h.to}}}function jn(t,e,n,r){var i=!r&&n.widgetNode;i&&t.map.push(t.pos,t.pos+e,i),!r&&t.cm.display.input.needsContentAttribute&&(i||(i=t.content.appendChild(document.createElement("span"))),i.setAttribute("cm-marker",n.id)),i&&(t.cm.display.input.setUneditable(i),t.content.appendChild(i)),t.pos+=e,t.trailingSpace=!1}function Vn(t,e,n){var r,i,o,s,l,a,c,u,h,d,f,p,g,m,v,y,b,w,x,k,C,S,L,M,T=t.markedSpans,A=t.text,N=0;if(T)for(i=A.length,o=0,s=1,l="",u=0;;){if(u==o){for(h=d=f=c="",g=null,p=null,u=1/0,m=[],v=void 0,y=0;T.length>y;++y)if("bookmark"==(w=(b=T[y]).marker).type&&b.from==o&&w.widgetNode)m.push(w);else if(o>=b.from&&(null==b.to||b.to>o||w.collapsed&&b.to==o&&b.from==o)){if(null!=b.to&&b.to!=o&&u>b.to&&(u=b.to,d=""),w.className&&(h+=" "+w.className),w.css&&(c=(c?c+";":"")+w.css),w.startStyle&&b.from==o&&(f+=" "+w.startStyle),w.endStyle&&b.to==u&&(v||(v=[])).push(w.endStyle,b.to),w.title&&((g||(g={})).title=w.title),w.attributes)for(x in w.attributes)(g||(g={}))[x]=w.attributes[x];!w.collapsed||p&&Cn(p.marker,w)>=0||(p=b)}else b.from>o&&u>b.from&&(u=b.from);if(v)for(k=0;v.length>k;k+=2)v[k+1]==u&&(d+=" "+v[k]);if(!p||p.from==o)for(C=0;m.length>C;++C)jn(e,0,m[C]);if(p&&(p.from||0)==o){if(jn(e,(null==p.to?i+1:p.to)-o,p.marker,null==p.from),null==p.to)return;p.to==o&&(p=!1)}}if(o>=i)break;for(S=Math.min(i,u);;){if(l){if(L=o+l.length,p||(M=L>S?l.slice(0,S-o):l,e.addToken(e,M,a?a+h:h,f,o+M.length==u?d:"",c,g)),L>=S){l=l.slice(S-o),o=S;break}o=L,f=""}l=A.slice(N,N=n[s++]),a=Pn(n[s++],e.cm.options)}}else for(r=1;n.length>r;r+=2)e.addToken(e,A.slice(N,N=n[r]),Pn(n[r+1],e.cm.options))}function Gn(t,e,n){this.line=e,this.rest=function(t){for(var e,n;e=Mn(t);)t=e.find(1,!0).line,(n||(n=[])).push(t);return n}(e),this.size=this.rest?Ge(ce(this.rest))-n+1:1,this.node=this.text=null,this.hidden=Dn(t,e)}function $n(t,e,n){var r,i,o,s=[];for(i=e;n>i;i=r)o=new Gn(t.doc,Be(t.doc,i),i),r=i+o.size,s.push(o);return s}function Kn(t,e){var n,r,i,o,s=xe(t,e);if(s.length)for(n=Array.prototype.slice.call(arguments,2),F?r=F.delayedCallbacks:P?r=P:(r=P=[],setTimeout(Xn,0)),i=function(t){r.push(function(){return s[t].apply(null,n)})},o=0;s.length>o;++o)i(o)}function Xn(){var t,e=P;for(P=null,t=0;e.length>t;++t)e[t]()}function Yn(t,e,n,r){var i,o;for(i=0;e.changes.length>i;i++)"text"==(o=e.changes[i])?Zn(t,e):"gutter"==o?tr(t,e,n,r):"class"==o?Qn(t,e):"widget"==o&&er(t,e,r);e.changes=null}function qn(t){return t.node==t.text&&(t.node=Jt("div",null,null,"position: relative"),t.text.parentNode&&t.text.parentNode.replaceChild(t.node,t.text),t.node.appendChild(t.text),Dt&&8>Wt&&(t.node.style.zIndex=2)),t.node}function Jn(t,e){var n=t.display.externalMeasured;return n&&n.line==e.line?(t.display.externalMeasured=null,e.measure=n.measure,n.built):Rn(t,e)}function Zn(t,e){var n=e.text.className,r=Jn(t,e);e.text==e.node&&(e.node=r.pre),e.text.parentNode.replaceChild(r.pre,e.text),e.text=r.pre,r.bgClass!=e.bgClass||r.textClass!=e.textClass?(e.bgClass=r.bgClass,e.textClass=r.textClass,Qn(t,e)):n&&(e.text.className=n)}function Qn(t,e){!function(t,e){var n,r=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;r&&(r+=" CodeMirror-linebackground"),e.background?r?e.background.className=r:(e.background.parentNode.removeChild(e.background),e.background=null):r&&(n=qn(e),e.background=n.insertBefore(Jt("div",null,r),n.firstChild),t.display.input.setUneditable(e.background))}(t,e),e.line.wrapClass?qn(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var n=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=n||""}function tr(t,e,n,r){var i,o,s,l,a,c,u;if(e.gutter&&(e.node.removeChild(e.gutter),e.gutter=null),e.gutterBackground&&(e.node.removeChild(e.gutterBackground),e.gutterBackground=null),e.line.gutterClass&&(i=qn(e),e.gutterBackground=Jt("div",null,"CodeMirror-gutter-background "+e.line.gutterClass,"left: "+(t.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),t.display.input.setUneditable(e.gutterBackground),i.insertBefore(e.gutterBackground,e.text)),o=e.line.gutterMarkers,(t.options.lineNumbers||o)&&(s=qn(e),l=e.gutter=Jt("div",null,"CodeMirror-gutter-wrapper","left: "+(t.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px"),t.display.input.setUneditable(l),s.insertBefore(l,e.text),e.line.gutterClass&&(l.className+=" "+e.line.gutterClass),!t.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(e.lineNumber=l.appendChild(Jt("div",Xe(t.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+t.display.lineNumInnerWidth+"px"))),o))for(a=0;t.display.gutterSpecs.length>a;++a)(u=o.hasOwnProperty(c=t.display.gutterSpecs[a].className)&&o[c])&&l.appendChild(Jt("div",[u],"CodeMirror-gutter-elt","left: "+r.gutterLeft[c]+"px; width: "+r.gutterWidth[c]+"px"))}function er(t,e,n){e.alignable&&(e.alignable=null);for(var r=e.node.firstChild,i=void 0;r;r=i)i=r.nextSibling,"CodeMirror-linewidget"==r.className&&e.node.removeChild(r);rr(t,e,n)}function nr(t,e,n,r){var i=Jn(t,e);return e.text=e.node=i.pre,i.bgClass&&(e.bgClass=i.bgClass),i.textClass&&(e.textClass=i.textClass),Qn(t,e),tr(t,e,n,r),rr(t,e,r),e.node}function rr(t,e,n){if(ir(t,e.line,e,n,!0),e.rest)for(var r=0;e.rest.length>r;r++)ir(t,e.rest[r],e,n,!1)}function ir(t,e,n,r,i){var o,s,l,a,c;if(e.widgets)for(o=qn(n),s=0,l=e.widgets;l.length>s;++s)c=Jt("div",[(a=l[s]).node],"CodeMirror-linewidget"),a.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),or(a,c,n,r),t.display.input.setUneditable(c),i&&a.above?o.insertBefore(c,n.gutter||n.text):o.appendChild(c),Kn(a,"redraw")}function or(t,e,n,r){if(t.noHScroll){(n.alignable||(n.alignable=[])).push(e);var i=r.wrapperWidth;e.style.left=r.fixedPos+"px",t.coverGutter||(i-=r.gutterTotalWidth,e.style.paddingLeft=r.gutterTotalWidth+"px"),e.style.width=i+"px"}t.coverGutter&&(e.style.zIndex=5,e.style.position="relative",t.noHScroll||(e.style.marginLeft=-r.gutterTotalWidth+"px"))}function sr(t){var e,n;return null!=t.height?t.height:(e=t.doc.cm)?(Qt(document.body,t.node)||(n="position: relative;",t.coverGutter&&(n+="margin-left: -"+e.display.gutters.offsetWidth+"px;"),t.noHScroll&&(n+="width: "+e.display.wrapper.clientWidth+"px;"),qt(e.display.measure,Jt("div",[t.node],null,n))),t.height=t.node.parentNode.offsetHeight):0}function lr(t,e){for(var n=De(e);n!=t.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==t.sizer&&n!=t.mover)return!0}function ar(t){return t.lineSpace.offsetTop}function cr(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function ur(t){var e,n,r;return t.cachedPaddingH?t.cachedPaddingH:(e=qt(t.measure,Jt("pre","x","CodeMirror-line-like")),n=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,r={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)},isNaN(r.left)||isNaN(r.right)||(t.cachedPaddingH=r),r)}function hr(t){return s-t.display.nativeBarWidth}function dr(t){return t.display.scroller.clientWidth-hr(t)-t.display.barWidth}function fr(t){return t.display.scroller.clientHeight-hr(t)-t.display.barHeight}function pr(t,e,n){var r,i;if(t.line==e)return{map:t.measure.map,cache:t.measure.cache};for(r=0;t.rest.length>r;r++)if(t.rest[r]==e)return{map:t.measure.maps[r],cache:t.measure.caches[r]};for(i=0;t.rest.length>i;i++)if(Ge(t.rest[i])>n)return{map:t.measure.maps[i],cache:t.measure.caches[i],before:!0}}function gr(t,e,n,r){return yr(t,vr(t,e),n,r)}function mr(t,e){if(e>=t.display.viewFrom&&t.display.viewTo>e)return t.display.view[Gr(t,e)];var n=t.display.externalMeasured;return n&&e>=n.lineN&&n.lineN+n.size>e?n:void 0}function vr(t,e){var n,r=Ge(e),i=mr(t,r);return i&&!i.text?i=null:i&&i.changes&&(Yn(t,i,r,zr(t)),t.curOp.forceUpdate=!0),i||(i=function(t,e){var n,r=Ge(e=Nn(e)),i=t.display.externalMeasured=new Gn(t.doc,e,r);return i.lineN=r,n=i.built=Rn(t,i),i.text=n.pre,qt(t.display.lineMeasure,n.pre),i}(t,e)),n=pr(i,e,r),{line:e,view:i,rect:null,map:n.map,cache:n.cache,before:n.before,hasHeights:!1}}function yr(t,e,n,i,o){e.before&&(n=-1);var s,l=n+(i||"");return e.cache.hasOwnProperty(l)?s=e.cache[l]:(e.rect||(e.rect=e.view.text.getBoundingClientRect()),e.hasHeights||(function(t,e,n){var r,i,o,s,l,a=t.options.lineWrapping,c=a&&dr(t);if(!e.measure.heights||a&&e.measure.width!=c){if(r=e.measure.heights=[],a)for(e.measure.width=c,i=e.text.firstChild.getClientRects(),o=0;i.length-1>o;o++)s=i[o],l=i[o+1],Math.abs(s.bottom-l.bottom)>2&&r.push((s.bottom+l.top)/2-n.top);r.push(n.bottom-n.top)}}(t,e.view,e.rect),e.hasHeights=!0),(s=function(t,e,n,i){var o,s,l,a,c,u,h,d,f,p,g=br(e.map,n,i),m=g.node,v=g.start,y=g.end,b=g.collapse;if(3==m.nodeType){for(s=0;4>s;s++){for(;v&&me(e.line.text.charAt(g.coverStart+v));)--v;for(;g.coverEnd>g.coverStart+y&&me(e.line.text.charAt(g.coverStart+y));)++y;if((o=Dt&&9>Wt&&0==v&&y==g.coverEnd-g.coverStart?m.parentNode.getBoundingClientRect():wr(r(m,v,y).getClientRects(),i)).left||o.right||0==v)break;y=v,v-=1,b="right"}Dt&&11>Wt&&(o=function(t,e){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(t){if(null!=S)return S;var e=qt(t,Jt("span","x")),n=e.getBoundingClientRect(),i=r(e,0,1).getBoundingClientRect();return S=Math.abs(n.left-i.left)>1}(t))return e;var n=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI;return{left:e.left*n,right:e.right*n,top:e.top*i,bottom:e.bottom*i}}(t.display.measure,o))}else v>0&&(b=i="right"),o=t.options.lineWrapping&&(l=m.getClientRects()).length>1?l["right"==i?l.length-1:0]:m.getBoundingClientRect();for(!Dt||Wt>=9||v||o&&(o.left||o.right)||(a=m.parentNode.getClientRects()[0],o=a?{left:a.left,right:a.left+Rr(t.display),top:a.top,bottom:a.bottom}:R),h=((c=o.top-e.rect.top)+(u=o.bottom-e.rect.top))/2,d=e.view.measure.heights,f=0;d.length-1>f&&h>=d[f];f++);return p={left:("right"==b?o.right:o.left)-e.rect.left,right:("left"==b?o.left:o.right)-e.rect.left,top:f?d[f-1]:0,bottom:d[f]},o.left||o.right||(p.bogus=!0),t.options.singleCursorHeightPerLine||(p.rtop=c,p.rbottom=u),p}(t,e,n,i)).bogus||(e.cache[l]=s)),{left:s.left,right:s.right,top:o?s.rtop:s.top,bottom:o?s.rbottom:s.bottom}}function br(t,e,n){var r,i,o,s,l,a,c;for(c=0;t.length>c;c+=3)if(a=t[c+1],(l=t[c])>e?(i=0,o=1,s="left"):a>e?o=1+(i=e-l):(c==t.length-3||e==a&&t[c+3]>e)&&(i=(o=a-l)-1,a>e||(s="right")),null!=i){if(r=t[c+2],l==a&&n==(r.insertLeft?"left":"right")&&(s=n),"left"==n&&0==i)for(;c&&t[c-2]==t[c-3]&&t[c-1].insertLeft;)r=t[2+(c-=3)],s="left";if("right"==n&&i==a-l)for(;t.length-3>c&&t[c+3]==t[c+4]&&!t[c+5].insertLeft;)r=t[(c+=3)+2],s="right";break}return{node:r,start:i,end:o,collapse:s,coverStart:l,coverEnd:a}}function wr(t,e){var n,r,i=R;if("left"==e)for(n=0;t.length>n&&(i=t[n]).left==i.right;n++);else for(r=t.length-1;r>=0&&(i=t[r]).left==i.right;r--);return i}function xr(t){if(t.measure&&(t.measure.cache={},t.measure.heights=null,t.rest))for(var e=0;t.rest.length>e;e++)t.measure.caches[e]={}}function kr(t){t.display.externalMeasure=null,Yt(t.display.lineMeasure);for(var e=0;t.display.view.length>e;e++)xr(t.display.view[e])}function Cr(t){kr(t),t.display.cachedCharWidth=t.display.cachedTextHeight=t.display.cachedPaddingH=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function Sr(){return Ht&&Ut?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Lr(){return Ht&&Ut?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Mr(t){var e,n=0;if(t.widgets)for(e=0;t.widgets.length>e;++e)t.widgets[e].above&&(n+=sr(t.widgets[e]));return n}function Tr(t,e,n,r,i){var o,s,l,a;return i||(o=Mr(e),n.top+=o,n.bottom+=o),"line"==r?n:(r||(r="local"),s=En(e),"local"==r?s+=ar(t.display):s-=t.display.viewOffset,"page"!=r&&"window"!=r||(l=t.display.lineSpace.getBoundingClientRect(),s+=l.top+("window"==r?0:Lr()),a=l.left+("window"==r?0:Sr()),n.left+=a,n.right+=a),n.top+=s,n.bottom+=s,n)}function Ar(t,e,n){var r,i,o,s;return"div"==n?e:(r=e.left,i=e.top,"page"==n?(r-=Sr(),i-=Lr()):"local"!=n&&n||(o=t.display.sizer.getBoundingClientRect(),r+=o.left,i+=o.top),s=t.display.lineSpace.getBoundingClientRect(),{left:r-s.left,top:i-s.top})}function Nr(t,e,n,r,i){return r||(r=Be(t.doc,e.line)),Tr(t,r,gr(t,r,e.ch,i),n)}function Or(t,e,n,r,i,o){var s,l,a,c,u,h;function d(e,s){var l=yr(t,i,e,s?"right":"left",o);return s?l.left=l.right:l.right=l.left,Tr(t,r,l,n)}if(r=r||Be(t.doc,e.line),i||(i=vr(t,r)),s=we(r,t.doc.direction),a=e.sticky,r.text.length>(l=e.ch)?l>0||(l=0,a="after"):(l=r.text.length,a="before"),!s)return d("before"==a?l-1:l,"before"==a);function f(t,e,n){var r=s[e],i=1==r.level;return d(n?t-1:t,i!=n)}return c=be(s,l,a),u=p,h=f(l,c,"before"==a),null!=u&&(h.other=f(l,u,"before"!=a)),h}function _r(t,e){var n,r,i=0;return e=nn(t.doc,e),t.options.lineWrapping||(i=Rr(t.display)*e.ch),n=Be(t.doc,e.line),r=En(n)+ar(t.display),{left:i,right:i,top:r,bottom:r+n.height}}function Dr(t,e,n,r,i){var o=Ye(t,e,n);return o.xRel=i,r&&(o.outside=r),o}function Wr(t,e,n){var r,i,o,s,l,a,c=t.doc;if(0>(n+=t.display.viewOffset))return Dr(c.first,0,null,-1,-1);if((r=$e(c,n))>(i=c.first+c.size-1))return Dr(c.first+c.size-1,Be(c,i).text.length,null,1,1);for(0>e&&(e=0),o=Be(c,r);;){if(s=Fr(t,o,r,e,n),!(l=Tn(o,s.ch+(s.xRel>0||s.outside>0?1:0))))return s;if((a=l.find(1)).line==r)return a;o=Be(c,r=a.line)}}function Er(t,e,n,r){var i,o;return r-=Mr(e),o=ye(function(e){return yr(t,n,e-1).bottom<=r},i=e.text.length,0),i=ye(function(e){return yr(t,n,e).top>r},o,i),{begin:o,end:i}}function Ir(t,e,n,r){n||(n=vr(t,e));var i=Tr(t,e,yr(t,n,r),"line").top;return Er(t,e,n,i)}function Hr(t,e,n,r){return t.bottom>n&&(t.top>n||(r?t.left:t.right)>e)}function Fr(t,e,n,r,i){var o,s,l,a,c,u,h,d,f,p,g,m,v,y,b,w;return i-=En(e),o=vr(t,e),s=Mr(e),l=0,a=e.text.length,c=!0,(u=we(e,t.doc.direction))&&(h=(t.options.lineWrapping?function(t,e,n,r,i,o,s){var l,a,c,u,h,d,f=Er(t,e,r,s),p=f.begin,g=f.end;for(/\s/.test(e.text.charAt(g-1))&&g--,l=null,a=null,c=0;i.length>c;c++)g>(u=i[c]).from&&u.to>p&&(h=yr(t,r,1!=u.level?Math.min(g,u.to)-1:Math.max(p,u.from)).right,d=o>h?o-h+1e9:h-o,l&&d>=a||(l=u,a=d));return l||(l=i[i.length-1]),p>l.from&&(l={from:p,to:l.to,level:l.level}),l.to>g&&(l={from:l.from,to:g,level:l.level}),l}:function(t,e,n,r,i,o,s){var l,a,c=ye(function(l){var a=i[l],c=1!=a.level;return Hr(Or(t,Ye(n,c?a.to:a.from,c?"before":"after"),"line",e,r),o,s,!0)},0,i.length-1),u=i[c];return c>0&&Hr(a=Or(t,Ye(n,(l=1!=u.level)?u.from:u.to,l?"after":"before"),"line",e,r),o,s,!0)&&a.top>s&&(u=i[c-1]),u})(t,e,n,o,u,r,i),l=(c=1!=h.level)?h.from:h.to-1,a=c?h.to:h.from-1),d=null,f=null,p=ye(function(e){var n=yr(t,o,e);return n.top+=s,n.bottom+=s,!!Hr(n,r,i,!1)&&(n.top>i||n.left>r||(d=e,f=n),!0)},l,a),v=!1,f?(p=d+((b=(y=f.right-r>r-f.left)==c)?0:1),m=b?"after":"before",g=y?f.left:f.right):(c||p!=a&&p!=l||p++,m=0==p?"after":p==e.text.length?"before":yr(t,o,p-(c?1:0)).bottom+s<=i==c?"after":"before",w=Or(t,Ye(n,p,m),"line",e,o),g=w.left,v=w.top>i?-1:w.bottom>i?0:1),p=ve(e.text,p,1),Dr(n,p,m,v,r-g)}function Pr(t){var e,n;if(null!=t.cachedTextHeight)return t.cachedTextHeight;if(null==z){for(z=Jt("pre",null,"CodeMirror-line-like"),e=0;49>e;++e)z.appendChild(document.createTextNode("x")),z.appendChild(Jt("br"));z.appendChild(document.createTextNode("x"))}return qt(t.measure,z),(n=z.offsetHeight/50)>3&&(t.cachedTextHeight=n),Yt(t.measure),n||1}function Rr(t){var e,n,r,i;return null!=t.cachedCharWidth?t.cachedCharWidth:(e=Jt("span","xxxxxxxxxx"),n=Jt("pre",[e],"CodeMirror-line-like"),qt(t.measure,n),r=e.getBoundingClientRect(),(i=(r.right-r.left)/10)>2&&(t.cachedCharWidth=i),i||10)}function zr(t){var e,n,r,i=t.display,o={},s={},l=i.gutters.clientLeft;for(e=i.gutters.firstChild,n=0;e;e=e.nextSibling,++n)o[r=t.display.gutterSpecs[n].className]=e.offsetLeft+e.clientLeft+l,s[r]=e.clientWidth;return{fixedPos:Br(i),gutterTotalWidth:i.gutters.offsetWidth,gutterLeft:o,gutterWidth:s,wrapperWidth:i.wrapper.clientWidth}}function Br(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function Ur(t){var e=Pr(t.display),n=t.options.lineWrapping,r=n&&Math.max(5,t.display.scroller.clientWidth/Rr(t.display)-3);return function(i){var o,s;if(Dn(t.doc,i))return 0;if(o=0,i.widgets)for(s=0;i.widgets.length>s;s++)i.widgets[s].height&&(o+=i.widgets[s].height);return n?o+(Math.ceil(i.text.length/r)||1)*e:o+e}}function jr(t){var e=t.doc,n=Ur(t);e.iter(function(t){var e=n(t);e!=t.height&&Ve(t,e)})}function Vr(t,e,n,r){var i,o,s,l,a,c,u=t.display;if(!n&&"true"==De(e).getAttribute("cm-not-content"))return null;s=u.lineSpace.getBoundingClientRect();try{i=e.clientX-s.left,o=e.clientY-s.top}catch(e){return null}return l=Wr(t,i,o),r&&1==l.xRel&&(a=Be(t.doc,l.line).text).length==l.ch&&(c=oe(a,a.length,t.options.tabSize)-a.length,l=Ye(l.line,Math.max(0,Math.round((i-ur(t.display).left)/Rr(t.display))-c))),l}function Gr(t,e){var n,r;if(e>=t.display.viewTo)return null;if(0>(e-=t.display.viewFrom))return null;for(n=t.display.view,r=0;n.length>r;r++)if(0>(e-=n[r].size))return r}function $r(t,e,n,r){var i,o,s,l,a,c;null==e&&(e=t.doc.first),null==n&&(n=t.doc.first+t.doc.size),r||(r=0),i=t.display,r&&i.viewTo>n&&(null==i.updateLineNumbers||i.updateLineNumbers>e)&&(i.updateLineNumbers=e),t.curOp.viewChanged=!0,i.viewTo>e?n>i.viewFrom?e>i.viewFrom||i.viewTo>n?e>i.viewFrom?i.viewTo>n?(l=Yr(t,e,e,-1),a=Yr(t,n,n+r,1),l&&a?(i.view=i.view.slice(0,l.index).concat($n(t,l.lineN,a.lineN)).concat(i.view.slice(a.index)),i.viewTo+=r):Xr(t)):(s=Yr(t,e,e,-1))?(i.view=i.view.slice(0,s.index),i.viewTo=s.lineN):Xr(t):(o=Yr(t,n,n+r,1))?(i.view=i.view.slice(o.index),i.viewFrom=o.lineN,i.viewTo+=r):Xr(t):Xr(t):W&&_n(t.doc,n+r)>i.viewFrom?Xr(t):(i.viewFrom+=r,i.viewTo+=r):W&&On(t.doc,e)<i.viewTo&&Xr(t),(c=i.externalMeasured)&&(c.lineN>n?c.lineN+=r:c.lineN+c.size>e&&(i.externalMeasured=null))}function Kr(t,e,n){var r,i,o,s;t.curOp.viewChanged=!0,r=t.display,(i=t.display.externalMeasured)&&e>=i.lineN&&i.lineN+i.size>e&&(r.externalMeasured=null),e>=r.viewFrom&&r.viewTo>e&&null!=(o=r.view[Gr(t,e)]).node&&-1==se(s=o.changes||(o.changes=[]),n)&&s.push(n)}function Xr(t){t.display.viewFrom=t.display.viewTo=t.doc.first,t.display.view=[],t.display.viewOffset=0}function Yr(t,e,n,r){var i,o,s,l=Gr(t,e),a=t.display.view;if(!W||n==t.doc.first+t.doc.size)return{index:l,lineN:n};for(o=t.display.viewFrom,s=0;l>s;s++)o+=a[s].size;if(o!=e){if(r>0){if(l==a.length-1)return null;i=o+a[l].size-e,l++}else i=o-e;e+=i,n+=i}for(;On(t.doc,n)!=n;){if(l==(0>r?0:a.length-1))return null;n+=r*a[l-(0>r?1:0)].size,l+=r}return{index:l,lineN:n}}function qr(t){var e,n,r=t.display.view,i=0;for(e=0;r.length>e;e++)(n=r[e]).hidden||n.node&&!n.changes||++i;return i}function Jr(t){t.display.input.showSelection(t.display.input.prepareSelection())}function Zr(t,e){var n,r,i,o,s,l,a;for(void 0===e&&(e=!0),n=t.doc,i=(r={}).cursors=document.createDocumentFragment(),o=r.selection=document.createDocumentFragment(),s=0;n.sel.ranges.length>s;s++)(e||s!=n.sel.primIndex)&&(l=n.sel.ranges[s]).from().line<t.display.viewTo&&l.to().line>=t.display.viewFrom&&(((a=l.empty())||t.options.showCursorWhenSelecting)&&Qr(t,l.head,i),a||ei(t,l,o));return r}function Qr(t,e,n){var r,i=Or(t,e,"div",null,null,!t.options.singleCursorHeightPerLine),o=n.appendChild(Jt("div"," ","CodeMirror-cursor"));o.style.left=i.left+"px",o.style.top=i.top+"px",o.style.height=Math.max(0,i.bottom-i.top)*t.options.cursorHeight+"px",i.other&&((r=n.appendChild(Jt("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"))).style.display="",r.style.left=i.other.left+"px",r.style.top=i.other.top+"px",r.style.height=.85*(i.other.bottom-i.other.top)+"px")}function ti(t,e){return t.top-e.top||t.left-e.left}function ei(t,e,n){var r,i,o,s,l,a,c,u=t.display,h=t.doc,d=document.createDocumentFragment(),f=ur(t.display),p=f.left,g=Math.max(u.sizerWidth,dr(t)-u.sizer.offsetLeft)-f.right,m="ltr"==h.direction;function v(t,e,n,r){0>e&&(e=0),e=Math.round(e),r=Math.round(r),d.appendChild(Jt("div",null,"CodeMirror-selected","position: absolute; left: "+t+"px;\n                             top: "+e+"px; width: "+(null==n?g-t:n)+"px;\n                             height: "+(r-e)+"px"))}function y(e,n,r){var i,o,s,l=Be(h,e),a=l.text.length;function c(n,r){return Nr(t,Ye(e,n),"div",l,r)}function u(e,n,r){var i=Ir(t,l,null,e),o="ltr"==n==("after"==r)?"left":"right",s="after"==r?i.begin:i.end-(/\s/.test(l.text.charAt(i.end-1))?2:1);return c(s,o)[o]}return function(t,e,n,r){var i,o,s;if(!t)return r(e,n,"ltr",0);for(i=!1,o=0;t.length>o;++o)(n>(s=t[o]).from&&s.to>e||e==n&&s.to==e)&&(r(Math.max(s.from,e),Math.min(s.to,n),1==s.level?"rtl":"ltr",o),i=!0);i||r(e,n,"ltr")}(s=we(l,h.direction),n||0,null==r?a:r,function(t,e,l,h){var d,f,y,b,w,x="ltr"==l,k=c(t,x?"left":"right"),C=c(e-1,x?"right":"left"),S=null==n&&0==t,L=null==r&&e==a,M=0==h,T=!s||h==s.length-1;C.top-k.top>3?(x?(f=m&&S&&M?p:k.left,y=m?g:u(t,l,"before"),b=m?p:u(e,l,"after"),w=m&&L&&T?g:C.right):(f=m?u(t,l,"before"):p,y=!m&&S&&M?g:k.right,b=!m&&L&&T?p:C.left,w=m?u(e,l,"after"):g),v(f,k.top,y-f,k.bottom),C.top>k.bottom&&v(p,k.bottom,null,C.top),v(b,C.top,w-b,C.bottom)):v(d=(m?S:L)&&M?p:(x?k:C).left,k.top,((m?L:S)&&T?g:(x?C:k).right)-d,k.bottom),i&&ti(k,i)>=0||(i=k),0>ti(C,i)&&(i=C),o&&ti(k,o)>=0||(o=k),0>ti(C,o)&&(o=C)}),{start:i,end:o}}r=e.from(),i=e.to(),r.line==i.line?y(r.line,r.ch,i.ch):(o=Be(h,r.line),s=Be(h,i.line),l=Nn(o)==Nn(s),a=y(r.line,r.ch,l?o.text.length+1:null).end,c=y(i.line,l?0:null,i.ch).start,l&&(c.top-2>a.top?(v(a.right,a.top,null,a.bottom),v(p,c.top,c.left,c.bottom)):v(a.right,a.top,c.left-a.right,a.bottom)),c.top>a.bottom&&v(p,a.bottom,null,c.top)),n.appendChild(d)}function ni(t){var e,n;t.state.focused&&(e=t.display,clearInterval(e.blinker),n=!0,e.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?e.blinker=setInterval(function(){return e.cursorDiv.style.visibility=(n=!n)?"":"hidden"},t.options.cursorBlinkRate):0>t.options.cursorBlinkRate&&(e.cursorDiv.style.visibility="hidden"))}function ri(t){t.state.focused||(t.display.input.focus(),oi(t))}function ii(t){t.state.delayingBlurEvent=!0,setTimeout(function(){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1,si(t))},100)}function oi(t,e){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1),"nocursor"!=t.options.readOnly&&(t.state.focused||(Ce(t,"focus",t,e),t.state.focused=!0,ee(t.display.wrapper,"CodeMirror-focused"),t.curOp||t.display.selForContextMenu==t.doc.sel||(t.display.input.reset(),Et&&setTimeout(function(){return t.display.input.reset(!0)},20)),t.display.input.receivedFocus()),ni(t))}function si(t,e){t.state.delayingBlurEvent||(t.state.focused&&(Ce(t,"blur",t,e),t.state.focused=!1,n(t.display.wrapper,"CodeMirror-focused")),clearInterval(t.display.blinker),setTimeout(function(){t.state.focused||(t.display.shift=!1)},150))}function li(t){var e,n,r,i,o,s,l,a,c,u,h=t.display,d=h.lineDiv.offsetTop;for(e=0;h.view.length>e;e++)if(r=t.options.lineWrapping,i=void 0,o=0,!(n=h.view[e]).hidden){if(Dt&&8>Wt?(i=(s=n.node.offsetTop+n.node.offsetHeight)-d,d=s):(l=n.node.getBoundingClientRect(),i=l.bottom-l.top,!r&&n.text.firstChild&&(o=n.text.firstChild.getBoundingClientRect().right-l.left-1)),((a=n.line.height-i)>.005||-.005>a)&&(Ve(n.line,i),ai(n.line),n.rest))for(c=0;n.rest.length>c;c++)ai(n.rest[c]);o>t.display.sizerWidth&&(u=Math.ceil(o/Rr(t.display)))>t.display.maxLineLength&&(t.display.maxLineLength=u,t.display.maxLine=n.line,t.display.maxLineChanged=!0)}}function ai(t){var e,n,r;if(t.widgets)for(e=0;t.widgets.length>e;++e)(r=(n=t.widgets[e]).node.parentNode)&&(n.height=r.offsetHeight)}function ci(t,e,n){var r,i,o,s,l,a=n&&null!=n.top?Math.max(0,n.top):t.scroller.scrollTop;return a=Math.floor(a-ar(t)),r=n&&null!=n.bottom?n.bottom:a+t.wrapper.clientHeight,i=$e(e,a),o=$e(e,r),n&&n.ensure&&(l=n.ensure.to.line,i>(s=n.ensure.from.line)?(i=s,o=$e(e,En(Be(e,s))+t.wrapper.clientHeight)):Math.min(l,e.lastLine())<o||(i=$e(e,En(Be(e,l))-t.wrapper.clientHeight),o=l)),{from:i,to:Math.max(o,i+1)}}function ui(t,e){var n,r,i,o,s,l,a,c,u,h,d=t.display,f=Pr(t.display);return 0>e.top&&(e.top=0),n=t.curOp&&null!=t.curOp.scrollTop?t.curOp.scrollTop:d.scroller.scrollTop,r=fr(t),i={},e.bottom-e.top>r&&(e.bottom=e.top+r),o=t.doc.height+cr(d),s=f>e.top,l=e.bottom>o-f,n>e.top?i.scrollTop=s?0:e.top:e.bottom>n+r&&(a=Math.min(e.top,(l?o:e.bottom)-r))!=n&&(i.scrollTop=a),c=t.curOp&&null!=t.curOp.scrollLeft?t.curOp.scrollLeft:d.scroller.scrollLeft,u=dr(t)-(t.options.fixedGutter?d.gutters.offsetWidth:0),(h=e.right-e.left>u)&&(e.right=e.left+u),10>e.left?i.scrollLeft=0:c>e.left?i.scrollLeft=Math.max(0,e.left-(h?0:10)):e.right>u+c-3&&(i.scrollLeft=e.right+(h?0:10)-u),i}function hi(t,e){null!=e&&(pi(t),t.curOp.scrollTop=(null==t.curOp.scrollTop?t.doc.scrollTop:t.curOp.scrollTop)+e)}function di(t){pi(t);var e=t.getCursor();t.curOp.scrollToPos={from:e,to:e,margin:t.options.cursorScrollMargin}}function fi(t,e,n){null==e&&null==n||pi(t),null!=e&&(t.curOp.scrollLeft=e),null!=n&&(t.curOp.scrollTop=n)}function pi(t){var e,n,r=t.curOp.scrollToPos;r&&(t.curOp.scrollToPos=null,e=_r(t,r.from),n=_r(t,r.to),gi(t,e,n,r.margin))}function gi(t,e,n,r){var i=ui(t,{left:Math.min(e.left,n.left),top:Math.min(e.top,n.top)-r,right:Math.max(e.right,n.right),bottom:Math.max(e.bottom,n.bottom)+r});fi(t,i.scrollLeft,i.scrollTop)}function mi(t,e){2>Math.abs(t.doc.scrollTop-e)||(At||Fi(t,{top:e}),vi(t,e,!0),At&&Fi(t),Wi(t,100))}function vi(t,e,n){e=Math.min(t.display.scroller.scrollHeight-t.display.scroller.clientHeight,e),(t.display.scroller.scrollTop!=e||n)&&(t.doc.scrollTop=e,t.display.scrollbars.setScrollTop(e),t.display.scroller.scrollTop!=e&&(t.display.scroller.scrollTop=e))}function yi(t,e,n,r){e=Math.min(e,t.display.scroller.scrollWidth-t.display.scroller.clientWidth),(n?e==t.doc.scrollLeft:2>Math.abs(t.doc.scrollLeft-e))&&!r||(t.doc.scrollLeft=e,zi(t),t.display.scroller.scrollLeft!=e&&(t.display.scroller.scrollLeft=e),t.display.scrollbars.setScrollLeft(e))}function bi(t){var e=t.display,n=e.gutters.offsetWidth,r=Math.round(t.doc.height+cr(t.display));return{clientHeight:e.scroller.clientHeight,viewHeight:e.wrapper.clientHeight,scrollWidth:e.scroller.scrollWidth,clientWidth:e.scroller.clientWidth,viewWidth:e.wrapper.clientWidth,barLeft:t.options.fixedGutter?n:0,docHeight:r,scrollHeight:r+hr(t)+e.barHeight,nativeBarWidth:e.nativeBarWidth,gutterWidth:n}}function wi(t,e){var n,r,i;for(e||(e=bi(t)),n=t.display.barWidth,r=t.display.barHeight,xi(t,e),i=0;4>i&&n!=t.display.barWidth||r!=t.display.barHeight;i++)n!=t.display.barWidth&&t.options.lineWrapping&&li(t),xi(t,bi(t)),n=t.display.barWidth,r=t.display.barHeight}function xi(t,e){var n=t.display,r=n.scrollbars.update(e);n.sizer.style.paddingRight=(n.barWidth=r.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=r.bottom)+"px",n.heightForcer.style.borderBottom=r.bottom+"px solid transparent",r.right&&r.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=r.bottom+"px",n.scrollbarFiller.style.width=r.right+"px"):n.scrollbarFiller.style.display="",r.bottom&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=r.bottom+"px",n.gutterFiller.style.width=e.gutterWidth+"px"):n.gutterFiller.style.display=""}function ki(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&n(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new j[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),v(e,"mousedown",function(){t.state.focused&&setTimeout(function(){return t.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,n){"horizontal"==n?yi(t,e):mi(t,e)},t),t.display.scrollbars.addClass&&ee(t.display.wrapper,t.display.scrollbars.addClass)}function Ci(t){var e;t.curOp={cm:t,viewChanged:!1,startHeight:t.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++V},e=t.curOp,F?F.ops.push(e):e.ownsGroup=F={ops:[e],delayedCallbacks:[]}}function Si(t){var e=t.curOp;e&&function(t,e){var n=t.ownsGroup;if(n)try{!function(t){var e,n,r=t.delayedCallbacks,i=0;do{for(;r.length>i;i++)r[i].call(null);for(e=0;t.ops.length>e;e++)if((n=t.ops[e]).cursorActivityHandlers)for(;n.cursorActivityHandlers.length>n.cursorActivityCalled;)n.cursorActivityHandlers[n.cursorActivityCalled++].call(null,n.cm)}while(r.length>i)}(n)}finally{F=null,e(n)}}(e,function(t){for(var e=0;t.ops.length>e;e++)t.ops[e].cm.curOp=null;!function(t){var e,n,r,i,o,s,l;for(e=t.ops,n=0;e.length>n;n++)Li(e[n]);for(r=0;e.length>r;r++)(l=e[r]).updatedDisplay=l.mustUpdate&&Ii(l.cm,l.update);for(i=0;e.length>i;i++)Mi(e[i]);for(o=0;e.length>o;o++)Ti(e[o]);for(s=0;e.length>s;s++)Ai(e[s])}(t)})}function Li(t){var e=t.cm,n=e.display;!function(t){var e=t.display;!e.scrollbarsClipped&&e.scroller.offsetWidth&&(e.nativeBarWidth=e.scroller.offsetWidth-e.scroller.clientWidth,e.heightForcer.style.height=hr(t)+"px",e.sizer.style.marginBottom=-e.nativeBarWidth+"px",e.sizer.style.borderRightWidth=hr(t)+"px",e.scrollbarsClipped=!0)}(e),t.updateMaxLine&&Hn(e),t.mustUpdate=t.viewChanged||t.forceUpdate||null!=t.scrollTop||t.scrollToPos&&(n.viewFrom>t.scrollToPos.from.line||t.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&e.options.lineWrapping,t.update=t.mustUpdate&&new G(e,t.mustUpdate&&{top:t.scrollTop,ensure:t.scrollToPos},t.forceUpdate)}function Mi(t){var e=t.cm,n=e.display;t.updatedDisplay&&li(e),t.barMeasure=bi(e),n.maxLineChanged&&!e.options.lineWrapping&&(t.adjustWidthTo=gr(e,n.maxLine,n.maxLine.text.length).left+3,e.display.sizerWidth=t.adjustWidthTo,t.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+t.adjustWidthTo+hr(e)+e.display.barWidth),t.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+t.adjustWidthTo-dr(e))),(t.updatedDisplay||t.selectionChanged)&&(t.preparedSelection=n.input.prepareSelection())}function Ti(t){var e,n=t.cm;null!=t.adjustWidthTo&&(n.display.sizer.style.minWidth=t.adjustWidthTo+"px",n.doc.scrollLeft>t.maxScrollLeft&&yi(n,Math.min(n.display.scroller.scrollLeft,t.maxScrollLeft),!0),n.display.maxLineChanged=!1),e=t.focus&&t.focus==te(),t.preparedSelection&&n.display.input.showSelection(t.preparedSelection,e),(t.updatedDisplay||t.startHeight!=n.doc.height)&&wi(n,t.barMeasure),t.updatedDisplay&&Ri(n,t.barMeasure),t.selectionChanged&&ni(n),n.state.focused&&t.updateInput&&n.display.input.reset(t.typing),e&&ri(t.cm)}function Ai(t){var e,n,r,i,o,s=t.cm,l=s.display,a=s.doc;if(t.updatedDisplay&&Hi(s,t.update),null==l.wheelStartX||null==t.scrollTop&&null==t.scrollLeft&&!t.scrollToPos||(l.wheelStartX=l.wheelStartY=null),null!=t.scrollTop&&vi(s,t.scrollTop,t.forceScroll),null!=t.scrollLeft&&yi(s,t.scrollLeft,!0,!0),t.scrollToPos&&(e=function(t,e,n,r){var i,o,s,l,a,c,u,h;for(null==r&&(r=0),t.options.lineWrapping||e!=n||(e=e.ch?Ye(e.line,"before"==e.sticky?e.ch-1:e.ch,"after"):e,n="before"==e.sticky?Ye(e.line,e.ch+1,"before"):e),o=0;5>o&&(s=!1,l=Or(t,e),a=n&&n!=e?Or(t,n):l,i={left:Math.min(l.left,a.left),top:Math.min(l.top,a.top)-r,right:Math.max(l.left,a.left),bottom:Math.max(l.bottom,a.bottom)+r},c=ui(t,i),u=t.doc.scrollTop,h=t.doc.scrollLeft,null!=c.scrollTop&&(mi(t,c.scrollTop),Math.abs(t.doc.scrollTop-u)>1&&(s=!0)),null!=c.scrollLeft&&(yi(t,c.scrollLeft),Math.abs(t.doc.scrollLeft-h)>1&&(s=!0)),s);o++);return i}(s,nn(a,t.scrollToPos.from),nn(a,t.scrollToPos.to),t.scrollToPos.margin),function(t,e){var n,r,i,o;Se(t,"scrollCursorIntoView")||(r=(n=t.display).sizer.getBoundingClientRect(),i=null,0>e.top+r.top?i=!0:e.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null==i||zt||(o=Jt("div","​",null,"position: absolute;\n                         top: "+(e.top-n.viewOffset-ar(t.display))+"px;\n                         height: "+(e.bottom-e.top+hr(t)+n.barHeight)+"px;\n                         left: "+e.left+"px; width: "+Math.max(2,e.right-e.left)+"px;"),t.display.lineSpace.appendChild(o),o.scrollIntoView(i),t.display.lineSpace.removeChild(o)))}(s,e)),r=t.maybeUnhiddenMarkers,n=t.maybeHiddenMarkers)for(i=0;n.length>i;++i)n[i].lines.length||Ce(n[i],"hide");if(r)for(o=0;r.length>o;++o)r[o].lines.length&&Ce(r[o],"unhide");l.wrapper.offsetHeight&&(a.scrollTop=s.display.scroller.scrollTop),t.changeObjs&&Ce(s,"changes",s,t.changeObjs),t.update&&t.update.finish()}function Ni(t,e){if(t.curOp)return e();Ci(t);try{return e()}finally{Si(t)}}function Oi(t,e){return function(){if(t.curOp)return e.apply(t,arguments);Ci(t);try{return e.apply(t,arguments)}finally{Si(t)}}}function _i(t){return function(){if(this.curOp)return t.apply(this,arguments);Ci(this);try{return t.apply(this,arguments)}finally{Si(this)}}}function Di(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);Ci(e);try{return t.apply(this,arguments)}finally{Si(e)}}}function Wi(t,e){t.display.viewTo>t.doc.highlightFrontier&&t.state.highlight.set(e,re(Ei,t))}function Ei(t){var e,n,r,i=t.doc;t.display.viewTo>i.highlightFrontier&&(e=+new Date+t.options.workTime,n=ln(t,i.highlightFrontier),r=[],i.iter(n.line,Math.min(i.first+i.size,t.display.viewTo+500),function(o){var s,l,a,c,u,h,d;if(t.display.viewFrom>n.line)o.text.length>t.options.maxHighlightLength||an(t,o.text,n),o.stateAfter=n.line%5==0?n.save():null,n.nextLine();else{for(s=o.styles,l=o.text.length>t.options.maxHighlightLength?Pe(i.mode,n.state):null,a=on(t,o,n,!0),l&&(n.state=l),o.styles=a.styles,c=o.styleClasses,(u=a.classes)?o.styleClasses=u:c&&(o.styleClasses=null),h=!s||s.length!=o.styles.length||c!=u&&(!c||!u||c.bgClass!=u.bgClass||c.textClass!=u.textClass),d=0;!h&&s.length>d;++d)h=s[d]!=o.styles[d];h&&r.push(n.line),o.stateAfter=n.save(),n.nextLine()}if(+new Date>e)return Wi(t,t.options.workDelay),!0}),i.highlightFrontier=n.line,i.modeFrontier=Math.max(i.modeFrontier,n.line),r.length&&Ni(t,function(){for(var e=0;r.length>e;e++)Kr(t,r[e],"text")}))}function Ii(t,e){var n,r,i,o,s,l,a=t.display,c=t.doc;return e.editorIsHidden?(Xr(t),!1):!!(e.force||a.viewFrom>e.visible.from||e.visible.to>a.viewTo||null!=a.updateLineNumbers&&a.viewTo>a.updateLineNumbers||a.renderedView!=a.view||0!=qr(t))&&(Bi(t)&&(Xr(t),e.dims=zr(t)),n=c.first+c.size,r=Math.max(e.visible.from-t.options.viewportMargin,c.first),i=Math.min(n,e.visible.to+t.options.viewportMargin),r>a.viewFrom&&20>r-a.viewFrom&&(r=Math.max(c.first,a.viewFrom)),a.viewTo>i&&20>a.viewTo-i&&(i=Math.min(n,a.viewTo)),W&&(r=On(t.doc,r),i=_n(t.doc,i)),o=r!=a.viewFrom||i!=a.viewTo||a.lastWrapHeight!=e.wrapperHeight||a.lastWrapWidth!=e.wrapperWidth,function(t,e,n){var r=t.display;0!=r.view.length&&r.viewTo>e&&n>r.viewFrom?(r.viewFrom>e?r.view=$n(t,e,r.viewFrom).concat(r.view):e>r.viewFrom&&(r.view=r.view.slice(Gr(t,e))),r.viewFrom=e,n>r.viewTo?r.view=r.view.concat($n(t,r.viewTo,n)):r.viewTo>n&&(r.view=r.view.slice(0,Gr(t,n)))):(r.view=$n(t,e,n),r.viewFrom=e),r.viewTo=n}(t,r,i),a.viewOffset=En(Be(t.doc,a.viewFrom)),t.display.mover.style.top=a.viewOffset+"px",s=qr(t),!!(o||0!=s||e.force||a.renderedView!=a.view||null!=a.updateLineNumbers&&a.viewTo>a.updateLineNumbers)&&(l=function(t){var e,n,r;return t.hasFocus()?null:(e=te())&&Qt(t.display.lineDiv,e)?(n={activeElt:e},window.getSelection&&(r=window.getSelection()).anchorNode&&r.extend&&Qt(t.display.lineDiv,r.anchorNode)&&(n.anchorNode=r.anchorNode,n.anchorOffset=r.anchorOffset,n.focusNode=r.focusNode,n.focusOffset=r.focusOffset),n):null}(t),s>4&&(a.lineDiv.style.display="none"),function(t,e,n){var r,i,o,s,l,a,c=t.display,u=t.options.lineNumbers,h=c.lineDiv,d=h.firstChild;function f(e){var n=e.nextSibling;return Et&&Vt&&t.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),n}for(r=c.view,i=c.viewFrom,o=0;r.length>o;o++){if((s=r[o]).hidden);else if(s.node&&s.node.parentNode==h){for(;d!=s.node;)d=f(d);a=u&&null!=e&&i>=e&&s.lineNumber,s.changes&&(se(s.changes,"gutter")>-1&&(a=!1),Yn(t,s,i,n)),a&&(Yt(s.lineNumber),s.lineNumber.appendChild(document.createTextNode(Xe(t.options,i)))),d=s.node.nextSibling}else l=nr(t,s,i,n),h.insertBefore(l,d);i+=s.size}for(;d;)d=f(d)}(t,a.updateLineNumbers,e.dims),s>4&&(a.lineDiv.style.display=""),a.renderedView=a.view,function(t){if(t&&t.activeElt&&t.activeElt!=te()&&(t.activeElt.focus(),t.anchorNode&&Qt(document.body,t.anchorNode)&&Qt(document.body,t.focusNode))){var e=window.getSelection(),n=document.createRange();n.setEnd(t.anchorNode,t.anchorOffset),n.collapse(!1),e.removeAllRanges(),e.addRange(n),e.extend(t.focusNode,t.focusOffset)}}(l),Yt(a.cursorDiv),Yt(a.selectionDiv),a.gutters.style.height=a.sizer.style.minHeight=0,o&&(a.lastWrapHeight=e.wrapperHeight,a.lastWrapWidth=e.wrapperWidth,Wi(t,400)),a.updateLineNumbers=null,!0))}function Hi(t,e){var n,r,i=e.viewport;for(n=!0;(n&&t.options.lineWrapping&&e.oldDisplayWidth!=dr(t)||(i&&null!=i.top&&(i={top:Math.min(t.doc.height+cr(t.display)-fr(t),i.top)}),e.visible=ci(t.display,t.doc,i),t.display.viewFrom>e.visible.from||e.visible.to>t.display.viewTo))&&Ii(t,e);n=!1)li(t),r=bi(t),Jr(t),wi(t,r),Ri(t,r),e.force=!1;e.signal(t,"update",t),t.display.viewFrom==t.display.reportedViewFrom&&t.display.viewTo==t.display.reportedViewTo||(e.signal(t,"viewportChange",t,t.display.viewFrom,t.display.viewTo),t.display.reportedViewFrom=t.display.viewFrom,t.display.reportedViewTo=t.display.viewTo)}function Fi(t,e){var n,r=new G(t,e);Ii(t,r)&&(li(t),Hi(t,r),n=bi(t),Jr(t),wi(t,n),Ri(t,n),r.finish())}function Pi(t){var e=t.gutters.offsetWidth;t.sizer.style.marginLeft=e+"px"}function Ri(t,e){t.display.sizer.style.minHeight=e.docHeight+"px",t.display.heightForcer.style.top=e.docHeight+"px",t.display.gutters.style.height=e.docHeight+t.display.barHeight+hr(t)+"px"}function zi(t){var e,n,r,i,o,s,l=t.display,a=l.view;if(l.alignWidgets||l.gutters.firstChild&&t.options.fixedGutter){for(e=Br(l)-l.scroller.scrollLeft+t.doc.scrollLeft,n=l.gutters.offsetWidth,r=e+"px",i=0;a.length>i;i++)if(!a[i].hidden&&(t.options.fixedGutter&&(a[i].gutter&&(a[i].gutter.style.left=r),a[i].gutterBackground&&(a[i].gutterBackground.style.left=r)),o=a[i].alignable))for(s=0;o.length>s;s++)o[s].style.left=r;t.options.fixedGutter&&(l.gutters.style.left=e+n+"px")}}function Bi(t){var e,n,r,i,o,s;return!!t.options.lineNumbers&&(n=Xe(t.options,(e=t.doc).first+e.size-1)).length!=(r=t.display).lineNumChars&&(i=r.measure.appendChild(Jt("div",[Jt("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),s=i.offsetWidth-(o=i.firstChild.offsetWidth),r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(o,r.lineGutter.offsetWidth-s)+1,r.lineNumWidth=r.lineNumInnerWidth+s,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",Pi(t.display),!0)}function Ui(t,e){var n,r,i,o=[],s=!1;for(n=0;t.length>n;n++){if(i=null,"string"!=typeof(r=t[n])&&(i=r.style,r=r.className),"CodeMirror-linenumbers"==r){if(!e)continue;s=!0}o.push({className:r,style:i})}return e&&!s&&o.push({className:"CodeMirror-linenumbers",style:null}),o}function ji(t){var e,n,r,i,o,s=t.gutters,l=t.gutterSpecs;for(Yt(s),t.lineGutter=null,e=0;l.length>e;++e)i=(n=l[e]).style,o=s.appendChild(Jt("div",null,"CodeMirror-gutter "+(r=n.className))),i&&(o.style.cssText=i),"CodeMirror-linenumbers"==r&&(t.lineGutter=o,o.style.width=(t.lineNumWidth||1)+"px");s.style.display=l.length?"":"none",Pi(t)}function Vi(t){ji(t.display),$r(t),zi(t)}function Gi(t,e,n,r){var i,o=this;this.input=n,o.scrollbarFiller=Jt("div",null,"CodeMirror-scrollbar-filler"),o.scrollbarFiller.setAttribute("cm-not-content","true"),o.gutterFiller=Jt("div",null,"CodeMirror-gutter-filler"),o.gutterFiller.setAttribute("cm-not-content","true"),o.lineDiv=Zt("div",null,"CodeMirror-code"),o.selectionDiv=Jt("div",null,null,"position: relative; z-index: 1"),o.cursorDiv=Jt("div",null,"CodeMirror-cursors"),o.measure=Jt("div",null,"CodeMirror-measure"),o.lineMeasure=Jt("div",null,"CodeMirror-measure"),o.lineSpace=Zt("div",[o.measure,o.lineMeasure,o.selectionDiv,o.cursorDiv,o.lineDiv],null,"position: relative; outline: none"),i=Zt("div",[o.lineSpace],"CodeMirror-lines"),o.mover=Jt("div",[i],null,"position: relative"),o.sizer=Jt("div",[o.mover],"CodeMirror-sizer"),o.sizerWidth=null,o.heightForcer=Jt("div",null,null,"position: absolute; height: "+s+"px; width: 1px;"),o.gutters=Jt("div",null,"CodeMirror-gutters"),o.lineGutter=null,o.scroller=Jt("div",[o.sizer,o.heightForcer,o.gutters],"CodeMirror-scroll"),o.scroller.setAttribute("tabIndex","-1"),o.wrapper=Jt("div",[o.scrollbarFiller,o.gutterFiller,o.scroller],"CodeMirror"),Dt&&8>Wt&&(o.gutters.style.zIndex=-1,o.scroller.style.paddingRight=0),Et||At&&jt||(o.scroller.draggable=!0),t&&(t.appendChild?t.appendChild(o.wrapper):t(o.wrapper)),o.viewFrom=o.viewTo=e.first,o.reportedViewFrom=o.reportedViewTo=e.first,o.view=[],o.renderedView=null,o.externalMeasured=null,o.viewOffset=0,o.lastWrapHeight=o.lastWrapWidth=0,o.updateLineNumbers=null,o.nativeBarWidth=o.barHeight=o.barWidth=0,o.scrollbarsClipped=!1,o.lineNumWidth=o.lineNumInnerWidth=o.lineNumChars=null,o.alignWidgets=!1,o.cachedCharWidth=o.cachedTextHeight=o.cachedPaddingH=null,o.maxLine=null,o.maxLineLength=0,o.maxLineChanged=!1,o.wheelDX=o.wheelDY=o.wheelStartX=o.wheelStartY=null,o.shift=!1,o.selForContextMenu=null,o.activeTouch=null,o.gutterSpecs=Ui(r.gutters,r.lineNumbers),ji(o),n.init(o)}function $i(t){var e=t.wheelDeltaX,n=t.wheelDeltaY;return null==e&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(e=t.detail),null==n&&t.detail&&t.axis==t.VERTICAL_AXIS?n=t.detail:null==n&&(n=t.wheelDelta),{x:e,y:n}}function Ki(t){var e=$i(t);return e.x*=K,e.y*=K,e}function Xi(t,e){var n,r,i,o,s,l,a=$i(e),c=a.x,u=a.y,h=t.display,d=h.scroller,f=d.scrollWidth>d.clientWidth,p=d.scrollHeight>d.clientHeight;if(c&&f||u&&p){if(u&&Vt&&Et)t:for(n=e.target,r=h.view;n!=d;n=n.parentNode)for(i=0;r.length>i;i++)if(r[i].node==n){t.display.currentWheelTarget=n;break t}if(c&&!At&&!Ft&&null!=K)return u&&p&&mi(t,Math.max(0,d.scrollTop+u*K)),yi(t,Math.max(0,d.scrollLeft+c*K)),(!u||u&&p)&&Ae(e),void(h.wheelStartX=null);u&&null!=K&&(l=(s=t.doc.scrollTop)+h.wrapper.clientHeight,0>(o=u*K)?s=Math.max(0,s+o-50):l=Math.min(t.doc.height,l+o+50),Fi(t,{top:s,bottom:l})),20>$&&(null==h.wheelStartX?(h.wheelStartX=d.scrollLeft,h.wheelStartY=d.scrollTop,h.wheelDX=c,h.wheelDY=u,setTimeout(function(){var t,e,n;null!=h.wheelStartX&&(t=d.scrollLeft-h.wheelStartX,n=(e=d.scrollTop-h.wheelStartY)&&h.wheelDY&&e/h.wheelDY||t&&h.wheelDX&&t/h.wheelDX,h.wheelStartX=h.wheelStartY=null,n&&(K=(K*$+n)/($+1),++$))},200)):(h.wheelDX+=c,h.wheelDY+=u))}}function Yi(t,e,n){var r,i,o,s,l,a,c,u=t&&t.options.selectionsMayTouch,h=e[n];for(e.sort(function(t,e){return qe(t.from(),e.from())}),n=se(e,h),r=1;e.length>r;r++)i=e[r],s=qe((o=e[r-1]).to(),i.from()),(u&&!i.empty()?s>0:s>=0)&&(l=tn(o.from(),i.from()),a=Qe(o.to(),i.to()),c=o.empty()?i.from()==i.head:o.from()==o.head,r>n||--n,e.splice(--r,2,new Y(c?a:l,c?l:a)));return new X(e,n)}function qi(t,e){return new X([new Y(t,e||t)],0)}function Ji(t){return t.text?Ye(t.from.line+t.text.length-1,ce(t.text).length+(1==t.text.length?t.from.ch:0)):t.to}function Zi(t,e){if(0>qe(t,e.from))return t;if(0>=qe(t,e.to))return Ji(e);var n=t.line+e.text.length-(e.to.line-e.from.line)-1,r=t.ch;return t.line==e.to.line&&(r+=Ji(e).ch-e.to.ch),Ye(n,r)}function Qi(t,e){var n,r,i=[];for(n=0;t.sel.ranges.length>n;n++)i.push(new Y(Zi((r=t.sel.ranges[n]).anchor,e),Zi(r.head,e)));return Yi(t.cm,i,t.sel.primIndex)}function to(t,e,n){return t.line==e.line?Ye(n.line,t.ch-e.ch+n.ch):Ye(n.line+(t.line-e.line),t.ch)}function eo(t){t.doc.mode=He(t.options,t.doc.modeOption),no(t)}function no(t){t.doc.iter(function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)}),t.doc.modeFrontier=t.doc.highlightFrontier=t.doc.first,Wi(t,100),t.state.modeGen++,t.curOp&&$r(t)}function ro(t,e){return 0==e.from.ch&&0==e.to.ch&&""==ce(e.text)&&(!t.cm||t.cm.options.wholeLineUpdateBefore)}function io(t,e,n,r){var i,o,s,l,a,c,u,h,d,f,p;function g(t){return n?n[t]:null}function m(t,n,i){!function(t,e,n,r){t.text=e,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),null!=t.order&&(t.order=null),bn(t),wn(t,n);var i=r?r(t):1;i!=t.height&&Ve(t,i)}(t,n,i,r),Kn(t,"change",t,e)}function v(t,e){var n,i=[];for(n=t;e>n;++n)i.push(new E(s[n],g(n),r));return i}o=e.to,s=e.text,l=Be(t,(i=e.from).line),a=Be(t,o.line),c=ce(s),u=g(s.length-1),h=o.line-i.line,e.full?(t.insert(0,v(0,s.length)),t.remove(s.length,t.size-s.length)):ro(t,e)?(d=v(0,s.length-1),m(a,a.text,u),h&&t.remove(i.line,h),d.length&&t.insert(i.line,d)):l==a?1==s.length?m(l,l.text.slice(0,i.ch)+c+l.text.slice(o.ch),u):((f=v(1,s.length-1)).push(new E(c+l.text.slice(o.ch),u,r)),m(l,l.text.slice(0,i.ch)+s[0],g(0)),t.insert(i.line+1,f)):1==s.length?(m(l,l.text.slice(0,i.ch)+s[0]+a.text.slice(o.ch),g(0)),t.remove(i.line+1,h)):(m(l,l.text.slice(0,i.ch)+s[0],g(0)),m(a,c+a.text.slice(o.ch),u),p=v(1,s.length-1),h>1&&t.remove(i.line+1,h-1),t.insert(i.line+1,p)),Kn(t,"change",t,e)}function oo(t,e,n){!function t(r,i,o){var s,l,a;if(r.linked)for(s=0;r.linked.length>s;++s)(l=r.linked[s]).doc!=i&&(a=o&&l.sharedHist,n&&!a||(e(l.doc,a),t(l.doc,r,a)))}(t,null,!0)}function so(t,e){if(e.cm)throw new Error("This document is already in use.");t.doc=e,e.cm=t,jr(t),eo(t),lo(t),t.options.lineWrapping||Hn(t),t.options.mode=e.modeOption,$r(t)}function lo(t){("rtl"==t.doc.direction?ee:n)(t.display.lineDiv,"CodeMirror-rtl")}function ao(t){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t||1}function co(t,e){var n={from:Ze(e.from),to:Ji(e),text:Ue(t,e.from,e.to)};return go(t,n,e.from.line,e.to.line+1),oo(t,function(t){return go(t,n,e.from.line,e.to.line+1)},!0),n}function uo(t){for(;t.length;){var e=ce(t);if(!e.ranges)break;t.pop()}}function ho(t,e,n,r){var i,o,s,l,a=t.history;if(a.undone.length=0,i=+new Date,(a.lastOp==r||a.lastOrigin==e.origin&&e.origin&&("+"==e.origin.charAt(0)&&a.lastModTime>i-(t.cm?t.cm.options.historyEventDelay:500)||"*"==e.origin.charAt(0)))&&(o=function(t,e){return e?(uo(t.done),ce(t.done)):t.done.length&&!ce(t.done).ranges?ce(t.done):t.done.length>1&&!t.done[t.done.length-2].ranges?(t.done.pop(),ce(t.done)):void 0}(a,a.lastOp==r)))s=ce(o.changes),0==qe(e.from,e.to)&&0==qe(e.from,s.to)?s.to=Ji(e):o.changes.push(co(t,e));else for((l=ce(a.done))&&l.ranges||po(t.sel,a.done),o={changes:[co(t,e)],generation:a.generation},a.done.push(o);a.done.length>a.undoDepth;)a.done.shift(),a.done[0].ranges||a.done.shift();a.done.push(n),a.generation=++a.maxGeneration,a.lastModTime=a.lastSelTime=i,a.lastOp=a.lastSelOp=r,a.lastOrigin=a.lastSelOrigin=e.origin,s||Ce(t,"historyAdded")}function fo(t,e,n,r){var i=t.history,o=r&&r.origin;n==i.lastSelOp||o&&i.lastSelOrigin==o&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==o||function(t,e,n,r){var i=e.charAt(0);return"*"==i||"+"==i&&n.ranges.length==r.ranges.length&&n.somethingSelected()==r.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}(t,o,ce(i.done),e))?i.done[i.done.length-1]=e:po(e,i.done),i.lastSelTime=+new Date,i.lastSelOrigin=o,i.lastSelOp=n,r&&!1!==r.clearRedo&&uo(i.undone)}function po(t,e){var n=ce(e);n&&n.ranges&&n.equals(t)||e.push(t)}function go(t,e,n,r){var i=e["spans_"+t.id],o=0;t.iter(Math.max(t.first,n),Math.min(t.first+t.size,r),function(n){n.markedSpans&&((i||(i=e["spans_"+t.id]={}))[o]=n.markedSpans),++o})}function mo(t){var e,n;if(!t)return null;for(n=0;t.length>n;++n)t[n].marker.explicitlyCleared?e||(e=t.slice(0,n)):e&&e.push(t[n]);return e?e.length?e:null:t}function vo(t,e){var n,r,i,o,s,l,a=function(t,e){var n,r,i=e["spans_"+t.id];if(!i)return null;for(n=[],r=0;e.text.length>r;++r)n.push(mo(i[r]));return n}(t,e),c=vn(t,e);if(!a)return c;if(!c)return a;for(n=0;a.length>n;++n)if(i=c[n],(r=a[n])&&i)t:for(o=0;i.length>o;++o){for(s=i[o],l=0;r.length>l;++l)if(r[l].marker==s.marker)continue t;r.push(s)}else i&&(a[n]=i);return a}function yo(t,e,n){var r,i,o,s,l,a,c,u,h=[];for(r=0;t.length>r;++r)if((i=t[r]).ranges)h.push(n?X.prototype.deepCopy.call(i):i);else for(o=i.changes,h.push({changes:s=[]}),l=0;o.length>l;++l)if(c=void 0,s.push({from:(a=o[l]).from,to:a.to,text:a.text}),e)for(u in a)(c=u.match(/^spans_(\d+)$/))&&se(e,Number(c[1]))>-1&&(ce(s)[u]=a[u],delete a[u]);return h}function bo(t,e,n,r){var i,o;return r?(i=t.anchor,n&&((o=0>qe(e,i))!=0>qe(n,i)?(i=e,e=n):o!=0>qe(e,n)&&(e=n)),new Y(i,e)):new Y(n||e,e)}function wo(t,e,n,r,i){null==i&&(i=t.cm&&(t.cm.display.shift||t.extend)),Lo(t,new X([bo(t.sel.primary(),e,n,i)],0),r)}function xo(t,e,n){var r,i,o=[],s=t.cm&&(t.cm.display.shift||t.extend);for(r=0;t.sel.ranges.length>r;r++)o[r]=bo(t.sel.ranges[r],e[r],null,s);i=Yi(t.cm,o,t.sel.primIndex),Lo(t,i,n)}function ko(t,e,n,r){var i=t.sel.ranges.slice(0);i[e]=n,Lo(t,Yi(t.cm,i,t.sel.primIndex),r)}function Co(t,e,n,r){Lo(t,qi(e,n),r)}function So(t,e,n){var r=t.history.done,i=ce(r);i&&i.ranges?(r[r.length-1]=e,Mo(t,e,n)):Lo(t,e,n)}function Lo(t,e,n){Mo(t,e,n),fo(t,t.sel,t.cm?t.cm.curOp.id:NaN,n)}function Mo(t,e,n){(Me(t,"beforeSelectionChange")||t.cm&&Me(t.cm,"beforeSelectionChange"))&&(e=function(t,e,n){var r={ranges:e.ranges,update:function(e){var n,r=this;for(this.ranges=[],n=0;e.length>n;n++)r.ranges[n]=new Y(nn(t,e[n].anchor),nn(t,e[n].head))},origin:n&&n.origin};return Ce(t,"beforeSelectionChange",t,r),t.cm&&Ce(t.cm,"beforeSelectionChange",t.cm,r),r.ranges!=e.ranges?Yi(t.cm,r.ranges,r.ranges.length-1):e}(t,e,n));var r=n&&n.bias||(0>qe(e.primary().head,t.sel.primary().head)?-1:1);To(t,No(t,e,r,!0)),n&&!1===n.scroll||!t.cm||di(t.cm)}function To(t,e){e.equals(t.sel)||(t.sel=e,t.cm&&(t.cm.curOp.updateInput=1,t.cm.curOp.selectionChanged=!0,Le(t.cm)),Kn(t,"cursorActivity",t))}function Ao(t){To(t,No(t,t.sel,null,!1))}function No(t,e,n,r){var i,o,s,l,a,c;for(o=0;e.ranges.length>o;o++)a=_o(t,(s=e.ranges[o]).anchor,(l=e.ranges.length==t.sel.ranges.length&&t.sel.ranges[o])&&l.anchor,n,r),c=_o(t,s.head,l&&l.head,n,r),(i||a!=s.anchor||c!=s.head)&&(i||(i=e.ranges.slice(0,o)),i[o]=new Y(a,c));return i?Yi(t.cm,i,e.primIndex):e}function Oo(t,e,n,r,i){var o,s,l,a,c,u,h,d,f=Be(t,e.line);if(f.markedSpans)for(o=0;f.markedSpans.length>o;++o)if(a="selectLeft"in(l=(s=f.markedSpans[o]).marker)?!l.selectLeft:l.inclusiveLeft,c="selectRight"in l?!l.selectRight:l.inclusiveRight,!(null!=s.from&&(a?s.from>e.ch:s.from>=e.ch)||null!=s.to&&(c?e.ch>s.to:e.ch>=s.to))){if(i&&(Ce(l,"beforeCursorEnter"),l.explicitlyCleared)){if(f.markedSpans){--o;continue}break}if(!l.atomic)continue;return n&&(u=l.find(0>r?1:-1),h=void 0,(0>r?c:a)&&(u=Do(t,u,-r,u&&u.line==e.line?f:null)),u&&u.line==e.line&&(h=qe(u,n))&&(0>r?0>h:h>0))?Oo(t,u,e,r,i):(d=l.find(0>r?-1:1),(0>r?a:c)&&(d=Do(t,d,r,d.line==e.line?f:null)),d?Oo(t,d,e,r,i):null)}return e}function _o(t,e,n,r,i){var o=r||1,s=Oo(t,e,n,o,i)||!i&&Oo(t,e,n,o,!0)||Oo(t,e,n,-o,i)||!i&&Oo(t,e,n,-o,!0);return s||(t.cantEdit=!0,Ye(t.first,0))}function Do(t,e,n,r){return 0>n&&0==e.ch?e.line>t.first?nn(t,Ye(e.line-1)):null:n>0&&e.ch==(r||Be(t,e.line)).text.length?t.first+t.size-1>e.line?Ye(e.line+1,0):null:new Ye(e.line,e.ch+n)}function Wo(t){t.setSelection(Ye(t.firstLine(),0),Ye(t.lastLine()),a)}function Eo(t,e,n){var r={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return r.canceled=!0}};return n&&(r.update=function(e,n,i,o){e&&(r.from=nn(t,e)),n&&(r.to=nn(t,n)),i&&(r.text=i),void 0!==o&&(r.origin=o)}),Ce(t,"beforeChange",t,r),t.cm&&Ce(t.cm,"beforeChange",t.cm,r),r.canceled?(t.cm&&(t.cm.curOp.updateInput=2),null):{from:r.from,to:r.to,text:r.text,origin:r.origin}}function Io(t,e,n){var r,i;if(t.cm){if(!t.cm.curOp)return Oi(t.cm,Io)(t,e,n);if(t.cm.state.suppressEdits)return}if(!(Me(t,"beforeChange")||t.cm&&Me(t.cm,"beforeChange"))||(e=Eo(t,e,!0)))if(r=D&&!n&&function(t,e,n){var r,i,o,s,l,a,c,u,h,d=null;if(t.iter(e.line,n.line+1,function(t){var e,n;if(t.markedSpans)for(e=0;t.markedSpans.length>e;++e)!(n=t.markedSpans[e].marker).readOnly||d&&-1!=se(d,n)||(d||(d=[])).push(n)}),!d)return null;for(r=[{from:e,to:n}],i=0;d.length>i;++i)for(s=(o=d[i]).find(0),l=0;r.length>l;++l)0>qe((a=r[l]).to,s.from)||qe(a.from,s.to)>0||(c=[l,1],u=qe(a.from,s.from),h=qe(a.to,s.to),(0>u||!o.inclusiveLeft&&!u)&&c.push({from:a.from,to:s.from}),(h>0||!o.inclusiveRight&&!h)&&c.push({from:s.to,to:a.to}),r.splice.apply(r,c),l+=c.length-3);return r}(t,e.from,e.to))for(i=r.length-1;i>=0;--i)Ho(t,{from:r[i].from,to:r[i].to,text:i?[""]:e.text,origin:e.origin});else Ho(t,e)}function Ho(t,e){var n,r;1==e.text.length&&""==e.text[0]&&0==qe(e.from,e.to)||(n=Qi(t,e),ho(t,e,n,t.cm?t.cm.curOp.id:NaN),Ro(t,e,n,vn(t,e)),r=[],oo(t,function(t,n){n||-1!=se(r,t.history)||(jo(t.history,e),r.push(t.history)),Ro(t,e,null,vn(t,e))}))}function Fo(t,e,n){var r,i,o,s,l,a,c,u,h,d,f,p=t.cm&&t.cm.state.suppressEdits;if(!p||n){for(r=t.history,o=t.sel,s="undo"==e?r.done:r.undone,l="undo"==e?r.undone:r.done,a=0;s.length>a&&(i=s[a],n?!i.ranges||i.equals(t.sel):i.ranges);a++);if(a!=s.length){for(r.lastOrigin=r.lastSelOrigin=null;;){if(!(i=s.pop()).ranges){if(p)return void s.push(i);break}if(po(i,l),n&&!i.equals(t.sel))return void Lo(t,i,{clearRedo:!1});o=i}for(c=[],po(o,l),l.push({changes:c,generation:r.generation}),r.generation=i.generation||++r.maxGeneration,u=Me(t,"beforeChange")||t.cm&&Me(t.cm,"beforeChange"),h=function(n){var r,o,l=i.changes[n];if(l.origin=e,u&&!Eo(t,l,!1))return s.length=0,{};c.push(co(t,l)),r=n?Qi(t,l):ce(s),Ro(t,l,r,vo(t,l)),!n&&t.cm&&t.cm.scrollIntoView({from:l.from,to:Ji(l)}),o=[],oo(t,function(t,e){e||-1!=se(o,t.history)||(jo(t.history,l),o.push(t.history)),Ro(t,l,null,vo(t,l))})},d=i.changes.length-1;d>=0;--d)if(f=h(d))return f.v}}}function Po(t,e){if(0!=e&&(t.first+=e,t.sel=new X(ue(t.sel.ranges,function(t){return new Y(Ye(t.anchor.line+e,t.anchor.ch),Ye(t.head.line+e,t.head.ch))}),t.sel.primIndex),t.cm)){$r(t.cm,t.first,t.first-e,e);for(var n=t.cm.display,r=n.viewFrom;n.viewTo>r;r++)Kr(t.cm,r,"gutter")}}function Ro(t,e,n,r){var i,o;if(t.cm&&!t.cm.curOp)return Oi(t.cm,Ro)(t,e,n,r);t.first>e.to.line?Po(t,e.text.length-1-(e.to.line-e.from.line)):e.from.line>t.lastLine()||(t.first>e.from.line&&(Po(t,i=e.text.length-1-(t.first-e.from.line)),e={from:Ye(t.first,0),to:Ye(e.to.line+i,e.to.ch),text:[ce(e.text)],origin:e.origin}),o=t.lastLine(),e.to.line>o&&(e={from:e.from,to:Ye(o,Be(t,o).text.length),text:[e.text[0]],origin:e.origin}),e.removed=Ue(t,e.from,e.to),n||(n=Qi(t,e)),t.cm?function(t,e,n){var r,i,o,s,l=t.doc,a=t.display,c=e.from,u=e.to,h=!1,d=c.line;t.options.lineWrapping||(d=Ge(Nn(Be(l,c.line))),l.iter(d,u.line+1,function(t){if(t==a.maxLine)return h=!0,!0})),l.sel.contains(e.from,e.to)>-1&&Le(t),io(l,e,n,Ur(t)),t.options.lineWrapping||(l.iter(d,c.line+e.text.length,function(t){var e=In(t);e>a.maxLineLength&&(a.maxLine=t,a.maxLineLength=e,a.maxLineChanged=!0,h=!1)}),h&&(t.curOp.updateMaxLine=!0)),function(t,e){var n,r,i;if(t.modeFrontier=Math.min(t.modeFrontier,e),t.highlightFrontier>=e-10){for(n=t.first,r=e-1;r>n;r--)if((i=Be(t,r).stateAfter)&&(!(i instanceof N)||e>r+i.lookAhead)){n=r+1;break}t.highlightFrontier=Math.min(t.highlightFrontier,n)}}(l,c.line),Wi(t,400),r=e.text.length-(u.line-c.line)-1,e.full?$r(t):c.line!=u.line||1!=e.text.length||ro(t.doc,e)?$r(t,c.line,u.line+1,r):Kr(t,c.line,"text"),i=Me(t,"changes"),((o=Me(t,"change"))||i)&&(s={from:c,to:u,text:e.text,removed:e.removed,origin:e.origin},o&&Kn(t,"change",t,s),i&&(t.curOp.changeObjs||(t.curOp.changeObjs=[])).push(s)),t.display.selForContextMenu=null}(t.cm,e,r):io(t,e,r),Mo(t,n,a),t.cantEdit&&_o(t,Ye(t.firstLine(),0))&&(t.cantEdit=!1))}function zo(t,e,n,r,i){var o;r||(r=n),0>qe(r,n)&&(n=(o=[r,n])[0],r=o[1]),"string"==typeof e&&(e=t.splitLines(e)),Io(t,{from:n,to:r,text:e,origin:i})}function Bo(t,e,n,r){t.line>n?t.line+=r:t.line>e&&(t.line=e,t.ch=0)}function Uo(t,e,n,r){var i,o,s,l,a,c;for(i=0;t.length>i;++i)if(s=!0,(o=t[i]).ranges)for(o.copied||((o=t[i]=o.deepCopy()).copied=!0),l=0;o.ranges.length>l;l++)Bo(o.ranges[l].anchor,e,n,r),Bo(o.ranges[l].head,e,n,r);else{for(a=0;o.changes.length>a;++a)if((c=o.changes[a]).from.line>n)c.from=Ye(c.from.line+r,c.from.ch),c.to=Ye(c.to.line+r,c.to.ch);else if(c.to.line>=e){s=!1;break}s||(t.splice(0,i+1),i=0)}}function jo(t,e){var n=e.from.line,r=e.to.line,i=e.text.length-(r-n)-1;Uo(t.done,n,r,i),Uo(t.undone,n,r,i)}function Vo(t,e,n,r){var i=e,o=e;return"number"==typeof e?o=Be(t,en(t,e)):i=Ge(e),null==i?null:(r(o,i)&&t.cm&&Kr(t.cm,i,n),o)}function Go(t){var e,n,r=this;for(this.lines=t,this.parent=null,e=0,n=0;t.length>n;++n)t[n].parent=r,e+=t[n].height;this.height=e}function $o(t){var e,n,r,i,o=this;for(this.children=t,e=0,n=0,r=0;t.length>r;++r)e+=(i=t[r]).chunkSize(),n+=i.height,i.parent=o;this.size=e,this.height=n,this.parent=null}function Ko(t,e,n){En(e)<(t.curOp&&t.curOp.scrollTop||t.doc.scrollTop)&&hi(t,n)}function Xo(t,e,n,r,i){var o,s,l,a,c,u;if(r&&r.shared)return function(t,e,n,r,i){(r=ie(r)).shared=!1;var o=[Xo(t,e,n,r,i)],s=o[0],l=r.widgetNode;return oo(t,function(t){l&&(r.widgetNode=l.cloneNode(!0)),o.push(Xo(t,nn(t,e),nn(t,n),r,i));for(var a=0;t.linked.length>a;++a)if(t.linked[a].isParent)return;s=ce(o)}),new Q(o,s)}(t,e,n,r,i);if(t.cm&&!t.cm.curOp)return Oi(t.cm,Xo)(t,e,n,r,i);if(o=new Z(t,i),s=qe(e,n),r&&ie(r,o,!1),s>0||0==s&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=Zt("span",[o.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),r.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(An(t,e.line,e,n,o)||e.line!=n.line&&An(t,n.line,e,n,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");W=!0}if(o.addToHistory&&ho(t,{from:e,to:n,origin:"markText"},t.sel,NaN),a=t.cm,t.iter(l=e.line,n.line+1,function(t){a&&o.collapsed&&!a.options.lineWrapping&&Nn(t)==a.display.maxLine&&(c=!0),o.collapsed&&l!=e.line&&Ve(t,0),function(t,e){t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],e.marker.attachLine(t)}(t,new pn(o,l==e.line?e.ch:null,l==n.line?n.ch:null)),++l}),o.collapsed&&t.iter(e.line,n.line+1,function(e){Dn(t,e)&&Ve(e,0)}),o.clearOnEnter&&v(o,"beforeCursorEnter",function(){return o.clear()}),o.readOnly&&(D=!0,(t.history.done.length||t.history.undone.length)&&t.clearHistory()),o.collapsed&&(o.id=++J,o.atomic=!0),a){if(c&&(a.curOp.updateMaxLine=!0),o.collapsed)$r(a,e.line,n.line+1);else if(o.className||o.startStyle||o.endStyle||o.css||o.attributes||o.title)for(u=e.line;n.line>=u;u++)Kr(a,u,"text");o.atomic&&Ao(a.doc),Kn(a,"markerAdded",a,o)}return o}function Yo(t){return t.findMarks(Ye(t.first,0),t.clipPos(Ye(t.lastLine())),function(t){return t.parent})}function qo(t){var e,n=function(e){var n,r,i=t[e],o=[i.primary.doc];for(oo(i.primary.doc,function(t){return o.push(t)}),n=0;i.markers.length>n;n++)-1==se(o,(r=i.markers[n]).doc)&&(r.parent=null,i.markers.splice(n--,1))};for(e=0;t.length>e;e++)n(e)}function Jo(t){var e,n,r,i,o,s,l,a,c,u,h=this;if(Zo(h),!Se(h,t)&&!lr(h.display,t)&&(Ae(t),Dt&&(nt=+new Date),e=Vr(h,t,!0),n=t.dataTransfer.files,e&&!h.isReadOnly()))if(n&&n.length&&window.FileReader&&window.File)for(r=n.length,i=Array(r),o=0,s=function(t,n){if(!h.options.allowDropFileTypes||-1!=se(h.options.allowDropFileTypes,t.type)){var s=new FileReader;s.onload=Oi(h,function(){var t,l=s.result;/[\x00-\x08\x0e-\x1f]{2}/.test(l)&&(l=""),i[n]=l,++o==r&&(e=nn(h.doc,e),t={from:e,to:e,text:h.doc.splitLines(i.join(h.doc.lineSeparator())),origin:"paste"},Io(h.doc,t),So(h.doc,qi(e,Ji(t))))}),s.readAsText(t)}},l=0;r>l;++l)s(n[l],l);else{if(h.state.draggingText&&h.doc.sel.contains(e)>-1)return h.state.draggingText(t),void setTimeout(function(){return h.display.input.focus()},20);try{if(a=t.dataTransfer.getData("Text")){if(h.state.draggingText&&!h.state.draggingText.copy&&(c=h.listSelections()),Mo(h.doc,qi(e,e)),c)for(u=0;c.length>u;++u)zo(h.doc,"",c[u].anchor,c[u].head,"drag");h.replaceSelection(a,"around","paste"),h.display.input.focus()}}catch(t){}}}function Zo(t){t.display.dragCursor&&(t.display.lineSpace.removeChild(t.display.dragCursor),t.display.dragCursor=null)}function Qo(t){var e,n,r,i;if(document.getElementsByClassName){for(e=document.getElementsByClassName("CodeMirror"),n=[],r=0;e.length>r;r++)(i=e[r].CodeMirror)&&n.push(i);n.length&&n[0].operation(function(){for(var e=0;n.length>e;e++)t(n[e])})}}function ts(){var t;rt||(v(window,"resize",function(){null==t&&(t=setTimeout(function(){t=null,Qo(es)},100))}),v(window,"blur",function(){return Qo(si)}),rt=!0)}function es(t){var e=t.display;e.cachedCharWidth=e.cachedTextHeight=e.cachedPaddingH=null,e.scrollbarsClipped=!1,t.setSize()}Kt&&(Kt=Number(Kt[1])),Kt&&Kt>=15&&(Ft=!1,Et=!0),t=Vt&&(It||Ft&&(null==Kt||12.11>Kt)),e=At||Dt&&Wt>=9,n=function(t,e){var n,r=t.className,i=Xt(e).exec(r);i&&(n=r.slice(i.index+i[0].length),t.className=r.slice(0,i.index)+(n?i[1]+n:""))},r=document.createRange?function(t,e,n,r){var i=document.createRange();return i.setEnd(r||t,n),i.setStart(t,e),i}:function(t,e,n){var r=document.body.createTextRange();try{r.moveToElementText(t.parentNode)}catch(t){return r}return r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",e),r},i=function(t){t.select()},Bt?i=function(t){t.selectionStart=0,t.selectionEnd=t.value.length}:Dt&&(i=function(t){try{t.select()}catch(t){}}),(o=function(){this.id=null}).prototype.set=function(t,e){clearTimeout(this.id),this.id=setTimeout(e,t)},s=30,l={toString:function(){return"CodeMirror.Pass"}},a={scroll:!1},c={origin:"*mouse"},u={origin:"+move"},h=[""],d=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,f=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/,p=null,g=function(){var t,e,n,r,i,o="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",s="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function l(t,e,n){this.level=t,this.from=e,this.to=n}return t=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,e=/[stwN]/,n=/[LRr]/,r=/[Lb1n]/,i=/[1n]/,function(a,c){var u,h,d,f,p,g,m,v,y,b,w,x,k,C,S,L,M,T,A,N,O,_,D,W,E,I,H,F,P,R,z,B,U,j,V="ltr"==c?"L":"R";if(0==a.length||"ltr"==c&&!t.test(a))return!1;for(u=a.length,h=[],d=0;u>d;++d)h.push((j=a.charCodeAt(d))>247?1424>j||j>1524?1536>j||j>1785?1774>j||j>2220?8192>j||j>8203?8204==j?"b":"L":"w":"r":s.charAt(j-1536):"R":o.charAt(j));for(f=0,p=V;u>f;++f)"m"==(g=h[f])?h[f]=p:p=g;for(m=0,v=V;u>m;++m)"1"==(y=h[m])&&"r"==v?h[m]="n":n.test(y)&&(v=y,"r"==y&&(h[m]="R"));for(b=1,w=h[0];u-1>b;++b)"+"==(x=h[b])&&"1"==w&&"1"==h[b+1]?h[b]="1":","!=x||w!=h[b+1]||"1"!=w&&"n"!=w||(h[b]=w),w=x;for(k=0;u>k;++k)if(","==(C=h[k]))h[k]="N";else if("%"==C){for(S=void 0,S=k+1;u>S&&"%"==h[S];++S);for(L=k&&"!"==h[k-1]||u>S&&"1"==h[S]?"1":"N",M=k;S>M;++M)h[M]=L;k=S-1}for(T=0,A=V;u>T;++T)N=h[T],"L"==A&&"1"==N?h[T]="L":n.test(N)&&(A=N);for(O=0;u>O;++O)if(e.test(h[O])){for(_=void 0,_=O+1;u>_&&e.test(h[_]);++_);for(W=(D="L"==(O?h[O-1]:V))==("L"==(u>_?h[_]:V))?D?"L":"R":V,E=O;_>E;++E)h[E]=W;O=_-1}for(I=[],F=0;u>F;)if(r.test(h[F])){for(P=F,++F;u>F&&r.test(h[F]);++F);I.push(new l(0,P,F))}else{for(R=F,z=I.length,++F;u>F&&"L"!=h[F];++F);for(B=R;F>B;)if(i.test(h[B])){for(B>R&&I.splice(z,0,new l(1,R,B)),U=B,++B;F>B&&i.test(h[B]);++B);I.splice(z,0,new l(2,U,B)),R=B}else++B;F>R&&I.splice(z,0,new l(1,R,F))}return"ltr"==c&&(1==I[0].level&&(H=a.match(/^\s+/))&&(I[0].from=H[0].length,I.unshift(new l(0,0,H[0].length))),1==ce(I).level&&(H=a.match(/\s+$/))&&(ce(I).to-=H[0].length,I.push(new l(0,u-H[0].length,u)))),"rtl"==c?I.reverse():I}}(),m=[],v=function(t,e,n){if(t.addEventListener)t.addEventListener(e,n,!1);else if(t.attachEvent)t.attachEvent("on"+e,n);else{var r=t._handlers||(t._handlers={});r[e]=(r[e]||m).concat(n)}},y=function(){if(Dt&&9>Wt)return!1;var t=Jt("div");return"draggable"in t||"dragDrop"in t}(),x=3!="\n\nb".split(/\n/).length?function(t){for(var e,n,r,i=0,o=[],s=t.length;s>=i;)-1==(e=t.indexOf("\n",i))&&(e=t.length),n=t.slice(i,"\r"==t.charAt(e-1)?e-1:e),-1!=(r=n.indexOf("\r"))?(o.push(n.slice(0,r)),i+=r+1):(o.push(n),i=e+1);return o}:function(t){return t.split(/\r\n?|\n/)},k=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch(t){return!1}}:function(t){var e;try{e=t.ownerDocument.selection.createRange()}catch(t){}return!(!e||e.parentElement()!=t)&&0!=e.compareEndPoints("StartToEnd",e)},Lt=Jt("div"),C="oncopy"in Lt||(Lt.setAttribute("oncopy","return;"),"function"==typeof Lt.oncopy),S=null,L={},M={},T={},(A=function(t,e,n){this.pos=this.start=0,this.string=t,this.tabSize=e||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=n}).prototype.eol=function(){return this.pos>=this.string.length},A.prototype.sol=function(){return this.pos==this.lineStart},A.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},A.prototype.next=function(){if(this.string.length>this.pos)return this.string.charAt(this.pos++)},A.prototype.eat=function(t){var e=this.string.charAt(this.pos);if("string"==typeof t?e==t:e&&(t.test?t.test(e):t(e)))return++this.pos,e},A.prototype.eatWhile=function(t){for(var e=this.pos;this.eat(t););return this.pos>e},A.prototype.eatSpace=function(){for(var t=this,e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++t.pos;return this.pos>e},A.prototype.skipToEnd=function(){this.pos=this.string.length},A.prototype.skipTo=function(t){var e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0},A.prototype.backUp=function(t){this.pos-=t},A.prototype.column=function(){return this.start>this.lastColumnPos&&(this.lastColumnValue=oe(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?oe(this.string,this.lineStart,this.tabSize):0)},A.prototype.indentation=function(){return oe(this.string,null,this.tabSize)-(this.lineStart?oe(this.string,this.lineStart,this.tabSize):0)},A.prototype.match=function(t,e,n){var r,i,o;return"string"!=typeof t?(o=this.string.slice(this.pos).match(t))&&o.index>0?null:(o&&!1!==e&&(this.pos+=o[0].length),o):(r=function(t){return n?t.toLowerCase():t},i=this.string.substr(this.pos,t.length),r(i)==r(t)?(!1!==e&&(this.pos+=t.length),!0):void 0)},A.prototype.current=function(){return this.string.slice(this.start,this.pos)},A.prototype.hideFirstChars=function(t,e){this.lineStart+=t;try{return e()}finally{this.lineStart-=t}},A.prototype.lookAhead=function(t){var e=this.lineOracle;return e&&e.lookAhead(t)},A.prototype.baseToken=function(){var t=this.lineOracle;return t&&t.baseToken(this.pos)},N=function(t,e){this.state=t,this.lookAhead=e},(O=function(t,e,n,r){this.state=e,this.doc=t,this.line=n,this.maxLookAhead=r||0,this.baseTokens=null,this.baseTokenPos=1}).prototype.lookAhead=function(t){var e=this.doc.getLine(this.line+t);return null!=e&&t>this.maxLookAhead&&(this.maxLookAhead=t),e},O.prototype.baseToken=function(t){var e,n=this;if(!this.baseTokens)return null;for(;t>=this.baseTokens[this.baseTokenPos];)n.baseTokenPos+=2;return{type:(e=this.baseTokens[this.baseTokenPos+1])&&e.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-t}},O.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},O.fromSaved=function(t,e,n){return e instanceof N?new O(t,Pe(t.mode,e.state),n,e.lookAhead):new O(t,Pe(t.mode,e),n)},O.prototype.save=function(t){var e=!1!==t?Pe(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new N(e,this.maxLookAhead):e},_=function(t,e,n){this.start=t.start,this.end=t.pos,this.string=t.current(),this.type=e||null,this.state=n},D=!1,W=!1,(E=function(t,e,n){this.text=t,wn(this,e),this.height=n?n(this):1}).prototype.lineNo=function(){return Ge(this)},Te(E),I={},H={},F=null,P=null,R={left:0,right:0,top:0,bottom:0},(B=function(t,e,n){var r,i;this.cm=n,r=this.vert=Jt("div",[Jt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=Jt("div",[Jt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar"),r.tabIndex=i.tabIndex=-1,t(r),t(i),v(r,"scroll",function(){r.clientHeight&&e(r.scrollTop,"vertical")}),v(i,"scroll",function(){i.clientWidth&&e(i.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,Dt&&8>Wt&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}).prototype.update=function(t){var e=t.scrollWidth>t.clientWidth+1,n=t.scrollHeight>t.clientHeight+1,r=t.nativeBarWidth;return n?(this.vert.style.display="block",this.vert.style.bottom=e?r+"px":"0",this.vert.firstChild.style.height=Math.max(0,t.scrollHeight-t.clientHeight+(t.viewHeight-(e?r:0)))+"px"):(this.vert.style.display="",this.vert.firstChild.style.height="0"),e?(this.horiz.style.display="block",this.horiz.style.right=n?r+"px":"0",this.horiz.style.left=t.barLeft+"px",this.horiz.firstChild.style.width=Math.max(0,t.scrollWidth-t.clientWidth+(t.viewWidth-t.barLeft-(n?r:0)))+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&t.clientHeight>0&&(0==r&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?r:0,bottom:e?r:0}},B.prototype.setScrollLeft=function(t){this.horiz.scrollLeft!=t&&(this.horiz.scrollLeft=t),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},B.prototype.setScrollTop=function(t){this.vert.scrollTop!=t&&(this.vert.scrollTop=t),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},B.prototype.zeroWidthHack=function(){var t=Vt&&!Rt?"12px":"18px";this.horiz.style.height=this.vert.style.width=t,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new o,this.disableVert=new o},B.prototype.enableZeroWidthBar=function(t,e,n){t.style.pointerEvents="auto",e.set(1e3,function r(){var i=t.getBoundingClientRect(),o="vert"==n?document.elementFromPoint(i.right-1,(i.top+i.bottom)/2):document.elementFromPoint((i.right+i.left)/2,i.bottom-1);o!=t?t.style.pointerEvents="none":e.set(1e3,r)})},B.prototype.clear=function(){var t=this.horiz.parentNode;t.removeChild(this.horiz),t.removeChild(this.vert)},(U=function(){}).prototype.update=function(){return{bottom:0,right:0}},U.prototype.setScrollLeft=function(){},U.prototype.setScrollTop=function(){},U.prototype.clear=function(){},j={native:B,null:U},V=0,(G=function(t,e,n){var r=t.display;this.viewport=e,this.visible=ci(r,t.doc,e),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=dr(t),this.force=n,this.dims=zr(t),this.events=[]}).prototype.signal=function(t,e){Me(t,e)&&this.events.push(arguments)},G.prototype.finish=function(){var t,e=this;for(t=0;this.events.length>t;t++)Ce.apply(null,e.events[t])},$=0,K=null,Dt?K=-.53:At?K=15:Ht?K=-.7:Pt&&(K=-1/3),(X=function(t,e){this.ranges=t,this.primIndex=e}).prototype.primary=function(){return this.ranges[this.primIndex]},X.prototype.equals=function(t){var e,n,r,i=this;if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(e=0;this.ranges.length>e;e++)if(!Je((n=i.ranges[e]).anchor,(r=t.ranges[e]).anchor)||!Je(n.head,r.head))return!1;return!0},X.prototype.deepCopy=function(){var t,e=this,n=[];for(t=0;this.ranges.length>t;t++)n[t]=new Y(Ze(e.ranges[t].anchor),Ze(e.ranges[t].head));return new X(n,this.primIndex)},X.prototype.somethingSelected=function(){var t,e=this;for(t=0;this.ranges.length>t;t++)if(!e.ranges[t].empty())return!0;return!1},X.prototype.contains=function(t,e){var n,r,i=this;for(e||(e=t),n=0;this.ranges.length>n;n++)if(qe(e,(r=i.ranges[n]).from())>=0&&0>=qe(t,r.to()))return n;return-1},(Y=function(t,e){this.anchor=t,this.head=e}).prototype.from=function(){return tn(this.anchor,this.head)},Y.prototype.to=function(){return Qe(this.anchor,this.head)},Y.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},Go.prototype={chunkSize:function(){return this.lines.length},removeInner:function(t,e){var n,r,i,o=this;for(n=t,r=t+e;r>n;++n)o.height-=(i=o.lines[n]).height,Fn(i),Kn(i,"delete");this.lines.splice(t,e)},collapse:function(t){t.push.apply(t,this.lines)},insertInner:function(t,e,n){var r,i=this;for(this.height+=n,this.lines=this.lines.slice(0,t).concat(e).concat(this.lines.slice(t)),r=0;e.length>r;++r)e[r].parent=i},iterN:function(t,e,n){var r,i=this;for(r=t+e;r>t;++t)if(n(i.lines[t]))return!0}},$o.prototype={chunkSize:function(){return this.size},removeInner:function(t,e){var n,r,i,o,s,l,a=this;for(this.size-=e,n=0;this.children.length>n;++n)if((i=(r=a.children[n]).chunkSize())>t){if(o=Math.min(e,i-t),s=r.height,r.removeInner(t,o),a.height-=s-r.height,i==o&&(a.children.splice(n--,1),r.parent=null),0==(e-=o))break;t=0}else t-=i;this.size-e>=25||1>=this.children.length&&this.children[0]instanceof Go||(this.collapse(l=[]),this.children=[new Go(l)],this.children[0].parent=this)},collapse:function(t){var e,n=this;for(e=0;this.children.length>e;++e)n.children[e].collapse(t)},insertInner:function(t,e,n){var r,i,o,s,l,a,c=this;for(this.size+=e.length,this.height+=n,r=0;this.children.length>r;++r){if((o=(i=c.children[r]).chunkSize())>=t){if(i.insertInner(t,e,n),i.lines&&i.lines.length>50){for(l=s=i.lines.length%25+25;i.lines.length>l;)a=new Go(i.lines.slice(l,l+=25)),i.height-=a.height,c.children.splice(++r,0,a),a.parent=c;i.lines=i.lines.slice(0,s),c.maybeSpill()}break}t-=o}},maybeSpill:function(){var t,e,n,r,i;if(this.children.length>10){t=this;do{e=t.children.splice(t.children.length-5,5),n=new $o(e),t.parent?(t.size-=n.size,t.height-=n.height,i=se(t.parent.children,t),t.parent.children.splice(i+1,0,n)):((r=new $o(t.children)).parent=t,t.children=[r,n],t=r),n.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,e,n){var r,i,o,s,l=this;for(r=0;this.children.length>r;++r)if((o=(i=l.children[r]).chunkSize())>t){if(s=Math.min(e,o-t),i.iterN(t,s,n))return!0;if(0==(e-=s))break;t=0}else t-=o}},(q=function(t,e,n){var r,i=this;if(n)for(r in n)n.hasOwnProperty(r)&&(i[r]=n[r]);this.doc=t,this.node=e}).prototype.clear=function(){var t,e,n=this,r=this.doc.cm,i=this.line.widgets,o=this.line,s=Ge(o);if(null!=s&&i){for(t=0;i.length>t;++t)i[t]==n&&i.splice(t--,1);i.length||(o.widgets=null),e=sr(this),Ve(o,Math.max(0,o.height-e)),r&&(Ni(r,function(){Ko(r,o,-e),Kr(r,s,"widget")}),Kn(r,"lineWidgetCleared",r,this,s))}},q.prototype.changed=function(){var t,e=this,n=this.height,r=this.doc.cm,i=this.line;this.height=null,(t=sr(this)-n)&&(Dn(this.doc,i)||Ve(i,i.height+t),r&&Ni(r,function(){r.curOp.forceUpdate=!0,Ko(r,i,t),Kn(r,"lineWidgetChanged",r,e,Ge(i))}))},Te(q),J=0,(Z=function(t,e){this.lines=[],this.type=e,this.doc=t,this.id=++J}).prototype.clear=function(){var t,e,n,r,i,o,s,l,a,c,u,h=this;if(!this.explicitlyCleared){for((e=(t=this.doc.cm)&&!t.curOp)&&Ci(t),Me(this,"clear")&&(n=this.find())&&Kn(this,"clear",n.from,n.to),r=null,i=null,o=0;this.lines.length>o;++o)l=gn((s=h.lines[o]).markedSpans,h),t&&!h.collapsed?Kr(t,Ge(s),"text"):t&&(null!=l.to&&(i=Ge(s)),null!=l.from&&(r=Ge(s))),s.markedSpans=mn(s.markedSpans,l),null==l.from&&h.collapsed&&!Dn(h.doc,s)&&t&&Ve(s,Pr(t.display));if(t&&this.collapsed&&!t.options.lineWrapping)for(a=0;this.lines.length>a;++a)c=Nn(h.lines[a]),(u=In(c))>t.display.maxLineLength&&(t.display.maxLine=c,t.display.maxLineLength=u,t.display.maxLineChanged=!0);null!=r&&t&&this.collapsed&&$r(t,r,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&Ao(t.doc)),t&&Kn(t,"markerCleared",t,this,r,i),e&&Si(t),this.parent&&this.parent.clear()}},Z.prototype.find=function(t,e){var n,r,i,o,s,l=this;for(null==t&&"bookmark"==this.type&&(t=1),i=0;this.lines.length>i;++i){if(null!=(s=gn((o=l.lines[i]).markedSpans,l)).from&&(n=Ye(e?o:Ge(o),s.from),-1==t))return n;if(null!=s.to&&(r=Ye(e?o:Ge(o),s.to),1==t))return r}return n&&{from:n,to:r}},Z.prototype.changed=function(){var t=this,e=this.find(-1,!0),n=this,r=this.doc.cm;e&&r&&Ni(r,function(){var i,o,s=e.line,l=Ge(e.line),a=mr(r,l);a&&(xr(a),r.curOp.selectionChanged=r.curOp.forceUpdate=!0),r.curOp.updateMaxLine=!0,Dn(n.doc,s)||null==n.height||(i=n.height,n.height=null,(o=sr(n)-i)&&Ve(s,s.height+o)),Kn(r,"markerChanged",r,t)})},Z.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;e.maybeHiddenMarkers&&-1!=se(e.maybeHiddenMarkers,this)||(e.maybeUnhiddenMarkers||(e.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},Z.prototype.detachLine=function(t){if(this.lines.splice(se(this.lines,t),1),!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)}},Te(Z),(Q=function(t,e){var n,r=this;for(this.markers=t,this.primary=e,n=0;t.length>n;++n)t[n].parent=r}).prototype.clear=function(){var t,e=this;if(!this.explicitlyCleared){for(this.explicitlyCleared=!0,t=0;this.markers.length>t;++t)e.markers[t].clear();Kn(this,"clear")}},Q.prototype.find=function(t,e){return this.primary.find(t,e)},Te(Q),tt=0,(et=function(t,e,n,r,i){if(!(this instanceof et))return new et(t,e,n,r,i);null==n&&(n=0),$o.call(this,[new Go([new E("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=n;var o=Ye(n,0);this.sel=qi(o),this.history=new ao(null),this.id=++tt,this.modeOption=e,this.lineSep=r,this.direction="rtl"==i?"rtl":"ltr",this.extend=!1,"string"==typeof t&&(t=this.splitLines(t)),io(this,{from:o,to:o,text:t}),Lo(this,qi(o),a)}).prototype=de($o.prototype,{constructor:et,iter:function(t,e,n){n?this.iterN(t-this.first,e-t,n):this.iterN(this.first,this.first+this.size,t)},insert:function(t,e){var n,r=0;for(n=0;e.length>n;++n)r+=e[n].height;this.insertInner(t-this.first,e,r)},remove:function(t,e){this.removeInner(t-this.first,e)},getValue:function(t){var e=je(this,this.first,this.first+this.size);return!1===t?e:e.join(t||this.lineSeparator())},setValue:Di(function(t){var e=Ye(this.first,0),n=this.first+this.size-1;Io(this,{from:e,to:Ye(n,Be(this,n).text.length),text:this.splitLines(t),origin:"setValue",full:!0},!0),this.cm&&fi(this.cm,0,0),Lo(this,qi(e),a)}),replaceRange:function(t,e,n,r){e=nn(this,e),n=n?nn(this,n):e,zo(this,t,e,n,r)},getRange:function(t,e,n){var r=Ue(this,nn(this,t),nn(this,e));return!1===n?r:r.join(n||this.lineSeparator())},getLine:function(t){var e=this.getLineHandle(t);return e&&e.text},getLineHandle:function(t){if(Ke(this,t))return Be(this,t)},getLineNumber:function(t){return Ge(t)},getLineHandleVisualStart:function(t){return"number"==typeof t&&(t=Be(this,t)),Nn(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return nn(this,t)},getCursor:function(t){var e=this.sel.primary();return null==t||"head"==t?e.head:"anchor"==t?e.anchor:"end"==t||"to"==t||!1===t?e.to():e.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Di(function(t,e,n){Co(this,nn(this,"number"==typeof t?Ye(t,e||0):t),null,n)}),setSelection:Di(function(t,e,n){Co(this,nn(this,t),nn(this,e||t),n)}),extendSelection:Di(function(t,e,n){wo(this,nn(this,t),e&&nn(this,e),n)}),extendSelections:Di(function(t,e){xo(this,rn(this,t),e)}),extendSelectionsBy:Di(function(t,e){var n=ue(this.sel.ranges,t);xo(this,rn(this,n),e)}),setSelections:Di(function(t,e,n){var r,i,o=this;if(t.length){for(r=[],i=0;t.length>i;i++)r[i]=new Y(nn(o,t[i].anchor),nn(o,t[i].head));null==e&&(e=Math.min(t.length-1,this.sel.primIndex)),Lo(this,Yi(this.cm,r,e),n)}}),addSelection:Di(function(t,e,n){var r=this.sel.ranges.slice(0);r.push(new Y(nn(this,t),nn(this,e||t))),Lo(this,Yi(this.cm,r,r.length-1),n)}),getSelection:function(t){var e,n,r,i=this,o=this.sel.ranges;for(n=0;o.length>n;n++)r=Ue(i,o[n].from(),o[n].to()),e=e?e.concat(r):r;return!1===t?e:e.join(t||this.lineSeparator())},getSelections:function(t){var e,n,r=this,i=[],o=this.sel.ranges;for(e=0;o.length>e;e++)n=Ue(r,o[e].from(),o[e].to()),!1!==t&&(n=n.join(t||r.lineSeparator())),i[e]=n;return i},replaceSelection:function(t,e,n){var r,i=[];for(r=0;this.sel.ranges.length>r;r++)i[r]=t;this.replaceSelections(i,e,n||"+input")},replaceSelections:Di(function(t,e,n){var r,i,o,s,l=this,a=[],c=this.sel;for(r=0;c.ranges.length>r;r++)a[r]={from:(i=c.ranges[r]).from(),to:i.to(),text:l.splitLines(t[r]),origin:n};for(o=e&&"end"!=e&&function(t,e,n){var r,i,o,s,l,a,c,u,h;for(r=[],i=Ye(t.first,0),o=i,s=0;e.length>s;s++)a=to((l=e[s]).from,i,o),c=to(Ji(l),i,o),i=l.to,o=c,"around"==n?(h=0>qe((u=t.sel.ranges[s]).head,u.anchor),r[s]=new Y(h?c:a,h?a:c)):r[s]=new Y(a,a);return new X(r,t.sel.primIndex)}(this,a,e),s=a.length-1;s>=0;s--)Io(l,a[s]);o?So(this,o):this.cm&&di(this.cm)}),undo:Di(function(){Fo(this,"undo")}),redo:Di(function(){Fo(this,"redo")}),undoSelection:Di(function(){Fo(this,"undo",!0)}),redoSelection:Di(function(){Fo(this,"redo",!0)}),setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){var t,e,n=this.history,r=0,i=0;for(t=0;n.done.length>t;t++)n.done[t].ranges||++r;for(e=0;n.undone.length>e;e++)n.undone[e].ranges||++i;return{undo:r,redo:i}},clearHistory:function(){this.history=new ao(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:yo(this.history.done),undone:yo(this.history.undone)}},setHistory:function(t){var e=this.history=new ao(this.history.maxGeneration);e.done=yo(t.done.slice(0),null,!0),e.undone=yo(t.undone.slice(0),null,!0)},setGutterMarker:Di(function(t,e,n){return Vo(this,t,"gutter",function(t){var r=t.gutterMarkers||(t.gutterMarkers={});return r[e]=n,!n&&ge(r)&&(t.gutterMarkers=null),!0})}),clearGutter:Di(function(t){var e=this;this.iter(function(n){n.gutterMarkers&&n.gutterMarkers[t]&&Vo(e,n,"gutter",function(){return n.gutterMarkers[t]=null,ge(n.gutterMarkers)&&(n.gutterMarkers=null),!0})})}),lineInfo:function(t){var e;if("number"==typeof t){if(!Ke(this,t))return null;if(e=t,!(t=Be(this,t)))return null}else if(null==(e=Ge(t)))return null;return{line:e,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},addLineClass:Di(function(t,e,n){return Vo(this,t,"gutter"==e?"gutter":"class",function(t){var r="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass";if(t[r]){if(Xt(n).test(t[r]))return!1;t[r]+=" "+n}else t[r]=n;return!0})}),removeLineClass:Di(function(t,e,n){return Vo(this,t,"gutter"==e?"gutter":"class",function(t){var r,i,o="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass",s=t[o];if(!s)return!1;if(null==n)t[o]=null;else{if(!(r=s.match(Xt(n))))return!1;i=r.index+r[0].length,t[o]=s.slice(0,r.index)+(r.index&&i!=s.length?" ":"")+s.slice(i)||null}return!0})}),addLineWidget:Di(function(t,e,n){return function(t,e,n,r){var i=new q(t,n,r),o=t.cm;return o&&i.noHScroll&&(o.display.alignWidgets=!0),Vo(t,e,"widget",function(e){var n,r=e.widgets||(e.widgets=[]);return null==i.insertAt?r.push(i):r.splice(Math.min(r.length-1,Math.max(0,i.insertAt)),0,i),i.line=e,o&&!Dn(t,e)&&(n=En(e)<t.scrollTop,Ve(e,e.height+sr(i)),n&&hi(o,i.height),o.curOp.forceUpdate=!0),!0}),o&&Kn(o,"lineWidgetAdded",o,i,"number"==typeof e?e:Ge(e)),i}(this,t,e,n)}),removeLineWidget:function(t){t.clear()},markText:function(t,e,n){return Xo(this,nn(this,t),nn(this,e),n,n&&n.type||"range")},setBookmark:function(t,e){var n={replacedWith:e&&(null==e.nodeType?e.widget:e),insertLeft:e&&e.insertLeft,clearWhenEmpty:!1,shared:e&&e.shared,handleMouseEvents:e&&e.handleMouseEvents};return Xo(this,t=nn(this,t),t,n,"bookmark")},findMarksAt:function(t){var e,n,r,i;if(t=nn(this,t),e=[],n=Be(this,t.line).markedSpans)for(r=0;n.length>r;++r)null!=(i=n[r]).from&&i.from>t.ch||null!=i.to&&t.ch>i.to||e.push(i.marker.parent||i.marker);return e},findMarks:function(t,e,n){t=nn(this,t),e=nn(this,e);var r=[],i=t.line;return this.iter(t.line,e.line+1,function(o){var s,l,a=o.markedSpans;if(a)for(s=0;a.length>s;s++)null!=(l=a[s]).to&&i==t.line&&t.ch>=l.to||null==l.from&&i!=t.line||null!=l.from&&i==e.line&&l.from>=e.ch||n&&!n(l.marker)||r.push(l.marker.parent||l.marker);++i}),r},getAllMarks:function(){var t=[];return this.iter(function(e){var n,r=e.markedSpans;if(r)for(n=0;r.length>n;++n)null!=r[n].from&&t.push(r[n].marker)}),t},posFromIndex:function(t){var e,n=this.first,r=this.lineSeparator().length;return this.iter(function(i){var o=i.text.length+r;if(o>t)return e=t,!0;t-=o,++n}),nn(this,Ye(n,e))},indexFromPos:function(t){var e,n;return t=nn(this,t),e=t.ch,this.first>t.line||0>t.ch?0:(n=this.lineSeparator().length,this.iter(this.first,t.line,function(t){e+=t.text.length+n}),e)},copy:function(t){var e=new et(je(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return e.scrollTop=this.scrollTop,e.scrollLeft=this.scrollLeft,e.sel=this.sel,e.extend=!1,t&&(e.history.undoDepth=this.history.undoDepth,e.setHistory(this.getHistory())),e},linkedDoc:function(t){var e,n,r;return t||(t={}),e=this.first,n=this.first+this.size,null!=t.from&&t.from>e&&(e=t.from),null!=t.to&&n>t.to&&(n=t.to),r=new et(je(this,e,n),t.mode||this.modeOption,e,this.lineSep,this.direction),t.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:t.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],function(t,e){var n,r,i,o,s,l;for(n=0;e.length>n;n++)i=(r=e[n]).find(),o=t.clipPos(i.from),s=t.clipPos(i.to),qe(o,s)&&(l=Xo(t,o,s,r.primary,r.primary.type),r.markers.push(l),l.parent=r)}(r,Yo(this)),r},unlinkDoc:function(t){var e,n,r=this;if(t instanceof Os&&(t=t.doc),this.linked)for(e=0;this.linked.length>e;++e)if(r.linked[e].doc==t){r.linked.splice(e,1),t.unlinkDoc(r),qo(Yo(r));break}t.history==this.history&&(n=[t.id],oo(t,function(t){return n.push(t.id)},!0),t.history=new ao(null),t.history.done=yo(this.history.done,n),t.history.undone=yo(this.history.undone,n))},iterLinkedDocs:function(t){oo(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(t){return this.lineSep?t.split(this.lineSep):x(t)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:Di(function(t){var e;"rtl"!=t&&(t="ltr"),t!=this.direction&&(this.direction=t,this.iter(function(t){return t.order=null}),this.cm&&Ni(e=this.cm,function(){lo(e),$r(e)}))})}),et.prototype.eachLine=et.prototype.iter,nt=0,rt=!1;for(it={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},ot=0;10>ot;ot++)it[ot+48]=it[ot+96]=String(ot);for(st=65;90>=st;st++)it[st]=String.fromCharCode(st);for(lt=1;12>=lt;lt++)it[lt+111]=it[lt+63235]="F"+lt;function ns(t){var e,n,r,i,o,s,l=t.split(/-(?!$)/);for(t=l[l.length-1],o=0;l.length-1>o;o++)if(/^(cmd|meta|m)$/i.test(s=l[o]))i=!0;else if(/^a(lt)?$/i.test(s))e=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else{if(!/^s(hift)?$/i.test(s))throw new Error("Unrecognized modifier name: "+s);r=!0}return e&&(t="Alt-"+t),n&&(t="Ctrl-"+t),i&&(t="Cmd-"+t),r&&(t="Shift-"+t),t}function rs(t){var e,n,r,i,o,s,l,a,c={};for(e in t)if(t.hasOwnProperty(e)){if(n=t[e],/^(name|fallthrough|(de|at)tach)$/.test(e))continue;if("..."==n){delete t[e];continue}for(r=ue(e.split(" "),ns),i=0;r.length>i;i++)if(o=void 0,s=void 0,i==r.length-1?(s=r.join(" "),o=n):(s=r.slice(0,i+1).join(" "),o="..."),l=c[s]){if(l!=o)throw new Error("Inconsistent bindings for "+s)}else c[s]=o;delete t[e]}for(a in c)t[a]=c[a];return t}function is(t,e,n,r){var i,o,s;if(e=as(e),!1===(i=e.call?e.call(t,r):e[t]))return"nothing";if("..."===i)return"multi";if(null!=i&&n(i))return"handled";if(e.fallthrough){if("[object Array]"!=Object.prototype.toString.call(e.fallthrough))return is(t,e.fallthrough,n,r);for(o=0;e.fallthrough.length>o;o++)if(s=is(t,e.fallthrough[o],n,r))return s}}function os(t){var e="string"==typeof t?t:it[t.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function ss(e,n,r){var i=e;return n.altKey&&"Alt"!=i&&(e="Alt-"+e),(t?n.metaKey:n.ctrlKey)&&"Ctrl"!=i&&(e="Ctrl-"+e),(t?n.ctrlKey:n.metaKey)&&"Cmd"!=i&&(e="Cmd-"+e),!r&&n.shiftKey&&"Shift"!=i&&(e="Shift-"+e),e}function ls(t,e){if(Ft&&34==t.keyCode&&t.char)return!1;var n=it[t.keyCode];return null!=n&&!t.altGraphKey&&(3==t.keyCode&&t.code&&(n=t.code),ss(n,t,e))}function as(t){return"string"==typeof t?at[t]:t}function cs(t,e){var n,r,i,o=t.doc.sel.ranges,s=[];for(n=0;o.length>n;n++){for(r=e(o[n]);s.length&&0>=qe(r.from,ce(s).to);)if(0>qe((i=s.pop()).from,r.from)){r.from=i.from;break}s.push(r)}Ni(t,function(){for(var e=s.length-1;e>=0;e--)zo(t.doc,"",s[e].from,s[e].to,"+delete");di(t)})}function us(t,e,n){var r=ve(t.text,e+n,n);return 0>r||r>t.text.length?null:r}function hs(t,e,n){var r=us(t,e.ch,n);return null==r?null:new Ye(e.line,r,0>n?"after":"before")}function ds(t,e,n,r,i){var o,s,l,a,c,u;return t&&(o=we(n,e.doc.direction))?(s=0>i?ce(o):o[0],l=0>i==(1==s.level)?"after":"before",s.level>0||"rtl"==e.doc.direction?(c=vr(e,n),u=yr(e,c,a=0>i?n.text.length-1:0).top,a=ye(function(t){return yr(e,c,t).top==u},0>i==(1==s.level)?s.from:s.to-1,a),"before"==l&&(a=us(n,a,1))):a=0>i?s.to:s.from,new Ye(r,a,l)):new Ye(r,0>i?n.text.length:0,0>i?"before":"after")}function fs(t,e){var n=Be(t.doc,e),r=Nn(n);return r!=n&&(e=Ge(r)),ds(!0,t,r,e,1)}function ps(t,e){var n,r=fs(t,e.line),i=Be(t.doc,r.line),o=we(i,t.doc.direction);return o&&0!=o[0].level?r:(n=Math.max(0,i.text.search(/\S/)),Ye(r.line,e.line==r.line&&n>=e.ch&&e.ch?0:n,r.sticky))}function gs(t,e,n){if("string"==typeof e&&!(e=ct[e]))return!1;t.display.input.ensurePolled();var r=t.display.shift,i=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),n&&(t.display.shift=!1),i=e(t)!=l}finally{t.display.shift=r,t.state.suppressEdits=!1}return i}function ms(t,e,n,r){var i=t.state.keySeq;if(i){if(os(e))return"handled";if(/\'$/.test(e)?t.state.keySeq=null:ut.set(50,function(){t.state.keySeq==i&&(t.state.keySeq=null,t.display.input.reset())}),vs(t,i+" "+e,n,r))return!0}return vs(t,e,n,r)}function vs(t,e,n,r){var i=function(t,e,n){var r,i;for(r=0;t.state.keyMaps.length>r;r++)if(i=is(e,t.state.keyMaps[r],n,t))return i;return t.options.extraKeys&&is(e,t.options.extraKeys,n,t)||is(e,t.options.keyMap,n,t)}(t,e,r);return"multi"==i&&(t.state.keySeq=e),"handled"==i&&Kn(t,"keyHandled",t,e,n),"handled"!=i&&"multi"!=i||(Ae(n),ni(t)),!!i}function ys(t,e){var n=ls(e,!0);return!!n&&(e.shiftKey&&!t.state.keySeq?ms(t,"Shift-"+n,e,function(e){return gs(t,e,!0)})||ms(t,n,e,function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return gs(t,e)}):ms(t,n,e,function(e){return gs(t,e)}))}function bs(t){var e,r,i=this;i.curOp.focus=te(),Se(i,t)||(Dt&&11>Wt&&27==t.keyCode&&(t.returnValue=!1),i.display.shift=16==(e=t.keyCode)||t.shiftKey,r=ys(i,t),Ft&&(ht=r?e:null,!r&&88==e&&!C&&(Vt?t.metaKey:t.ctrlKey)&&i.replaceSelection("",null,"cut")),18!=e||/\bCodeMirror-crosshair\b/.test(i.display.lineDiv.className)||function(t){var e=t.display.lineDiv;function r(t){18!=t.keyCode&&t.altKey||(n(e,"CodeMirror-crosshair"),ke(document,"keyup",r),ke(document,"mouseover",r))}ee(e,"CodeMirror-crosshair"),v(document,"keyup",r),v(document,"mouseover",r)}(i))}function ws(t){16==t.keyCode&&(this.doc.sel.shift=!1),Se(this,t)}function xs(t){var e,n,r,i=this;if(!(lr(i.display,t)||Se(i,t)||t.ctrlKey&&!t.altKey||Vt&&t.metaKey)){if(e=t.keyCode,n=t.charCode,Ft&&e==ht)return ht=null,void Ae(t);Ft&&(!t.which||10>t.which)&&ys(i,t)||"\b"!=(r=String.fromCharCode(null==n?e:n))&&(function(t,e,n){return ms(t,"'"+n+"'",e,function(e){return gs(t,e,!0)})}(i,t,r)||i.display.input.onKeyPress(t))}}function ks(t){var n,r,i,o=this,s=o.display;Se(o,t)||s.activeTouch&&s.input.supportsTouch()||(s.input.ensurePolled(),s.shift=t.shiftKey,lr(s,t)?Et||(s.scroller.draggable=!1,setTimeout(function(){return s.scroller.draggable=!0},100)):Ls(o,t)||(n=Vr(o,t),r=We(t),i=n?function(t,e){var n=+new Date;return gt&&gt.compare(n,t,e)?(pt=gt=null,"triple"):pt&&pt.compare(n,t,e)?(gt=new ft(n,t,e),pt=null,"double"):(pt=new ft(n,t,e),gt=null,"single")}(n,r):"single",window.focus(),1==r&&o.state.selectingText&&o.state.selectingText(t),n&&function(t,e,n,r,i){var o="Click";return"double"==r?o="Double"+o:"triple"==r&&(o="Triple"+o),ms(t,ss(o=(1==e?"Left":2==e?"Middle":"Right")+o,i),i,function(e){if("string"==typeof e&&(e=ct[e]),!e)return!1;var r=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),r=e(t,n)!=l}finally{t.state.suppressEdits=!1}return r})}(o,r,n,i,t)||(1==r?n?function(t,e,n,r){Dt?setTimeout(re(ri,t),0):t.curOp.focus=te();var i,o=function(t,e,n){var r=t.getOption("configureMouse"),i=r?r(t,e,n):{};return null==i.unit&&(i.unit=(Gt?n.shiftKey&&n.metaKey:n.altKey)?"rectangle":"single"==e?"char":"double"==e?"word":"line"),(null==i.extend||t.doc.extend)&&(i.extend=t.doc.extend||n.shiftKey),null==i.addNew&&(i.addNew=Vt?n.metaKey:n.ctrlKey),null==i.moveOnDrag&&(i.moveOnDrag=!(Vt?n.altKey:n.ctrlKey)),i}(t,n,r),s=t.doc.sel;t.options.dragDrop&&y&&!t.isReadOnly()&&"single"==n&&(i=s.contains(e))>-1&&(0>qe((i=s.ranges[i]).from(),e)||e.xRel>0)&&(qe(i.to(),e)>0||0>e.xRel)?function(t,e,n,r){var i=t.display,o=!1,s=Oi(t,function(e){Et&&(i.scroller.draggable=!1),t.state.draggingText=!1,ke(i.wrapper.ownerDocument,"mouseup",s),ke(i.wrapper.ownerDocument,"mousemove",l),ke(i.scroller,"dragstart",a),ke(i.scroller,"drop",s),o||(Ae(e),r.addNew||wo(t.doc,n,null,null,r.extend),Et||Dt&&9==Wt?setTimeout(function(){i.wrapper.ownerDocument.body.focus(),i.input.focus()},20):i.input.focus())}),l=function(t){o=o||Math.abs(e.clientX-t.clientX)+Math.abs(e.clientY-t.clientY)>=10},a=function(){return o=!0};Et&&(i.scroller.draggable=!0),t.state.draggingText=s,s.copy=!r.moveOnDrag,i.scroller.dragDrop&&i.scroller.dragDrop(),v(i.wrapper.ownerDocument,"mouseup",s),v(i.wrapper.ownerDocument,"mousemove",l),v(i.scroller,"dragstart",a),v(i.scroller,"drop",s),ii(t),setTimeout(function(){return i.input.focus()},20)}(t,r,e,o):function(t,e,n,r){var i,o,s,l,a,u,h,d,f,p,g=t.display,m=t.doc;function y(e){var l,a,h,d,f,p,g,v,y,b,w,x,k,C,S;if(0!=qe(u,e))if(u=e,"rectangle"==r.unit){for(l=[],a=t.options.tabSize,h=oe(Be(m,n.line).text,n.ch,a),d=oe(Be(m,e.line).text,e.ch,a),f=Math.min(h,d),p=Math.max(h,d),g=Math.min(n.line,e.line),v=Math.min(t.lastLine(),Math.max(n.line,e.line));v>=g;g++)y=Be(m,g).text,b=le(y,f,a),f==p?l.push(new Y(Ye(g,b),Ye(g,b))):y.length>b&&l.push(new Y(Ye(g,b),Ye(g,le(y,p,a))));l.length||l.push(new Y(n,n)),Lo(m,Yi(t,s.ranges.slice(0,o).concat(l),o),{origin:"*mouse",scroll:!1}),t.scrollIntoView(e)}else w=i,qe((x=Cs(t,e,r.unit)).anchor,k=w.anchor)>0?(C=x.head,k=tn(w.from(),x.anchor)):(C=x.anchor,k=Qe(w.to(),x.head)),(S=s.ranges.slice(0))[o]=function(t,e){var n,r,i,o,s,l,a,c,u,h,d,f=e.anchor,p=e.head,g=Be(t.doc,f.line);return 0==qe(f,p)&&f.sticky==p.sticky?e:(n=we(g))?(r=be(n,f.ch,f.sticky),(i=n[r]).from!=f.ch&&i.to!=f.ch?e:0==(o=r+(i.from==f.ch==(1!=i.level)?0:1))||o==n.length?e:(p.line!=f.line?s=(p.line-f.line)*("ltr"==t.doc.direction?1:-1)>0:(l=be(n,p.ch,p.sticky),a=l-r||(p.ch-f.ch)*(1==i.level?-1:1),s=l==o-1||l==o?0>a:a>0),d=(u=s==(1==(c=n[o+(s?-1:0)]).level))?"after":"before",f.ch==(h=u?c.from:c.to)&&f.sticky==d?e:new Y(new Ye(f.line,h,d),p))):e}(t,new Y(nn(m,k),C)),Lo(m,Yi(t,S,o),c)}function b(e){t.state.selectingText=!1,d=1/0,e&&(Ae(e),g.input.focus()),ke(g.wrapper.ownerDocument,"mousemove",f),ke(g.wrapper.ownerDocument,"mouseup",p),m.history.lastSelOrigin=null}Ae(e),l=(s=m.sel).ranges,r.addNew&&!r.extend?(o=m.sel.contains(n),i=o>-1?l[o]:new Y(n,n)):(i=m.sel.primary(),o=m.sel.primIndex),"rectangle"==r.unit?(r.addNew||(i=new Y(n,n)),n=Vr(t,e,!0,!0),o=-1):(a=Cs(t,n,r.unit),i=r.extend?bo(i,a.anchor,a.head,r.extend):a),r.addNew?-1==o?(o=l.length,Lo(m,Yi(t,l.concat([i]),o),{scroll:!1,origin:"*mouse"})):l.length>1&&l[o].empty()&&"char"==r.unit&&!r.extend?(Lo(m,Yi(t,l.slice(0,o).concat(l.slice(o+1)),0),{scroll:!1,origin:"*mouse"}),s=m.sel):ko(m,o,i,c):(o=0,Lo(m,new X([i],0),c),s=m.sel),u=n,h=g.wrapper.getBoundingClientRect(),d=0,f=Oi(t,function(e){0!==e.buttons&&We(e)?function e(n){var i,o,s=++d,l=Vr(t,n,!0,"rectangle"==r.unit);l&&(0!=qe(l,u)?(t.curOp.focus=te(),y(l),(i=ci(g,m)).to>l.line&&l.line>=i.from||setTimeout(Oi(t,function(){d==s&&e(n)}),150)):(o=h.top>n.clientY?-20:n.clientY>h.bottom?20:0)&&setTimeout(Oi(t,function(){d==s&&(g.scroller.scrollTop+=o,e(n))}),50))}(e):b(e)}),p=Oi(t,b),t.state.selectingText=p,v(g.wrapper.ownerDocument,"mousemove",f),v(g.wrapper.ownerDocument,"mouseup",p)}(t,r,e,o)}(o,n,i,t):De(t)==s.scroller&&Ae(t):2==r?(n&&wo(o.doc,n),setTimeout(function(){return s.input.focus()},20)):3==r&&(e?o.display.input.onContextMenu(t):ii(o)))))}function Cs(t,e,n){if("char"==n)return new Y(e,e);if("word"==n)return t.findWordAt(e);if("line"==n)return new Y(Ye(e.line,0),nn(t.doc,Ye(e.line+1,0)));var r=n(t,e);return new Y(r.from,r.to)}function Ss(t,e,n,r){var i,o,s,l,a,c,u;if(e.touches)i=e.touches[0].clientX,o=e.touches[0].clientY;else try{i=e.clientX,o=e.clientY}catch(e){return!1}if(i>=Math.floor(t.display.gutters.getBoundingClientRect().right))return!1;if(r&&Ae(e),l=(s=t.display).lineDiv.getBoundingClientRect(),o>l.bottom||!Me(t,n))return Oe(e);for(o-=l.top-s.viewOffset,a=0;t.display.gutterSpecs.length>a;++a)if((c=s.gutters.childNodes[a])&&c.getBoundingClientRect().right>=i)return u=$e(t.doc,o),Ce(t,n,t,u,t.display.gutterSpecs[a].className,e),Oe(e)}function Ls(t,e){return Ss(t,e,"gutterClick",!0)}function Ms(t,n){lr(t.display,n)||function(t,e){return!!Me(t,"gutterContextMenu")&&Ss(t,e,"gutterContextMenu",!1)}(t,n)||Se(t,n,"contextmenu")||e||t.display.input.onContextMenu(n)}function Ts(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Cr(t)}function As(t,e,n){var r,i,o=n&&n!=mt;!e!=!o&&((i=e?v:ke)(t.display.scroller,"dragstart",(r=t.display.dragFunctions).start),i(t.display.scroller,"dragenter",r.enter),i(t.display.scroller,"dragover",r.over),i(t.display.scroller,"dragleave",r.leave),i(t.display.scroller,"drop",r.drop))}function Ns(t){t.options.lineWrapping?(ee(t.display.wrapper,"CodeMirror-wrap"),t.display.sizer.style.minWidth="",t.display.sizerWidth=null):(n(t.display.wrapper,"CodeMirror-wrap"),Hn(t)),jr(t),$r(t),Cr(t),setTimeout(function(){return wi(t)},100)}function Os(t,e){var n,r,i,s,l,a=this;if(!(this instanceof Os))return new Os(t,e);for(s in this.options=e=e?ie(e):{},ie(vt,e,!1),"string"==typeof(n=e.value)?n=new et(n,e.mode,null,e.lineSeparator,e.direction):e.mode&&(n.modeOption=e.mode),this.doc=n,r=new Os.inputStyles[e.inputStyle](this),(i=this.display=new Gi(t,n,r,e)).wrapper.CodeMirror=this,Ts(this),e.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),ki(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new o,keySeq:null,specialChars:null},e.autofocus&&!jt&&i.input.focus(),Dt&&11>Wt&&setTimeout(function(){return a.display.input.reset(!0)},20),function(t){var e,n,r,i=t.display;function o(){i.activeTouch&&(e=setTimeout(function(){return i.activeTouch=null},1e3),(n=i.activeTouch).end=+new Date)}function s(t,e){if(null==e.left)return!0;var n=e.left-t.left,r=e.top-t.top;return n*n+r*r>400}v(i.scroller,"mousedown",Oi(t,ks)),v(i.scroller,"dblclick",Dt&&11>Wt?Oi(t,function(e){var n,r;Se(t,e)||!(n=Vr(t,e))||Ls(t,e)||lr(t.display,e)||(Ae(e),r=t.findWordAt(n),wo(t.doc,r.anchor,r.head))}):function(e){return Se(t,e)||Ae(e)}),v(i.scroller,"contextmenu",function(e){return Ms(t,e)}),n={end:0},v(i.scroller,"touchstart",function(r){if(!Se(t,r)&&!function(t){if(1!=t.touches.length)return!1;var e=t.touches[0];return 1>=e.radiusX&&1>=e.radiusY}(r)&&!Ls(t,r)){i.input.ensurePolled(),clearTimeout(e);var o=+new Date;i.activeTouch={start:o,moved:!1,prev:o-n.end>300?null:n},1==r.touches.length&&(i.activeTouch.left=r.touches[0].pageX,i.activeTouch.top=r.touches[0].pageY)}}),v(i.scroller,"touchmove",function(){i.activeTouch&&(i.activeTouch.moved=!0)}),v(i.scroller,"touchend",function(e){var n,r,l=i.activeTouch;l&&!lr(i,e)&&null!=l.left&&!l.moved&&300>new Date-l.start&&(n=t.coordsChar(i.activeTouch,"page"),r=!l.prev||s(l,l.prev)?new Y(n,n):!l.prev.prev||s(l,l.prev.prev)?t.findWordAt(n):new Y(Ye(n.line,0),nn(t.doc,Ye(n.line+1,0))),t.setSelection(r.anchor,r.head),t.focus(),Ae(e)),o()}),v(i.scroller,"touchcancel",o),v(i.scroller,"scroll",function(){i.scroller.clientHeight&&(mi(t,i.scroller.scrollTop),yi(t,i.scroller.scrollLeft,!0),Ce(t,"scroll",t))}),v(i.scroller,"mousewheel",function(e){return Xi(t,e)}),v(i.scroller,"DOMMouseScroll",function(e){return Xi(t,e)}),v(i.wrapper,"scroll",function(){return i.wrapper.scrollTop=i.wrapper.scrollLeft=0}),i.dragFunctions={enter:function(e){Se(t,e)||_e(e)},over:function(e){Se(t,e)||(function(t,e){var n,r=Vr(t,e);r&&(n=document.createDocumentFragment(),Qr(t,r,n),t.display.dragCursor||(t.display.dragCursor=Jt("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),qt(t.display.dragCursor,n))}(t,e),_e(e))},start:function(e){return function(t,e){if(!Dt||t.state.draggingText&&+new Date-nt>=100){if(!Se(t,e)&&!lr(t.display,e)&&(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setDragImage&&!Pt)){var n=Jt("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Ft&&(n.width=n.height=1,t.display.wrapper.appendChild(n),n._top=n.offsetTop),e.dataTransfer.setDragImage(n,0,0),Ft&&n.parentNode.removeChild(n)}}else _e(e)}(t,e)},drop:Oi(t,Jo),leave:function(e){Se(t,e)||Zo(t)}},r=i.input.getField(),v(r,"keyup",function(e){return ws.call(t,e)}),v(r,"keydown",Oi(t,bs)),v(r,"keypress",Oi(t,xs)),v(r,"focus",function(e){return oi(t,e)}),v(r,"blur",function(e){return si(t,e)})}(this),ts(),Ci(this),this.curOp.forceUpdate=!0,so(this,n),e.autofocus&&!jt||this.hasFocus()?setTimeout(re(oi,this),20):si(this),yt)yt.hasOwnProperty(s)&&yt[s](a,e[s],mt);for(Bi(this),e.finishInit&&e.finishInit(this),l=0;bt.length>l;++l)bt[l](a);Si(this),Et&&e.lineWrapping&&"optimizelegibility"==getComputedStyle(i.lineDiv).textRendering&&(i.lineDiv.style.textRendering="auto")}function _s(t,e,n,r){var i,o,s,a,c,u,h,d,f,p,g,m,v=t.doc;if(null==n&&(n="add"),"smart"==n&&(v.mode.indent?i=ln(t,e).state:n="prev"),o=t.options.tabSize,s=Be(v,e),a=oe(s.text,null,o),s.stateAfter&&(s.stateAfter=null),c=s.text.match(/^\s*/)[0],r||/\S/.test(s.text)){if("smart"==n&&((u=v.mode.indent(i,s.text.slice(c.length),s.text))==l||u>150)){if(!r)return;n="prev"}}else u=0,n="not";if("prev"==n?u=e>v.first?oe(Be(v,e-1).text,null,o):0:"add"==n?u=a+t.options.indentUnit:"subtract"==n?u=a-t.options.indentUnit:"number"==typeof n&&(u=a+n),u=Math.max(0,u),h="",d=0,t.options.indentWithTabs)for(f=Math.floor(u/o);f;--f)d+=o,h+="\t";if(u>d&&(h+=ae(u-d)),h!=c)return zo(v,h,Ye(e,0),Ye(e,c.length),"+input"),s.stateAfter=null,!0;for(p=0;v.sel.ranges.length>p;p++)if((g=v.sel.ranges[p]).head.line==e&&c.length>g.head.ch){m=Ye(e,c.length),ko(v,p,new Y(m,m));break}}function Ds(t){wt=t}function Ws(t,e,n,r,i){var o,s,l,a,c,u,h,d,f,p,g,m=t.doc;if(t.display.shift=!1,r||(r=m.sel),o=+new Date-200,s="paste"==i||t.state.pasteIncoming>o,l=x(e),a=null,s&&r.ranges.length>1)if(wt&&wt.text.join("\n")==e){if(r.ranges.length%wt.text.length==0)for(a=[],c=0;wt.text.length>c;c++)a.push(m.splitLines(wt.text[c]))}else l.length==r.ranges.length&&t.options.pasteLinesPerSelection&&(a=ue(l,function(t){return[t]}));for(u=t.curOp.updateInput,h=r.ranges.length-1;h>=0;h--)f=(d=r.ranges[h]).from(),p=d.to(),d.empty()&&(n&&n>0?f=Ye(f.line,f.ch-n):t.state.overwrite&&!s?p=Ye(p.line,Math.min(Be(m,p.line).text.length,p.ch+ce(l).length)):s&&wt&&wt.lineWise&&wt.text.join("\n")==e&&(f=p=Ye(f.line,0))),Io(t.doc,g={from:f,to:p,text:a?a[h%a.length]:l,origin:i||(s?"paste":t.state.cutIncoming>o?"cut":"+input")}),Kn(t,"inputRead",t,g);e&&!s&&Is(t,e),di(t),2>t.curOp.updateInput&&(t.curOp.updateInput=u),t.curOp.typing=!0,t.state.pasteIncoming=t.state.cutIncoming=-1}function Es(t,e){var n=t.clipboardData&&t.clipboardData.getData("Text");if(n)return t.preventDefault(),e.isReadOnly()||e.options.disableInput||Ni(e,function(){return Ws(e,n,0,null,"paste")}),!0}function Is(t,e){var n,r,i,o,s,l;if(t.options.electricChars&&t.options.smartIndent)for(r=(n=t.doc.sel).ranges.length-1;r>=0;r--)if(!((i=n.ranges[r]).head.ch>100||r&&n.ranges[r-1].head.line==i.head.line)){if(o=t.getModeAt(i.head),s=!1,o.electricChars){for(l=0;o.electricChars.length>l;l++)if(e.indexOf(o.electricChars.charAt(l))>-1){s=_s(t,i.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(Be(t.doc,i.head.line).text.slice(0,i.head.ch))&&(s=_s(t,i.head.line,"smart"));s&&Kn(t,"electricInput",t,i.head.line)}}function Hs(t){var e,n,r,i=[],o=[];for(e=0;t.doc.sel.ranges.length>e;e++)r={anchor:Ye(n=t.doc.sel.ranges[e].head.line,0),head:Ye(n+1,0)},o.push(r),i.push(t.getRange(r.anchor,r.head));return{text:i,ranges:o}}function Fs(t,e,n,r){t.setAttribute("autocorrect",n?"":"off"),t.setAttribute("autocapitalize",r?"":"off"),t.setAttribute("spellcheck",!!e)}function Ps(){var t=Jt("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),e=Jt("div",[t],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return Et?t.style.width="1000px":t.setAttribute("wrap","off"),Bt&&(t.style.border="1px solid black"),Fs(t),e}function Rs(t,e,n,r,i){var o,s,l,a,c,u,h,d=e,f=n,p=Be(t,e.line);function g(r){var o,s;if(null==(o=i?function(t,e,n,r){var i,o,s,l,a,c,u,h,d,f,p,g=we(e,t.doc.direction);return g?(e.text.length>n.ch?n.ch>0||(n.ch=0,n.sticky="after"):(n.ch=e.text.length,n.sticky="before"),i=be(g,n.ch,n.sticky),o=g[i],"ltr"==t.doc.direction&&o.level%2==0&&(r>0?o.to>n.ch:n.ch>o.from)?hs(e,n,r):(s=function(t,n){return us(e,t instanceof Ye?t.ch:t,n)},c=(a=function(n){return t.options.lineWrapping?(l=l||vr(t,e),Ir(t,e,l,n)):{begin:0,end:e.text.length}})("before"==n.sticky?s(n,-1):n.ch),"rtl"!=t.doc.direction&&1!=o.level||null==(h=s(n,(u=1==o.level==0>r)?1:-1))||(u?h>o.to||h>c.end:o.from>h||c.begin>h)?(f=(d=function(t,e,r){for(var i,o,l,a=function(t,e){return e?new Ye(n.line,s(t,1),"before"):new Ye(n.line,t,"after")};t>=0&&g.length>t;t+=e){if((l=(o=e>0==(1!=(i=g[t]).level))?r.begin:s(r.end,-1))>=i.from&&i.to>l)return a(l,o);if((l=o?i.from:s(i.to,-1))>=r.begin&&r.end>l)return a(l,o)}})(i+r,r,c))?f:null==(p=r>0?c.end:s(c.begin,-1))||r>0&&p==e.text.length||!(f=d(r>0?0:g.length-1,r,a(p)))?null:f:new Ye(n.line,h,u?"before":"after"))):hs(e,n,r)}(t.cm,p,e,n):hs(p,e,n))){if(r||!((s=e.line+n)>=t.first&&t.first+t.size>s&&(e=new Ye(s,e.ch,e.sticky),p=Be(t,s))))return!1;e=ds(i,t.cm,p,e.line,n)}else e=o;return!0}if("char"==r)g();else if("column"==r)g(!0);else if("word"==r||"group"==r)for(o=null,s="group"==r,l=t.cm&&t.cm.getHelper(e,"wordChars"),a=!0;n>=0||g(!a);a=!1){if(c=p.text.charAt(e.ch)||"\n",u=pe(c,l)?"w":s&&"\n"==c?"n":!s||/\s/.test(c)?null:"p",!s||a||u||(u="s"),o&&o!=u){0>n&&(n=1,g(),e.sticky="after");break}if(u&&(o=u),n>0&&!g(!a))break}return h=_o(t,e,d,f,!0),Je(d,h)&&(h.hitSide=!0),h}function zs(t,e,n,r){var i,o,s,l,a=t.doc,c=e.left;for("page"==r?(o=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),s=Math.max(o-.5*Pr(t.display),3),i=(n>0?e.bottom:e.top)+n*s):"line"==r&&(i=n>0?e.bottom+3:e.top-3);(l=Wr(t,c,i)).outside;){if(0>n?0>=i:i>=a.height){l.hitSide=!0;break}i+=5*n}return l}function Bs(t,e){var n,r,i,o,s,l,a=mr(t,e.line);return!a||a.hidden?null:(n=Be(t.doc,e.line),r=pr(a,n,e.line),i=we(n,t.doc.direction),o="left",i&&(s=be(i,e.ch),o=s%2?"right":"left"),(l=br(r.map,e.ch,o)).offset="right"==l.collapse?l.end:l.start,l)}function Us(t,e){return e&&(t.bad=!0),t}function js(t,e,n){var r,i,o;if(e==t.display.lineDiv){if(!(r=t.display.lineDiv.childNodes[n]))return Us(t.clipPos(Ye(t.display.viewTo-1)),!0);e=null,n=0}else for(r=e;;r=r.parentNode){if(!r||r==t.display.lineDiv)return null;if(r.parentNode&&r.parentNode==t.display.lineDiv)break}for(i=0;t.display.view.length>i;i++)if((o=t.display.view[i]).node==r)return Vs(o,e,n)}function Vs(t,e,n){var r,i,o,s,l,a,c,u,h,d,f=t.text.firstChild,p=!1;if(!e||!Qt(f,e))return Us(Ye(Ge(t.line),0),!0);if(e==f&&(p=!0,e=f.childNodes[n],n=0,!e))return Us(Ye(Ge(r=t.rest?ce(t.rest):t.line),r.text.length),p);for(o=e,(i=3==e.nodeType?e:null)||1!=e.childNodes.length||3!=e.firstChild.nodeType||(i=e.firstChild,n&&(n=i.nodeValue.length));o.parentNode!=f;)o=o.parentNode;function g(e,n,r){var i,o,a,c,u,h;for(i=-1;(l?l.length:0)>i;i++)for(o=0>i?s.map:l[i],a=0;o.length>a;a+=3)if((c=o[a+2])==e||c==n)return u=Ge(0>i?t.line:t.rest[i]),h=o[a]+r,(0>r||c!=e)&&(h=o[a+(r?1:0)]),Ye(u,h)}if(l=(s=t.measure).maps,a=g(i,o,n))return Us(a,p);for(c=o.nextSibling,u=i?i.nodeValue.length-n:0;c;c=c.nextSibling){if(a=g(c,c.firstChild,0))return Us(Ye(a.line,a.ch-u),p);u+=c.textContent.length}for(h=o.previousSibling,d=n;h;h=h.previousSibling){if(a=g(h,h.firstChild,-1))return Us(Ye(a.line,a.ch+d),p);d+=h.textContent.length}}for(St in(at={}).basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},at.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},at.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},at.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},at.default=Vt?at.macDefault:at.pcDefault,ct={selectAll:Wo,singleSelection:function(t){return t.setSelection(t.getCursor("anchor"),t.getCursor("head"),a)},killLine:function(t){return cs(t,function(e){if(e.empty()){var n=Be(t.doc,e.head.line).text.length;return e.head.ch==n&&e.head.line<t.lastLine()?{from:e.head,to:Ye(e.head.line+1,0)}:{from:e.head,to:Ye(e.head.line,n)}}return{from:e.from(),to:e.to()}})},deleteLine:function(t){return cs(t,function(e){return{from:Ye(e.from().line,0),to:nn(t.doc,Ye(e.to().line+1,0))}})},delLineLeft:function(t){return cs(t,function(t){return{from:Ye(t.from().line,0),to:t.from()}})},delWrappedLineLeft:function(t){return cs(t,function(e){var n=t.charCoords(e.head,"div").top+5,r=t.coordsChar({left:0,top:n},"div");return{from:r,to:e.from()}})},delWrappedLineRight:function(t){return cs(t,function(e){var n=t.charCoords(e.head,"div").top+5,r=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:n},"div");return{from:e.from(),to:r}})},undo:function(t){return t.undo()},redo:function(t){return t.redo()},undoSelection:function(t){return t.undoSelection()},redoSelection:function(t){return t.redoSelection()},goDocStart:function(t){return t.extendSelection(Ye(t.firstLine(),0))},goDocEnd:function(t){return t.extendSelection(Ye(t.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return fs(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return ps(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy(function(e){return function(t,e){var n=Be(t.doc,e),r=function(t){for(var e;e=Mn(t);)t=e.find(1,!0).line;return t}(n);return r!=n&&(e=Ge(r)),ds(!0,t,n,e,-1)}(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(e){var n=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:n},"div")},u)},goLineLeft:function(t){return t.extendSelectionsBy(function(e){var n=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:n},"div")},u)},goLineLeftSmart:function(t){return t.extendSelectionsBy(function(e){var n=t.cursorCoords(e.head,"div").top+5,r=t.coordsChar({left:0,top:n},"div");return r.ch<t.getLine(r.line).search(/\S/)?ps(t,e.head):r},u)},goLineUp:function(t){return t.moveV(-1,"line")},goLineDown:function(t){return t.moveV(1,"line")},goPageUp:function(t){return t.moveV(-1,"page")},goPageDown:function(t){return t.moveV(1,"page")},goCharLeft:function(t){return t.moveH(-1,"char")},goCharRight:function(t){return t.moveH(1,"char")},goColumnLeft:function(t){return t.moveH(-1,"column")},goColumnRight:function(t){return t.moveH(1,"column")},goWordLeft:function(t){return t.moveH(-1,"word")},goGroupRight:function(t){return t.moveH(1,"group")},goGroupLeft:function(t){return t.moveH(-1,"group")},goWordRight:function(t){return t.moveH(1,"word")},delCharBefore:function(t){return t.deleteH(-1,"char")},delCharAfter:function(t){return t.deleteH(1,"char")},delWordBefore:function(t){return t.deleteH(-1,"word")},delWordAfter:function(t){return t.deleteH(1,"word")},delGroupBefore:function(t){return t.deleteH(-1,"group")},delGroupAfter:function(t){return t.deleteH(1,"group")},indentAuto:function(t){return t.indentSelection("smart")},indentMore:function(t){return t.indentSelection("add")},indentLess:function(t){return t.indentSelection("subtract")},insertTab:function(t){return t.replaceSelection("\t")},insertSoftTab:function(t){var e,n,r,i=[],o=t.listSelections(),s=t.options.tabSize;for(e=0;o.length>e;e++)n=o[e].from(),r=oe(t.getLine(n.line),n.ch,s),i.push(ae(s-r%s));t.replaceSelections(i)},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")},transposeChars:function(t){return Ni(t,function(){var e,n,r,i,o=t.listSelections(),s=[];for(e=0;o.length>e;e++)o[e].empty()&&((r=Be(t.doc,(n=o[e].head).line).text)&&(n.ch==r.length&&(n=new Ye(n.line,n.ch-1)),n.ch>0?(n=new Ye(n.line,n.ch+1),t.replaceRange(r.charAt(n.ch-1)+r.charAt(n.ch-2),Ye(n.line,n.ch-2),n,"+transpose")):n.line>t.doc.first&&(i=Be(t.doc,n.line-1).text)&&(n=new Ye(n.line,1),t.replaceRange(r.charAt(0)+t.doc.lineSeparator()+i.charAt(i.length-1),Ye(n.line-1,i.length-1),n,"+transpose"))),s.push(new Y(n,n)));t.setSelections(s)})},newlineAndIndent:function(t){return Ni(t,function(){var e,n,r=t.listSelections();for(e=r.length-1;e>=0;e--)t.replaceRange(t.doc.lineSeparator(),r[e].anchor,r[e].head,"+input");for(r=t.listSelections(),n=0;r.length>n;n++)t.indentLine(r[n].from().line,null,!0);di(t)})},openLine:function(t){return t.replaceSelection("\n","start")},toggleOverwrite:function(t){return t.toggleOverwrite()}},ut=new o,ht=null,dt=400,(ft=function(t,e,n){this.time=t,this.pos=e,this.button=n}).prototype.compare=function(t,e,n){return this.time+dt>t&&0==qe(e,this.pos)&&n==this.button},mt={toString:function(){return"CodeMirror.Init"}},yt={},Os.defaults=vt={},Os.optionHandlers=yt,bt=[],Os.defineInitHook=function(t){return bt.push(t)},wt=null,(xt=function(t){this.cm=t,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new o,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null}).prototype.init=function(t){var e=this,n=this,r=n.cm,o=n.div=t.lineDiv;function s(t){var e,s,l,c,u;if(!Se(r,t)){if(r.somethingSelected())Ds({lineWise:!1,text:r.getSelections()}),"cut"==t.type&&r.replaceSelection("",null,"cut");else{if(!r.options.lineWiseCopyCut)return;Ds({lineWise:!0,text:(e=Hs(r)).text}),"cut"==t.type&&r.operation(function(){r.setSelections(e.ranges,0,a),r.replaceSelection("",null,"cut")})}t.clipboardData&&(t.clipboardData.clearData(),s=wt.text.join("\n"),t.clipboardData.setData("Text",s),t.clipboardData.getData("Text")==s)?t.preventDefault():(l=Ps(),c=l.firstChild,r.display.lineSpace.insertBefore(l,r.display.lineSpace.firstChild),c.value=wt.text.join("\n"),u=document.activeElement,i(c),setTimeout(function(){r.display.lineSpace.removeChild(l),u.focus(),u==o&&n.showPrimarySelection()},50))}}Fs(o,r.options.spellcheck,r.options.autocorrect,r.options.autocapitalize),v(o,"paste",function(t){Se(r,t)||Es(t,r)||Wt>11||setTimeout(Oi(r,function(){return e.updateFromDOM()}),20)}),v(o,"compositionstart",function(t){e.composing={data:t.data,done:!1}}),v(o,"compositionupdate",function(t){e.composing||(e.composing={data:t.data,done:!1})}),v(o,"compositionend",function(t){e.composing&&(t.data!=e.composing.data&&e.readFromDOMSoon(),e.composing.done=!0)}),v(o,"touchstart",function(){return n.forceCompositionEnd()}),v(o,"input",function(){e.composing||e.readFromDOMSoon()}),v(o,"copy",s),v(o,"cut",s)},xt.prototype.prepareSelection=function(){var t=Zr(this.cm,!1);return t.focus=this.cm.state.focused,t},xt.prototype.showSelection=function(t,e){t&&this.cm.display.view.length&&((t.focus||e)&&this.showPrimarySelection(),this.showMultipleSelections(t))},xt.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},xt.prototype.showPrimarySelection=function(){var t,e,n,i,o,s,l,a,c,u=this.getSelection(),h=this.cm,d=h.doc.sel.primary(),f=d.from(),p=d.to();if(h.display.viewTo!=h.display.viewFrom&&h.display.viewTo>f.line&&p.line>=h.display.viewFrom){if(t=js(h,u.anchorNode,u.anchorOffset),e=js(h,u.focusNode,u.focusOffset),!t||t.bad||!e||e.bad||0!=qe(tn(t,e),f)||0!=qe(Qe(t,e),p))if(n=h.display.view,i=f.line>=h.display.viewFrom&&Bs(h,f)||{node:n[0].measure.map[2],offset:0},(o=h.display.viewTo>p.line&&Bs(h,p))||(o={node:(l=(s=n[n.length-1].measure).maps?s.maps[s.maps.length-1]:s.map)[l.length-1],offset:l[l.length-2]-l[l.length-3]}),i&&o){a=u.rangeCount&&u.getRangeAt(0);try{c=r(i.node,i.offset,o.offset,o.node)}catch(t){}c&&(!At&&h.state.focused?(u.collapse(i.node,i.offset),c.collapsed||(u.removeAllRanges(),u.addRange(c))):(u.removeAllRanges(),u.addRange(c)),a&&null==u.anchorNode?u.addRange(a):At&&this.startGracePeriod()),this.rememberSelection()}else u.removeAllRanges()}else u.removeAllRanges()},xt.prototype.startGracePeriod=function(){var t=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){t.gracePeriod=!1,t.selectionChanged()&&t.cm.operation(function(){return t.cm.curOp.selectionChanged=!0})},20)},xt.prototype.showMultipleSelections=function(t){qt(this.cm.display.cursorDiv,t.cursors),qt(this.cm.display.selectionDiv,t.selection)},xt.prototype.rememberSelection=function(){var t=this.getSelection();this.lastAnchorNode=t.anchorNode,this.lastAnchorOffset=t.anchorOffset,this.lastFocusNode=t.focusNode,this.lastFocusOffset=t.focusOffset},xt.prototype.selectionInEditor=function(){var t,e=this.getSelection();return!!e.rangeCount&&(t=e.getRangeAt(0).commonAncestorContainer,Qt(this.div,t))},xt.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},xt.prototype.blur=function(){this.div.blur()},xt.prototype.getField=function(){return this.div},xt.prototype.supportsTouch=function(){return!0},xt.prototype.receivedFocus=function(){var t=this;this.selectionInEditor()?this.pollSelection():Ni(this.cm,function(){return t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))})},xt.prototype.selectionChanged=function(){var t=this.getSelection();return t.anchorNode!=this.lastAnchorNode||t.anchorOffset!=this.lastAnchorOffset||t.focusNode!=this.lastFocusNode||t.focusOffset!=this.lastFocusOffset},xt.prototype.pollSelection=function(){var t,e,n,r;if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){if(t=this.getSelection(),e=this.cm,Ut&&Ht&&this.cm.display.gutterSpecs.length&&function(t){for(var e=t;e;e=e.parentNode)if(/CodeMirror-gutter-wrapper/.test(e.className))return!0;return!1}(t.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();this.composing||(this.rememberSelection(),n=js(e,t.anchorNode,t.anchorOffset),r=js(e,t.focusNode,t.focusOffset),n&&r&&Ni(e,function(){Lo(e.doc,qi(n,r),a),(n.bad||r.bad)&&(e.curOp.selectionChanged=!0)}))}},xt.prototype.pollContent=function(){var t,e,n,r,i,o,s,l,a,c,u,h,d,f,p,g,m,v,y,b,w,x,k;if(null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null),e=(t=this.cm).display,n=t.doc.sel.primary(),r=n.from(),i=n.to(),0==r.ch&&r.line>t.firstLine()&&(r=Ye(r.line-1,Be(t.doc,r.line-1).length)),i.ch==Be(t.doc,i.line).text.length&&i.line<t.lastLine()&&(i=Ye(i.line+1,0)),e.viewFrom>r.line||i.line>e.viewTo-1)return!1;if(r.line==e.viewFrom||0==(o=Gr(t,r.line))?(s=Ge(e.view[0].line),l=e.view[0].node):(s=Ge(e.view[o].line),l=e.view[o-1].node.nextSibling),(a=Gr(t,i.line))==e.view.length-1?(c=e.viewTo-1,u=e.lineDiv.lastChild):(c=Ge(e.view[a+1].line)-1,u=e.view[a+1].node.previousSibling),!l)return!1;for(h=t.doc.splitLines(function(t,e,n,r,i){var o="",s=!1,l=t.doc.lineSeparator(),a=!1;function c(){s&&(o+=l,a&&(o+=l),s=a=!1)}function u(t){t&&(c(),o+=t)}function h(e){var n,o,d,f,p,g,m;if(1==e.nodeType){if(n=e.getAttribute("cm-text"))return void u(n);if(o=e.getAttribute("cm-marker"))return void((f=t.findMarks(Ye(r,0),Ye(i+1,0),(m=+o,function(t){return t.id==m}))).length&&(d=f[0].find(0))&&u(Ue(t.doc,d.from,d.to).join(l)));if("false"==e.getAttribute("contenteditable"))return;if(p=/^(pre|div|p|li|table|br)$/i.test(e.nodeName),!/^br$/i.test(e.nodeName)&&0==e.textContent.length)return;for(p&&c(),g=0;e.childNodes.length>g;g++)h(e.childNodes[g]);/^(pre|p)$/i.test(e.nodeName)&&(a=!0),p&&(s=!0)}else 3==e.nodeType&&u(e.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;h(e),e!=n;)e=e.nextSibling,a=!1;return o}(t,l,u,s,c)),d=Ue(t.doc,Ye(s,0),Ye(c,Be(t.doc,c).text.length));h.length>1&&d.length>1;)if(ce(h)==ce(d))h.pop(),d.pop(),c--;else{if(h[0]!=d[0])break;h.shift(),d.shift(),s++}for(f=0,p=0,g=h[0],m=d[0],v=Math.min(g.length,m.length);v>f&&g.charCodeAt(f)==m.charCodeAt(f);)++f;for(y=ce(h),b=ce(d),w=Math.min(y.length-(1==h.length?f:0),b.length-(1==d.length?f:0));w>p&&y.charCodeAt(y.length-p-1)==b.charCodeAt(b.length-p-1);)++p;if(1==h.length&&1==d.length&&s==r.line)for(;f&&f>r.ch&&y.charCodeAt(y.length-p-1)==b.charCodeAt(b.length-p-1);)f--,p++;return h[h.length-1]=y.slice(0,y.length-p).replace(/^\u200b+/,""),h[0]=h[0].slice(f).replace(/\u200b+$/,""),x=Ye(s,f),k=Ye(c,d.length?ce(d).length-p:0),h.length>1||h[0]||qe(x,k)?(zo(t.doc,h,x,k,"+input"),!0):void 0},xt.prototype.ensurePolled=function(){this.forceCompositionEnd()},xt.prototype.reset=function(){this.forceCompositionEnd()},xt.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},xt.prototype.readFromDOMSoon=function(){var t=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(t.readDOMTimeout=null,t.composing){if(!t.composing.done)return;t.composing=null}t.updateFromDOM()},80))},xt.prototype.updateFromDOM=function(){var t=this;!this.cm.isReadOnly()&&this.pollContent()||Ni(this.cm,function(){return $r(t.cm)})},xt.prototype.setUneditable=function(t){t.contentEditable="false"},xt.prototype.onKeyPress=function(t){0==t.charCode||this.composing||(t.preventDefault(),this.cm.isReadOnly()||Oi(this.cm,Ws)(this.cm,String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),0))},xt.prototype.readOnlyChanged=function(t){this.div.contentEditable=String("nocursor"!=t)},xt.prototype.onContextMenu=function(){},xt.prototype.resetPosition=function(){},xt.prototype.needsContentAttribute=!0,(kt=function(t){this.cm=t,this.prevInput="",this.pollingFast=!1,this.polling=new o,this.hasSelection=!1,this.composing=null}).prototype.init=function(t){var e,n=this,r=this,o=this.cm;function s(t){if(!Se(o,t)){if(o.somethingSelected())Ds({lineWise:!1,text:o.getSelections()});else{if(!o.options.lineWiseCopyCut)return;var n=Hs(o);Ds({lineWise:!0,text:n.text}),"cut"==t.type?o.setSelections(n.ranges,null,a):(r.prevInput="",e.value=n.text.join("\n"),i(e))}"cut"==t.type&&(o.state.cutIncoming=+new Date)}}this.createField(t),e=this.textarea,t.wrapper.insertBefore(this.wrapper,t.wrapper.firstChild),Bt&&(e.style.width="0px"),v(e,"input",function(){Dt&&Wt>=9&&n.hasSelection&&(n.hasSelection=null),r.poll()}),v(e,"paste",function(t){Se(o,t)||Es(t,o)||(o.state.pasteIncoming=+new Date,r.fastPoll())}),v(e,"cut",s),v(e,"copy",s),v(t.scroller,"paste",function(n){if(!lr(t,n)&&!Se(o,n)){if(!e.dispatchEvent)return o.state.pasteIncoming=+new Date,void r.focus();var i=new Event("paste");i.clipboardData=n.clipboardData,e.dispatchEvent(i)}}),v(t.lineSpace,"selectstart",function(e){lr(t,e)||Ae(e)}),v(e,"compositionstart",function(){var t=o.getCursor("from");r.composing&&r.composing.range.clear(),r.composing={start:t,range:o.markText(t,o.getCursor("to"),{className:"CodeMirror-composing"})}}),v(e,"compositionend",function(){r.composing&&(r.poll(),r.composing.range.clear(),r.composing=null)})},kt.prototype.createField=function(t){this.wrapper=Ps(),this.textarea=this.wrapper.firstChild},kt.prototype.prepareSelection=function(){var t,e,n,r=this.cm,i=r.display,o=r.doc,s=Zr(r);return r.options.moveInputWithCursor&&(t=Or(r,o.sel.primary().head,"div"),e=i.wrapper.getBoundingClientRect(),n=i.lineDiv.getBoundingClientRect(),s.teTop=Math.max(0,Math.min(i.wrapper.clientHeight-10,t.top+n.top-e.top)),s.teLeft=Math.max(0,Math.min(i.wrapper.clientWidth-10,t.left+n.left-e.left))),s},kt.prototype.showSelection=function(t){var e=this.cm,n=e.display;qt(n.cursorDiv,t.cursors),qt(n.selectionDiv,t.selection),null!=t.teTop&&(this.wrapper.style.top=t.teTop+"px",this.wrapper.style.left=t.teLeft+"px")},kt.prototype.reset=function(t){var e,n;this.contextMenuPending||this.composing||((e=this.cm).somethingSelected()?(this.prevInput="",n=e.getSelection(),this.textarea.value=n,e.state.focused&&i(this.textarea),Dt&&Wt>=9&&(this.hasSelection=n)):t||(this.prevInput=this.textarea.value="",Dt&&Wt>=9&&(this.hasSelection=null)))},kt.prototype.getField=function(){return this.textarea},kt.prototype.supportsTouch=function(){return!1},kt.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!jt||te()!=this.textarea))try{this.textarea.focus()}catch(t){}},kt.prototype.blur=function(){this.textarea.blur()},kt.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},kt.prototype.receivedFocus=function(){this.slowPoll()},kt.prototype.slowPoll=function(){var t=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){t.poll(),t.cm.state.focused&&t.slowPoll()})},kt.prototype.fastPoll=function(){var t=!1,e=this;e.pollingFast=!0,e.polling.set(20,function n(){var r=e.poll();r||t?(e.pollingFast=!1,e.slowPoll()):(t=!0,e.polling.set(60,n))})},kt.prototype.poll=function(){var t,e,n,r,i=this,o=this.cm,s=this.textarea,l=this.prevInput;if(this.contextMenuPending||!o.state.focused||k(s)&&!l&&!this.composing||o.isReadOnly()||o.options.disableInput||o.state.keySeq)return!1;if((t=s.value)==l&&!o.somethingSelected())return!1;if(Dt&&Wt>=9&&this.hasSelection===t||Vt&&/[\uf700-\uf7ff]/.test(t))return o.display.input.reset(),!1;if(o.doc.sel==o.display.selForContextMenu&&(8203!=(e=t.charCodeAt(0))||l||(l="​"),8666==e))return this.reset(),this.cm.execCommand("undo");for(n=0,r=Math.min(l.length,t.length);r>n&&l.charCodeAt(n)==t.charCodeAt(n);)++n;return Ni(o,function(){Ws(o,t.slice(n),l.length-n,null,i.composing?"*compose":null),t.length>1e3||t.indexOf("\n")>-1?s.value=i.prevInput="":i.prevInput=t,i.composing&&(i.composing.range.clear(),i.composing.range=o.markText(i.composing.start,o.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},kt.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},kt.prototype.onKeyPress=function(){Dt&&Wt>=9&&(this.hasSelection=null),this.fastPoll()},kt.prototype.onContextMenu=function(t){var n,r,i,o,s,l,c,u=this,h=u.cm,d=h.display,f=u.textarea;function p(){var t,e;null!=f.selectionStart&&(t=h.somethingSelected(),e="​"+(t?f.value:""),f.value="⇚",f.value=e,u.prevInput=t?"":"​",f.selectionStart=1,f.selectionEnd=e.length,d.selForContextMenu=h.doc.sel)}function g(){if(u.contextMenuPending==g&&(u.contextMenuPending=!1,u.wrapper.style.cssText=o,f.style.cssText=i,Dt&&9>Wt&&d.scrollbars.setScrollTop(d.scroller.scrollTop=r),null!=f.selectionStart)){(!Dt||Dt&&9>Wt)&&p();var t=0,e=function(){d.selForContextMenu==h.doc.sel&&0==f.selectionStart&&f.selectionEnd>0&&"​"==u.prevInput?Oi(h,Wo)(h):10>t++?d.detectingSelectAll=setTimeout(e,500):(d.selForContextMenu=null,d.input.reset())};d.detectingSelectAll=setTimeout(e,200)}}u.contextMenuPending&&u.contextMenuPending(),n=Vr(h,t),r=d.scroller.scrollTop,n&&!Ft&&(h.options.resetSelectionOnContextMenu&&-1==h.doc.sel.contains(n)&&Oi(h,Lo)(h.doc,qi(n),a),i=f.style.cssText,o=u.wrapper.style.cssText,s=u.wrapper.offsetParent.getBoundingClientRect(),u.wrapper.style.cssText="position: static",f.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(t.clientY-s.top-5)+"px; left: "+(t.clientX-s.left-5)+"px;\n      z-index: 1000; background: "+(Dt?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",Et&&(l=window.scrollY),d.input.focus(),Et&&window.scrollTo(null,l),d.input.reset(),h.somethingSelected()||(f.value=u.prevInput=" "),u.contextMenuPending=g,d.selForContextMenu=h.doc.sel,clearTimeout(d.detectingSelectAll),Dt&&Wt>=9&&p(),e?(_e(t),c=function(){ke(window,"mouseup",c),setTimeout(g,20)},v(window,"mouseup",c)):setTimeout(g,50))},kt.prototype.readOnlyChanged=function(t){t||this.reset(),this.textarea.disabled="nocursor"==t},kt.prototype.setUneditable=function(){},kt.prototype.needsContentAttribute=!1,function(t){var e=t.optionHandlers;function n(n,r,i,o){t.defaults[n]=r,i&&(e[n]=o?function(t,e,n){n!=mt&&i(t,e,n)}:i)}t.defineOption=n,t.Init=mt,n("value","",function(t,e){return t.setValue(e)},!0),n("mode",null,function(t,e){t.doc.modeOption=e,eo(t)},!0),n("indentUnit",2,eo,!0),n("indentWithTabs",!1),n("smartIndent",!0),n("tabSize",4,function(t){no(t),Cr(t),$r(t)},!0),n("lineSeparator",null,function(t,e){var n,r,i;if(t.doc.lineSep=e,e)for(n=[],r=t.doc.first,t.doc.iter(function(t){var i,o;for(i=0;-1!=(o=t.text.indexOf(e,i));)i=o+e.length,n.push(Ye(r,o));r++}),i=n.length-1;i>=0;i--)zo(t.doc,e,n[i],Ye(n[i].line,n[i].ch+e.length))}),n("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(t,e,n){t.state.specialChars=new RegExp(e.source+(e.test("\t")?"":"|\t"),"g"),n!=mt&&t.refresh()}),n("specialCharPlaceholder",zn,function(t){return t.refresh()},!0),n("electricChars",!0),n("inputStyle",jt?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),n("spellcheck",!1,function(t,e){return t.getInputField().spellcheck=e},!0),n("autocorrect",!1,function(t,e){return t.getInputField().autocorrect=e},!0),n("autocapitalize",!1,function(t,e){return t.getInputField().autocapitalize=e},!0),n("rtlMoveVisually",!$t),n("wholeLineUpdateBefore",!0),n("theme","default",function(t){Ts(t),Vi(t)},!0),n("keyMap","default",function(t,e,n){var r=as(e),i=n!=mt&&as(n);i&&i.detach&&i.detach(t,r),r.attach&&r.attach(t,i||null)}),n("extraKeys",null),n("configureMouse",null),n("lineWrapping",!1,Ns,!0),n("gutters",[],function(t,e){t.display.gutterSpecs=Ui(e,t.options.lineNumbers),Vi(t)},!0),n("fixedGutter",!0,function(t,e){t.display.gutters.style.left=e?Br(t.display)+"px":"0",t.refresh()},!0),n("coverGutterNextToScrollbar",!1,function(t){return wi(t)},!0),n("scrollbarStyle","native",function(t){ki(t),wi(t),t.display.scrollbars.setScrollTop(t.doc.scrollTop),t.display.scrollbars.setScrollLeft(t.doc.scrollLeft)},!0),n("lineNumbers",!1,function(t,e){t.display.gutterSpecs=Ui(t.options.gutters,e),Vi(t)},!0),n("firstLineNumber",1,Vi,!0),n("lineNumberFormatter",function(t){return t},Vi,!0),n("showCursorWhenSelecting",!1,Jr,!0),n("resetSelectionOnContextMenu",!0),n("lineWiseCopyCut",!0),n("pasteLinesPerSelection",!0),n("selectionsMayTouch",!1),n("readOnly",!1,function(t,e){"nocursor"==e&&(si(t),t.display.input.blur()),t.display.input.readOnlyChanged(e)}),n("disableInput",!1,function(t,e){e||t.display.input.reset()},!0),n("dragDrop",!0,As),n("allowDropFileTypes",null),n("cursorBlinkRate",530),n("cursorScrollMargin",0),n("cursorHeight",1,Jr,!0),n("singleCursorHeightPerLine",!0,Jr,!0),n("workTime",100),n("workDelay",100),n("flattenSpans",!0,no,!0),n("addModeClass",!1,no,!0),n("pollInterval",100),n("undoDepth",200,function(t,e){return t.doc.history.undoDepth=e}),n("historyEventDelay",1250),n("viewportMargin",10,function(t){return t.refresh()},!0),n("maxHighlightLength",1e4,no,!0),n("moveInputWithCursor",!0,function(t,e){e||t.display.input.resetPosition()}),n("tabindex",null,function(t,e){return t.display.input.getField().tabIndex=e||""}),n("autofocus",null),n("direction","ltr",function(t,e){return t.doc.setDirection(e)},!0),n("phrases",null)}(Os),function(t){var e=t.optionHandlers,r=t.helpers={};t.prototype={constructor:t,focus:function(){window.focus(),this.display.input.focus()},setOption:function(t,n){var r=this.options,i=r[t];r[t]==n&&"mode"!=t||(r[t]=n,e.hasOwnProperty(t)&&Oi(this,e[t])(this,n,i),Ce(this,"optionChange",this,t))},getOption:function(t){return this.options[t]},getDoc:function(){return this.doc},addKeyMap:function(t,e){this.state.keyMaps[e?"push":"unshift"](as(t))},removeKeyMap:function(t){var e,n=this.state.keyMaps;for(e=0;n.length>e;++e)if(n[e]==t||n[e].name==t)return n.splice(e,1),!0},addOverlay:_i(function(e,n){var r=e.token?e:t.getMode(this.options,e);if(r.startState)throw new Error("Overlays may not be stateful.");!function(t,e,n){for(var r=0,i=n(e);t.length>r&&n(t[r])<=i;)r++;t.splice(r,0,e)}(this.state.overlays,{mode:r,modeSpec:e,opaque:n&&n.opaque,priority:n&&n.priority||0},function(t){return t.priority}),this.state.modeGen++,$r(this)}),removeOverlay:_i(function(t){var e,n,r=this,i=this.state.overlays;for(e=0;i.length>e;++e)if((n=i[e].modeSpec)==t||"string"==typeof t&&n.name==t)return i.splice(e,1),r.state.modeGen++,void $r(r)}),indentLine:_i(function(t,e,n){"string"!=typeof e&&"number"!=typeof e&&(e=null==e?this.options.smartIndent?"smart":"prev":e?"add":"subtract"),Ke(this.doc,t)&&_s(this,t,e,n)}),indentSelection:_i(function(t){var e,n,r,i,o,s,l,c=this,u=this.doc.sel.ranges,h=-1;for(e=0;u.length>e;e++)if((n=u[e]).empty())n.head.line>h&&(_s(c,n.head.line,t,!0),h=n.head.line,e==c.doc.sel.primIndex&&di(c));else{for(r=n.from(),i=n.to(),o=Math.max(h,r.line),h=Math.min(c.lastLine(),i.line-(i.ch?0:1))+1,s=o;h>s;++s)_s(c,s,t);l=c.doc.sel.ranges,0==r.ch&&u.length==l.length&&l[e].from().ch>0&&ko(c.doc,e,new Y(r,l[e].to()),a)}}),getTokenAt:function(t,e){return hn(this,t,e)},getLineTokens:function(t,e){return hn(this,Ye(t),e,!0)},getTokenTypeAt:function(t){var e,n,r,i,o,s,l;if(t=nn(this.doc,t),e=sn(this,Be(this.doc,t.line)),n=0,r=(e.length-1)/2,0==(i=t.ch))o=e[2];else for(;;)if(i>((s=n+r>>1)?e[2*s-1]:0)){if(e[2*s+1]>=i){o=e[2*s+2];break}n=s+1}else r=s;return 0>(l=o?o.indexOf("overlay "):-1)?o:0==l?null:o.slice(0,l-1)},getModeAt:function(e){var n=this.doc.mode;return n.innerMode?t.innerMode(n,this.getTokenAt(e).state).mode:n},getHelper:function(t,e){return this.getHelpers(t,e)[0]},getHelpers:function(t,e){var n,i,o,s,l,a,c=this,u=[];if(!r.hasOwnProperty(e))return u;if(n=r[e],"string"==typeof(i=this.getModeAt(t))[e])n[i[e]]&&u.push(n[i[e]]);else if(i[e])for(o=0;i[e].length>o;o++)(s=n[i[e][o]])&&u.push(s);else i.helperType&&n[i.helperType]?u.push(n[i.helperType]):n[i.name]&&u.push(n[i.name]);for(l=0;n._global.length>l;l++)(a=n._global[l]).pred(i,c)&&-1==se(u,a.val)&&u.push(a.val);return u},getStateAfter:function(t,e){var n=this.doc;return ln(this,(t=en(n,null==t?n.first+n.size-1:t))+1,e).state},cursorCoords:function(t,e){var n=this.doc.sel.primary();return Or(this,null==t?n.head:"object"==typeof t?nn(this.doc,t):t?n.from():n.to(),e||"page")},charCoords:function(t,e){return Nr(this,nn(this.doc,t),e||"page")},coordsChar:function(t,e){return Wr(this,(t=Ar(this,t,e||"page")).left,t.top)},lineAtHeight:function(t,e){return t=Ar(this,{top:t,left:0},e||"page").top,$e(this.doc,t+this.display.viewOffset)},heightAtLine:function(t,e,n){var r,i,o=!1;return"number"==typeof t?(i=this.doc.first+this.doc.size-1,this.doc.first>t?t=this.doc.first:t>i&&(t=i,o=!0),r=Be(this.doc,t)):r=t,Tr(this,r,{top:0,left:0},e||"page",n||o).top+(o?this.doc.height-En(r):0)},defaultTextHeight:function(){return Pr(this.display)},defaultCharWidth:function(){return Rr(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(t,e,n,r,i){var o,s,l,a,c,u,h=this.display;t=Or(this,nn(this.doc,t)),o=t.bottom,s=t.left,e.style.position="absolute",e.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(e),h.sizer.appendChild(e),"over"==r?o=t.top:"above"!=r&&"near"!=r||(l=Math.max(h.wrapper.clientHeight,this.doc.height),a=Math.max(h.sizer.clientWidth,h.lineSpace.clientWidth),("above"==r||t.bottom+e.offsetHeight>l)&&t.top>e.offsetHeight?o=t.top-e.offsetHeight:t.bottom+e.offsetHeight>l||(o=t.bottom),s+e.offsetWidth>a&&(s=a-e.offsetWidth)),e.style.top=o+"px",e.style.left=e.style.right="","right"==i?(s=h.sizer.clientWidth-e.offsetWidth,e.style.right="0px"):("left"==i?s=0:"middle"==i&&(s=(h.sizer.clientWidth-e.offsetWidth)/2),e.style.left=s+"px"),n&&(null!=(u=ui(c=this,{left:s,top:o,right:s+e.offsetWidth,bottom:o+e.offsetHeight})).scrollTop&&mi(c,u.scrollTop),null!=u.scrollLeft&&yi(c,u.scrollLeft))},triggerOnKeyDown:_i(bs),triggerOnKeyPress:_i(xs),triggerOnKeyUp:ws,triggerOnMouseDown:_i(ks),execCommand:function(t){if(ct.hasOwnProperty(t))return ct[t].call(null,this)},triggerElectric:_i(function(t){Is(this,t)}),findPosH:function(t,e,n,r){var i,o,s=this,l=1;for(0>e&&(l=-1,e=-e),i=nn(this.doc,t),o=0;e>o&&!(i=Rs(s.doc,i,l,n,r)).hitSide;++o);return i},moveH:_i(function(t,e){var n=this;this.extendSelectionsBy(function(r){return n.display.shift||n.doc.extend||r.empty()?Rs(n.doc,r.head,t,e,n.options.rtlMoveVisually):0>t?r.from():r.to()},u)}),deleteH:_i(function(t,e){var n=this.doc.sel,r=this.doc;n.somethingSelected()?r.replaceSelection("",null,"+delete"):cs(this,function(n){var i=Rs(r,n.head,t,e,!1);return 0>t?{from:i,to:n.head}:{from:n.head,to:i}})}),findPosV:function(t,e,n,r){var i,o,s,l=this,a=1,c=r;for(0>e&&(a=-1,e=-e),i=nn(this.doc,t),o=0;e>o&&(s=Or(l,i,"div"),null==c?c=s.left:s.left=c,!(i=zs(l,s,a,n)).hitSide);++o);return i},moveV:_i(function(t,e){var n,r=this,i=this.doc,o=[],s=!this.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy(function(n){var l,a;return s?0>t?n.from():n.to():(l=Or(r,n.head,"div"),null!=n.goalColumn&&(l.left=n.goalColumn),o.push(l.left),a=zs(r,l,t,e),"page"==e&&n==i.sel.primary()&&hi(r,Nr(r,a,"div").top-l.top),a)},u),o.length)for(n=0;i.sel.ranges.length>n;n++)i.sel.ranges[n].goalColumn=o[n]}),findWordAt:function(t){var e,n,r,i=this.doc,o=Be(i,t.line).text,s=t.ch,l=t.ch;if(o){for(e=this.getHelper(t,"wordChars"),"before"!=t.sticky&&l!=o.length||!s?++l:--s,n=o.charAt(s),r=pe(n,e)?function(t){return pe(t,e)}:/\s/.test(n)?function(t){return/\s/.test(t)}:function(t){return!/\s/.test(t)&&!pe(t)};s>0&&r(o.charAt(s-1));)--s;for(;o.length>l&&r(o.charAt(l));)++l}return new Y(Ye(t.line,s),Ye(t.line,l))},toggleOverwrite:function(t){null!=t&&t==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?ee(this.display.cursorDiv,"CodeMirror-overwrite"):n(this.display.cursorDiv,"CodeMirror-overwrite"),Ce(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==te()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:_i(function(t,e){fi(this,t,e)}),getScrollInfo:function(){var t=this.display.scroller;return{left:t.scrollLeft,top:t.scrollTop,height:t.scrollHeight-hr(this)-this.display.barHeight,width:t.scrollWidth-hr(this)-this.display.barWidth,clientHeight:fr(this),clientWidth:dr(this)}},scrollIntoView:_i(function(t,e){null==t?(t={from:this.doc.sel.primary().head,to:null},null==e&&(e=this.options.cursorScrollMargin)):"number"==typeof t?t={from:Ye(t,0),to:null}:null==t.from&&(t={from:t,to:null}),t.to||(t.to=t.from),t.margin=e||0,null!=t.from.line?function(t,e){pi(t),t.curOp.scrollToPos=e}(this,t):gi(this,t.from,t.to,t.margin)}),setSize:_i(function(t,e){var n,r=this,i=function(t){return"number"==typeof t||/^\d+$/.test(String(t))?t+"px":t};null!=t&&(this.display.wrapper.style.width=i(t)),null!=e&&(this.display.wrapper.style.height=i(e)),this.options.lineWrapping&&kr(this),this.doc.iter(n=this.display.viewFrom,this.display.viewTo,function(t){if(t.widgets)for(var e=0;t.widgets.length>e;e++)if(t.widgets[e].noHScroll){Kr(r,n,"widget");break}++n}),this.curOp.forceUpdate=!0,Ce(this,"refresh",this)}),operation:function(t){return Ni(this,t)},startOperation:function(){return Ci(this)},endOperation:function(){return Si(this)},refresh:_i(function(){var t=this.display.cachedTextHeight;$r(this),this.curOp.forceUpdate=!0,Cr(this),fi(this,this.doc.scrollLeft,this.doc.scrollTop),Pi(this.display),(null==t||Math.abs(t-Pr(this.display))>.5)&&jr(this),Ce(this,"refresh",this)}),swapDoc:_i(function(t){var e=this.doc;return e.cm=null,this.state.selectingText&&this.state.selectingText(),so(this,t),Cr(this),this.display.input.reset(),fi(this,t.scrollLeft,t.scrollTop),this.curOp.forceScroll=!0,Kn(this,"swapDoc",this,e),e}),phrase:function(t){var e=this.options.phrases;return e&&Object.prototype.hasOwnProperty.call(e,t)?e[t]:t},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Te(t),t.registerHelper=function(e,n,i){r.hasOwnProperty(e)||(r[e]=t[e]={_global:[]}),r[e][n]=i},t.registerGlobalHelper=function(e,n,i,o){t.registerHelper(e,n,o),r[e]._global.push({pred:i,val:o})}}(Os),Ct="iter insert remove copy getEditor constructor".split(" "),et.prototype)et.prototype.hasOwnProperty(St)&&0>se(Ct,St)&&(Os.prototype[St]=function(t){return function(){return t.apply(this.doc,arguments)}}(et.prototype[St]));return Te(et),Os.inputStyles={textarea:kt,contenteditable:xt},Os.defineMode=function(t){Os.defaults.mode||"null"==t||(Os.defaults.mode=t),function(t,e){arguments.length>2&&(e.dependencies=Array.prototype.slice.call(arguments,2)),L[t]=e}.apply(this,arguments)},Os.defineMIME=function(t,e){M[t]=e},Os.defineMode("null",function(){return{token:function(t){return t.skipToEnd()}}}),Os.defineMIME("text/plain","null"),Os.defineExtension=function(t,e){Os.prototype[t]=e},Os.defineDocExtension=function(t,e){et.prototype[t]=e},Os.fromTextArea=function(t,e){var n,r,i,o,s;function l(){t.value=s.getValue()}if((e=e?ie(e):{}).value=t.value,!e.tabindex&&t.tabIndex&&(e.tabindex=t.tabIndex),!e.placeholder&&t.placeholder&&(e.placeholder=t.placeholder),null==e.autofocus&&(n=te(),e.autofocus=n==t||null!=t.getAttribute("autofocus")&&n==document.body),t.form&&(v(t.form,"submit",l),!e.leaveSubmitMethodAlone)){r=(i=t.form).submit;try{o=i.submit=function(){l(),i.submit=r,i.submit(),i.submit=o}}catch(t){}}return e.finishInit=function(n){n.save=l,n.getTextArea=function(){return t},n.toTextArea=function(){n.toTextArea=isNaN,l(),t.parentNode.removeChild(n.getWrapperElement()),t.style.display="",t.form&&(ke(t.form,"submit",l),e.leaveSubmitMethodAlone||"function"!=typeof t.form.submit||(t.form.submit=r))}},t.style.display="none",s=Os(function(e){return t.parentNode.insertBefore(e,t.nextSibling)},e)},function(t){t.off=ke,t.on=v,t.wheelEventPixels=Ki,t.Doc=et,t.splitLines=x,t.countColumn=oe,t.findColumn=le,t.isWordChar=fe,t.Pass=l,t.signal=Ce,t.Line=E,t.changeEnd=Ji,t.scrollbarModel=j,t.Pos=Ye,t.cmpPos=qe,t.modes=L,t.mimeModes=M,t.resolveMode=Ie,t.getMode=He,t.modeExtensions=T,t.extendMode=Fe,t.copyState=Pe,t.startState=ze,t.innerMode=Re,t.commands=ct,t.keyMap=at,t.keyName=ls,t.isModifierKey=os,t.lookupKey=is,t.normalizeKeyMap=rs,t.StringStream=A,t.SharedTextMarker=Q,t.TextMarker=Z,t.LineWidget=q,t.e_preventDefault=Ae,t.e_stopPropagation=Ne,t.e_stop=_e,t.addClass=ee,t.contains=Qt,t.rmClass=n,t.keyNames=it}(Os),Os.version="5.49.0",Os}()}),Zn(function(e,n){var r;(r=t).defineMode("javascript",function(t,e){var n,i,o,s,l,a,c=t.indentUnit,u=e.statementIndent,h=e.jsonld,d=e.json||h,f=e.typescript,p=e.wordCharacters||/[\w$\xa1-\uffff]/,g=function(){var t,e,n,r,i,o;function s(t){return{type:t,style:"keyword"}}return t=s("keyword a"),e=s("keyword b"),n=s("keyword c"),r=s("keyword d"),i=s("operator"),o={type:"atom",style:"atom"},{if:s("if"),while:t,with:t,else:e,do:e,try:e,finally:e,return:r,break:r,continue:r,new:s("new"),delete:n,void:n,throw:n,debugger:s("debugger"),var:s("var"),const:s("var"),let:s("var"),function:s("function"),catch:s("catch"),for:s("for"),switch:s("switch"),case:s("case"),default:s("default"),in:i,typeof:i,instanceof:i,true:o,false:o,null:o,undefined:o,NaN:o,Infinity:o,this:s("this"),class:s("class"),super:s("atom"),yield:n,export:s("export"),import:s("import"),extends:n,await:n}}(),m=/[+\-*&%=<>!?|~^@]/,v=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function y(t,e,r){return n=t,i=r,e}function b(t,e){var n,r,i,o=t.next();if('"'==o||"'"==o)return e.tokenize=(i=o,function(t,e){var n,r=!1;if(h&&"@"==t.peek()&&t.match(v))return e.tokenize=b,y("jsonld-keyword","meta");for(;null!=(n=t.next())&&(n!=i||r);)r=!r&&"\\"==n;return r||(e.tokenize=b),y("string","string")}),e.tokenize(t,e);if("."==o&&t.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return y("number","number");if("."==o&&t.match(".."))return y("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(o))return y(o);if("="==o&&t.eat(">"))return y("=>","operator");if("0"==o&&t.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return y("number","number");if(/\d/.test(o))return t.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),y("number","number");if("/"==o)return t.eat("*")?(e.tokenize=w,w(t,e)):t.eat("/")?(t.skipToEnd(),y("comment","comment")):Xt(t,e,1)?(function(t){for(var e,n=!1,r=!1;null!=(e=t.next());){if(!n){if("/"==e&&!r)return;"["==e?r=!0:r&&"]"==e&&(r=!1)}n=!n&&"\\"==e}}(t),t.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),y("regexp","string-2")):(t.eat("="),y("operator","operator",t.current()));if("`"==o)return e.tokenize=x,x(t,e);if("#"==o)return t.skipToEnd(),y("error","error");if("<"==o&&t.match("!--")||"-"==o&&t.match("->"))return t.skipToEnd(),y("comment","comment");if(m.test(o))return">"==o&&e.lexical&&">"==e.lexical.type||(t.eat("=")?"!"!=o&&"="!=o||t.eat("="):/[<>*+\-]/.test(o)&&(t.eat(o),">"==o&&t.eat(o))),y("operator","operator",t.current());if(p.test(o)){if(t.eatWhile(p),n=t.current(),"."!=e.lastType){if(g.propertyIsEnumerable(n))return y((r=g[n]).type,r.style,n);if("async"==n&&t.match(/^(\s|\/\*.*?\*\/)*[\[\(\w]/,!1))return y("async","keyword",n)}return y("variable","variable",n)}}function w(t,e){for(var n,r=!1;n=t.next();){if("/"==n&&r){e.tokenize=b;break}r="*"==n}return y("comment","comment")}function x(t,e){for(var n,r=!1;null!=(n=t.next());){if(!r&&("`"==n||"$"==n&&t.eat("{"))){e.tokenize=b;break}r=!r&&"\\"==n}return y("quasi","string-2",t.current())}function k(t,e){var n,r,i,s,l,a,c;if(e.fatArrowAt&&(e.fatArrowAt=null),(n=t.string.indexOf("=>",t.start))>=0){for(f&&(r=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(t.string.slice(t.start,n)))&&(n=r.index),i=0,s=!1,l=n-1;l>=0;--l)if(a=t.string.charAt(l),(c=o.indexOf(a))>=0&&3>c){if(!i){++l;break}if(0==--i){"("==a&&(s=!0);break}}else if(c>=3&&6>c)++i;else if(p.test(a))s=!0;else if(/["'\/`]/.test(a))for(;;--l){if(0==l)return;if(t.string.charAt(l-1)==a&&"\\"!=t.string.charAt(l-2)){l--;break}}else if(s&&!i){++l;break}s&&!i&&(e.fatArrowAt=l)}}function C(t,e,n,r,i,o){this.indented=t,this.column=e,this.type=n,this.prev=i,this.info=o,null!=r&&(this.align=r)}function S(t,e){var n,r;for(n=t.localVars;n;n=n.next)if(n.name==e)return!0;for(r=t.context;r;r=r.prev)for(n=r.vars;n;n=n.next)if(n.name==e)return!0}function L(){for(var t=arguments.length-1;t>=0;t--)l.cc.push(arguments[t])}function M(){return L.apply(null,arguments),!0}function T(t,e){for(var n=e;n;n=n.next)if(n.name==t)return!0;return!1}function A(t){var n,r=l.state;if(l.marked="def",r.context)if("var"==r.lexical.info&&r.context&&r.context.block){if(null!=(n=function t(e,n){if(n){if(n.block){var r=t(e,n.prev);return r?r==n.prev?n:new O(r,n.vars,!0):null}return T(e,n.vars)?n:new O(n.prev,new _(e,n.vars),!1)}return null}(t,r.context)))return void(r.context=n)}else if(!T(t,r.localVars))return void(r.localVars=new _(t,r.localVars));e.globalVars&&!T(t,r.globalVars)&&(r.globalVars=new _(t,r.globalVars))}function N(t){return"public"==t||"private"==t||"protected"==t||"abstract"==t||"readonly"==t}function O(t,e,n){this.prev=t,this.vars=e,this.block=n}function _(t,e){this.name=t,this.next=e}function D(){l.state.context=new O(l.state.context,l.state.localVars,!1),l.state.localVars=a}function W(){l.state.context=new O(l.state.context,l.state.localVars,!0),l.state.localVars=null}function E(){l.state.localVars=l.state.context.vars,l.state.context=l.state.context.prev}function I(t,e){var n=function(){var n,r=l.state,i=r.indented;if("stat"==r.lexical.type)i=r.lexical.indented;else for(n=r.lexical;n&&")"==n.type&&n.align;n=n.prev)i=n.indented;r.lexical=new C(i,l.stream.column(),t,null,r.lexical,e)};return n.lex=!0,n}function H(){var t=l.state;t.lexical.prev&&(")"==t.lexical.type&&(t.indented=t.lexical.indented),t.lexical=t.lexical.prev)}function F(t){return function e(n){return n==t?M():";"==t||"}"==n||")"==n||"]"==n?L():M(e)}}function P(t,e){return"var"==t?M(I("vardef",e),bt,F(";"),H):"keyword a"==t?M(I("form"),U,P,H):"keyword b"==t?M(I("form"),P,H):"keyword d"==t?l.stream.match(/^\s*$/,!1)?M():M(I("stat"),V,F(";"),H):"debugger"==t?M(F(";")):"{"==t?M(I("}"),W,st,H,E):";"==t?M():"if"==t?("else"==l.state.lexical.info&&l.state.cc[l.state.cc.length-1]==H&&l.state.cc.pop()(),M(I("form"),U,P,H,Lt)):"function"==t?M(Nt):"for"==t?M(I("form"),Mt,P,H):"class"==t||f&&"interface"==e?(l.marked="keyword",M(I("form","class"==t?t:e),Et,H)):"variable"==t?f&&"declare"==e?(l.marked="keyword",M(P)):f&&("module"==e||"enum"==e||"type"==e)&&l.stream.match(/^\s*\w/,!1)?(l.marked="keyword","enum"==e?M($t):"type"==e?M(_t,F("operator"),ht,F(";")):M(I("form"),wt,F("{"),I("}"),st,H,H)):f&&"namespace"==e?(l.marked="keyword",M(I("form"),z,P,H)):f&&"abstract"==e?(l.marked="keyword",M(P)):M(I("stat"),Q):"switch"==t?M(I("form"),U,F("{"),I("}","switch"),W,st,H,H,E):"case"==t?M(z,F(":")):"default"==t?M(F(":")):"catch"==t?M(I("form"),D,R,P,H,E):"export"==t?M(I("stat"),Pt,H):"import"==t?M(I("stat"),zt,H):"async"==t?M(P):"@"==e?M(z,P):L(I("stat"),z,F(";"),H)}function R(t){if("("==t)return M(Dt,F(")"))}function z(t,e){return j(t,e,!1)}function B(t,e){return j(t,e,!0)}function U(t){return"("!=t?L():M(I(")"),z,F(")"),H)}function j(t,e,n){var r,i;if(l.state.fatArrowAt==l.stream.start){if(r=n?q:Y,"("==t)return M(D,I(")"),it(Dt,")"),H,F("=>"),r,E);if("variable"==t)return L(D,wt,F("=>"),r,E)}return i=n?$:G,s.hasOwnProperty(t)?M(i):"function"==t?M(Nt,i):"class"==t||f&&"interface"==e?(l.marked="keyword",M(I("form"),Wt,H)):"keyword c"==t||"async"==t?M(n?B:z):"("==t?M(I(")"),V,F(")"),H,i):"operator"==t||"spread"==t?M(n?B:z):"["==t?M(I("]"),Gt,H,i):"{"==t?ot(et,"}",null,i):"quasi"==t?L(K,i):"new"==t?M(function(t){return function(e){return"."==e?M(t?Z:J):"variable"==e&&f?M(mt,t?$:G):L(t?B:z)}}(n)):"import"==t?M(z):M()}function V(t){return t.match(/[;\}\)\],]/)?L():L(z)}function G(t,e){return","==t?M(z):$(t,e,!1)}function $(t,e,n){var r=0==n?G:$,i=0==n?z:B;return"=>"==t?M(D,n?q:Y,E):"operator"==t?/\+\+|--/.test(e)||f&&"!"==e?M(r):f&&"<"==e&&l.stream.match(/^([^>]|<.*?>)*>\s*\(/,!1)?M(I(">"),it(ht,">"),H,r):"?"==e?M(z,F(":"),i):M(i):"quasi"==t?L(K,r):";"!=t?"("==t?ot(B,")","call",r):"."==t?M(tt,r):"["==t?M(I("]"),V,F("]"),H,r):f&&"as"==e?(l.marked="keyword",M(ht,r)):"regexp"==t?(l.state.lastType=l.marked="operator",l.stream.backUp(l.stream.pos-l.stream.start-1),M(i)):void 0:void 0}function K(t,e){return"quasi"!=t?L():"${"!=e.slice(e.length-2)?M(K):M(z,X)}function X(t){if("}"==t)return l.marked="string-2",l.state.tokenize=x,M(K)}function Y(t){return k(l.stream,l.state),L("{"==t?P:z)}function q(t){return k(l.stream,l.state),L("{"==t?P:B)}function J(t,e){if("target"==e)return l.marked="keyword",M(G)}function Z(t,e){if("target"==e)return l.marked="keyword",M($)}function Q(t){return":"==t?M(H,P):L(G,F(";"),H)}function tt(t){if("variable"==t)return l.marked="property",M()}function et(t,e){return"async"==t?(l.marked="property",M(et)):"variable"==t||"keyword"==l.style?(l.marked="property","get"==e||"set"==e?M(nt):(f&&l.state.fatArrowAt==l.stream.start&&(n=l.stream.match(/^\s*:\s*/,!1))&&(l.state.fatArrowAt=l.stream.pos+n[0].length),M(rt))):"number"==t||"string"==t?(l.marked=h?"property":l.style+" property",M(rt)):"jsonld-keyword"==t?M(rt):f&&N(e)?(l.marked="keyword",M(et)):"["==t?M(z,lt,F("]"),rt):"spread"==t?M(B,rt):"*"==e?(l.marked="keyword",M(et)):":"==t?L(rt):void 0;var n}function nt(t){return"variable"!=t?L(rt):(l.marked="property",M(Nt))}function rt(t){return":"==t?M(B):"("==t?L(Nt):void 0}function it(t,e,n){function r(i,o){if(n?n.indexOf(i)>-1:","==i){var s=l.state.lexical;return"call"==s.info&&(s.pos=(s.pos||0)+1),M(function(n,r){return n==e||r==e?L():L(t)},r)}return i==e||o==e?M():n&&n.indexOf(";")>-1?L(t):M(F(e))}return function(n,i){return n==e||i==e?M():L(t,r)}}function ot(t,e,n){for(var r=3;arguments.length>r;r++)l.cc.push(arguments[r]);return M(I(e,n),it(t,e),H)}function st(t){return"}"==t?M():L(P,st)}function lt(t,e){if(f){if(":"==t)return M(ht);if("?"==e)return M(lt)}}function at(t,e){if(f&&(":"==t||"in"==e))return M(ht)}function ct(t){if(f&&":"==t)return l.stream.match(/^\s*\w+\s+is\b/,!1)?M(z,ut,ht):M(ht)}function ut(t,e){if("is"==e)return l.marked="keyword",M()}function ht(t,e){return"keyof"==e||"typeof"==e||"infer"==e?(l.marked="keyword",M("typeof"==e?B:ht)):"variable"==t||"void"==e?(l.marked="type",M(gt)):"|"==e||"&"==e?M(ht):"string"==t||"number"==t||"atom"==t?M(gt):"["==t?M(I("]"),it(ht,"]",","),H,gt):"{"==t?M(I("}"),it(ft,"}",",;"),H,gt):"("==t?M(it(pt,")"),dt,gt):"<"==t?M(it(ht,">"),ht):void 0}function dt(t){if("=>"==t)return M(ht)}function ft(t,e){return"variable"==t||"keyword"==l.style?(l.marked="property",M(ft)):"?"==e||"number"==t||"string"==t?M(ft):":"==t?M(ht):"["==t?M(F("variable"),at,F("]"),ft):"("==t?L(Ot,ft):void 0}function pt(t,e){return"variable"==t&&l.stream.match(/^\s*[?:]/,!1)||"?"==e?M(pt):":"==t?M(ht):"spread"==t?M(pt):L(ht)}function gt(t,e){return"<"==e?M(I(">"),it(ht,">"),H,gt):"|"==e||"."==t||"&"==e?M(ht):"["==t?M(ht,F("]"),gt):"extends"==e||"implements"==e?(l.marked="keyword",M(ht)):"?"==e?M(ht,F(":"),ht):void 0}function mt(t,e){if("<"==e)return M(I(">"),it(ht,">"),H,gt)}function vt(){return L(ht,yt)}function yt(t,e){if("="==e)return M(ht)}function bt(t,e){return"enum"==e?(l.marked="keyword",M($t)):L(wt,lt,Ct,St)}function wt(t,e){return f&&N(e)?(l.marked="keyword",M(wt)):"variable"==t?(A(e),M()):"spread"==t?M(wt):"["==t?ot(kt,"]"):"{"==t?ot(xt,"}"):void 0}function xt(t,e){return"variable"!=t||l.stream.match(/^\s*:/,!1)?("variable"==t&&(l.marked="property"),"spread"==t?M(wt):"}"==t?L():"["==t?M(z,F("]"),F(":"),xt):M(F(":"),wt,Ct)):(A(e),M(Ct))}function kt(){return L(wt,Ct)}function Ct(t,e){if("="==e)return M(B)}function St(t){if(","==t)return M(bt)}function Lt(t,e){if("keyword b"==t&&"else"==e)return M(I("form","else"),P,H)}function Mt(t,e){return"await"==e?M(Mt):"("==t?M(I(")"),Tt,H):void 0}function Tt(t){return"var"==t?M(bt,At):"variable"==t?M(At):L(At)}function At(t,e){return")"==t?M():";"==t?M(At):"in"==e||"of"==e?(l.marked="keyword",M(z,At)):L(z,At)}function Nt(t,e){return"*"==e?(l.marked="keyword",M(Nt)):"variable"==t?(A(e),M(Nt)):"("==t?M(D,I(")"),it(Dt,")"),H,ct,P,E):f&&"<"==e?M(I(">"),it(vt,">"),H,Nt):void 0}function Ot(t,e){return"*"==e?(l.marked="keyword",M(Ot)):"variable"==t?(A(e),M(Ot)):"("==t?M(D,I(")"),it(Dt,")"),H,ct,E):f&&"<"==e?M(I(">"),it(vt,">"),H,Ot):void 0}function _t(t,e){return"keyword"==t||"variable"==t?(l.marked="type",M(_t)):"<"==e?M(I(">"),it(vt,">"),H):void 0}function Dt(t,e){return"@"==e&&M(z,Dt),"spread"==t?M(Dt):f&&N(e)?(l.marked="keyword",M(Dt)):f&&"this"==t?M(lt,Ct):L(wt,lt,Ct)}function Wt(t,e){return"variable"==t?Et(t,e):It(t,e)}function Et(t,e){if("variable"==t)return A(e),M(It)}function It(t,e){return"<"==e?M(I(">"),it(vt,">"),H,It):"extends"==e||"implements"==e||f&&","==t?("implements"==e&&(l.marked="keyword"),M(f?ht:z,It)):"{"==t?M(I("}"),Ht,H):void 0}function Ht(t,e){return"async"==t||"variable"==t&&("static"==e||"get"==e||"set"==e||f&&N(e))&&l.stream.match(/^\s+[\w$\xa1-\uffff]/,!1)?(l.marked="keyword",M(Ht)):"variable"==t||"keyword"==l.style?(l.marked="property",M(f?Ft:Nt,Ht)):"number"==t||"string"==t?M(f?Ft:Nt,Ht):"["==t?M(z,lt,F("]"),f?Ft:Nt,Ht):"*"==e?(l.marked="keyword",M(Ht)):f&&"("==t?L(Ot,Ht):";"==t||","==t?M(Ht):"}"==t?M():"@"==e?M(z,Ht):void 0}function Ft(t,e){if("?"==e)return M(Ft);if(":"==t)return M(ht,Ct);if("="==e)return M(B);var n=l.state.lexical.prev,r=n&&"interface"==n.info;return L(r?Ot:Nt)}function Pt(t,e){return"*"==e?(l.marked="keyword",M(Vt,F(";"))):"default"==e?(l.marked="keyword",M(z,F(";"))):"{"==t?M(it(Rt,"}"),Vt,F(";")):L(P)}function Rt(t,e){return"as"==e?(l.marked="keyword",M(F("variable"))):"variable"==t?L(B,Rt):void 0}function zt(t){return"string"==t?M():"("==t?L(z):L(Bt,Ut,Vt)}function Bt(t,e){return"{"==t?ot(Bt,"}"):("variable"==t&&A(e),"*"==e&&(l.marked="keyword"),M(jt))}function Ut(t){if(","==t)return M(Bt,Ut)}function jt(t,e){if("as"==e)return l.marked="keyword",M(Bt)}function Vt(t,e){if("from"==e)return l.marked="keyword",M(z)}function Gt(t){return"]"==t?M():L(it(B,"]"))}function $t(){return L(I("form"),wt,F("{"),I("}"),it(Kt,"}"),H,H)}function Kt(){return L(wt,Ct)}function Xt(t,e,n){return e.tokenize==b&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(e.lastType)||"quasi"==e.lastType&&/\{\s*$/.test(t.string.slice(0,t.pos-(n||0)))}return o="([{}])",s={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0},l={state:null,column:null,marked:null,cc:null},a=new _("this",new _("arguments",null)),E.lex=!0,H.lex=!0,{startState:function(t){var n={tokenize:b,lastType:"sof",cc:[],lexical:new C((t||0)-c,0,"block",!1),localVars:e.localVars,context:e.localVars&&new O(null,null,!1),indented:t||0};return e.globalVars&&"object"==typeof e.globalVars&&(n.globalVars=e.globalVars),n},token:function(t,e){if(t.sol()&&(e.lexical.hasOwnProperty("align")||(e.lexical.align=!1),e.indented=t.indentation(),k(t,e)),e.tokenize!=w&&t.eatSpace())return null;var r=e.tokenize(t,e);return"comment"==n?r:(e.lastType="operator"!=n||"++"!=i&&"--"!=i?n:"incdec",function(t,e,n,r,i){var o=t.cc;for(l.state=t,l.stream=i,l.marked=null,l.cc=o,l.style=e,t.lexical.hasOwnProperty("align")||(t.lexical.align=!0);;)if((o.length?o.pop():d?z:P)(n,r)){for(;o.length&&o[o.length-1].lex;)o.pop()();return l.marked?l.marked:"variable"==n&&S(t,r)?"variable-2":e}}(e,r,n,i,t))},indent:function(t,n){var i,o,s,l,a,h,d;if(t.tokenize==w)return r.Pass;if(t.tokenize!=b)return 0;if(i=n&&n.charAt(0),o=t.lexical,!/^\s*else\b/.test(n))for(l=t.cc.length-1;l>=0;--l)if((a=t.cc[l])==H)o=o.prev;else if(a!=Lt)break;for(;("stat"==o.type||"form"==o.type)&&("}"==i||(s=t.cc[t.cc.length-1])&&(s==G||s==$)&&!/^[,\.=+\-*:?[\(]/.test(n));)o=o.prev;return u&&")"==o.type&&"stat"==o.prev.type&&(o=o.prev),d=i==(h=o.type),"vardef"==h?o.indented+("operator"==t.lastType||","==t.lastType?o.info.length+1:0):"form"==h&&"{"==i?o.indented:"form"==h?o.indented+c:"stat"==h?o.indented+(function(t,e){return"operator"==t.lastType||","==t.lastType||m.test(e.charAt(0))||/[,.]/.test(e.charAt(0))}(t,n)?u||c:0):"switch"!=o.info||d||0==e.doubleIndentSwitch?o.align?o.column+(d?0:1):o.indented+(d?0:c):o.indented+(/^(?:case|default)\b/.test(n)?c:2*c)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:d?null:"/*",blockCommentEnd:d?null:"*/",blockCommentContinue:d?null:" * ",lineComment:d?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:d?"json":"javascript",jsonldMode:h,jsonMode:d,expressionAllowed:Xt,skipExpression:function(t){var e=t.cc[t.cc.length-1];e!=z&&e!=B||t.cc.pop()}}}),r.registerHelper("wordChars","javascript",/[\w$]/),r.defineMIME("text/javascript","javascript"),r.defineMIME("text/ecmascript","javascript"),r.defineMIME("application/javascript","javascript"),r.defineMIME("application/x-javascript","javascript"),r.defineMIME("application/ecmascript","javascript"),r.defineMIME("application/json",{name:"javascript",json:!0}),r.defineMIME("application/x-json",{name:"javascript",json:!0}),r.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),r.defineMIME("text/typescript",{name:"javascript",typescript:!0}),r.defineMIME("application/typescript",{name:"javascript",typescript:!0})}),window.addEventListener("load",()=>{const e=new gt,n=new $n(`${"http:"===location.protocol?"ws:":"wss:"}${location.host}`,"codemirror",e),r=e.getText("codemirror"),i=document.createElement("div");i.setAttribute("id","editor"),document.body.insertBefore(i,null);const o=t(i,{mode:"javascript",lineNumbers:!0}),s=new Jn(r,o,n.awareness),l=document.getElementById("y-connect-btn");l.addEventListener("click",()=>{n.shouldConnect?(n.disconnect(),l.textContent="Connect"):(n.connect(),l.textContent="Disconnect")}),window.example={provider:n,ydoc:e,yText:r,binding:s}})}();
//# sourceMappingURL=codemirror.js.map
